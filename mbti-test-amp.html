<!DOCTYPE html>
<html ⚡ lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI 测试 - AMP 版本</title>
    
    <!-- AMP 核心脚本 -->
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    
    <!-- AMP 广告脚本 -->
    <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
    
    <!-- AMP 样式 -->
    <style amp-custom>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #1f2937;
        }
        .container { max-width: 900px; margin: 0 auto; padding: 24px; }
        .card {
            background: rgba(255,255,255,0.98);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(0,0,0,0.05);
            margin: 20px 0;
        }
        .header { text-align: center; color: #fff; margin: 24px 0; }
        .header h1 { margin: 0 0 8px; font-size: 32px; }
        .header p { margin: 0; opacity: 0.9; }
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            padding: 12px 24px;
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 8px 20px rgba(102,126,234,0.35);
            transition: transform 0.15s ease, box-shadow 0.2s ease;
            text-decoration: none;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(102,126,234,0.5); }
        .center { text-align: center; }
        .hidden { display: none; }
        .progress { height: 8px; background: #e5e7eb; border-radius: 999px; overflow: hidden; margin: 12px 0 20px; }
        .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, #34d399, #10b981); transition: width .25s ease; }
        .q-text { font-size: 20px; color: #111827; margin: 8px 0 12px; }
        .opt { 
            border: 2px solid #e5e7eb; 
            border-radius: 12px; 
            padding: 14px; 
            margin: 10px 0; 
            cursor: pointer; 
            transition: all .15s ease; 
            background: #fff; 
        }
        .opt:hover { border-color: #667eea; box-shadow: 0 6px 18px rgba(102,126,234,0.15); transform: translateY(-1px); }
        .opt.selected { border-color: #667eea; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; box-shadow: 0 10px 24px rgba(102,126,234,0.4); }
        .nav { display: flex; justify-content: space-between; gap: 12px; margin-top: 16px; }
        .result-type { font-size: 40px; font-weight: 800; color: #4f46e5; margin: 8px 0 16px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; }
        .pill { display:inline-block; padding:6px 12px; border-radius:999px; background:#eef2ff; color:#3730a3; font-weight:600; font-size:12px; }
        .muted { color: #6b7280; font-size: 14px; }
        a.link { color: #4f46e5; text-decoration: none; font-weight: 600; }
        a.link:hover { text-decoration: underline; }
        
        /* AMP 广告样式 */
        .amp-ad-container {
            margin: 20px 0;
            text-align: center;
        }
        .ad-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>🧠 MBTI 测试 - AMP 版本</h1>
            <p>快速准确的 16 型人格测试 · 支持 AMP 广告</p>
        </div>
    </div>

    <div class="container">
        <!-- 顶部广告 -->
        <div class="amp-ad-container">
            <span class="ad-label">广告</span>
            <amp-ad width="100vw" height="320"
                 type="adsense"
                 data-ad-client="ca-pub-4198974976257818"
                 data-ad-slot="9310887265"
                 data-auto-format="rspv"
                 data-full-width="">
              <div overflow=""></div>
            </amp-ad>
        </div>

        <!-- 欢迎页面 -->
        <div id="welcome" class="card">
            <h2 class="center" style="margin-top:0">开始测试</h2>
            <p class="muted">
                选择最符合你直觉的选项。没有对错之分，请根据第一感觉回答。
            </p>
            
            <div class="card" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 1px solid #f59e0b; margin: 16px 0;">
                <h3 style="margin: 0 0 8px; color: #92400e;">🌟 测试亮点</h3>
                <p style="margin: 0; color: #92400e; font-size: 14px;">
                    基于荣格理论的 12 题快速测试，准确评估你的 MBTI 类型：
                </p>
                <ul style="margin: 8px 0 0 18px; color: #92400e; font-size: 14px;">
                    <li>标准 MBTI 四维度分析</li>
                    <li>专业类型解读</li>
                    <li>个性化发展建议</li>
                    <li>职业匹配分析</li>
                </ul>
            </div>
            
            <div class="center" style="margin-top:16px">
                <button class="btn" type="button" onclick="startTest()">开始测试</button>
                <a class="link" href="index.html" style="margin-left:12px">返回首页</a>
            </div>
        </div>

        <!-- 测试页面 -->
        <div id="testing" class="card hidden">
            <div class="progress"><div id="pbar" class="progress-bar"></div></div>
            <div class="muted" id="ptext">0/12</div>
            <div id="qText" class="q-text">问题</div>
            <div id="opts"></div>
            <div class="nav">
                <button id="prevBtn" class="btn" type="button" onclick="prev()">上一题</button>
                <button id="nextBtn" class="btn" type="button" onclick="next()">下一题</button>
            </div>
        </div>

        <!-- 结果页面 -->
        <div id="result" class="card hidden">
            <div class="center">
                <div class="pill">你的 MBTI 类型</div>
                <div id="type" class="result-type">XXXX</div>
                <p class="muted">四维度分布：</p>
            </div>
            <div id="breakdown" style="margin-top:12px"></div>
            
            <!-- 结果页广告 -->
            <div class="amp-ad-container">
                <span class="ad-label">广告</span>
                <amp-ad width="100vw" height="320"
                     type="adsense"
                     data-ad-client="ca-pub-4198974976257818"
                     data-ad-slot="9310887265"
                     data-auto-format="rspv"
                     data-full-width="">
                  <div overflow=""></div>
                </amp-ad>
            </div>
            
            <div class="center" style="margin-top:16px">
                <button class="btn" type="button" onclick="restart()">重新测试</button>
                <a class="link" href="index.html" style="margin-left:12px">返回首页</a>
            </div>
        </div>
    </div>

    <!-- 底部粘性广告 -->
    <div class="amp-ad-container" style="position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 10px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 1000;">
        <amp-ad width="100vw" height="100"
             type="adsense"
             data-ad-client="ca-pub-4198974976257818"
             data-ad-slot="9310887265"
             data-auto-format="rspv"
             data-full-width="">
          <div overflow=""></div>
        </amp-ad>
    </div>

    <script>
        // 简化的测试逻辑（AMP 兼容）
        const QUESTIONS = [
            { d: 'EI', t: '遇到新同事时，你倾向于：', a: { text: '主动打招呼并快速熟悉', v: 'E' }, b: { text: '先观察再慢慢熟悉', v: 'I' } },
            { d: 'SN', t: '做决定时，你更重视：', a: { text: '实际细节和可行性', v: 'S' }, b: { text: '可能性和长远愿景', v: 'N' } },
            { d: 'TF', t: '在分歧中，你更关注：', a: { text: '逻辑一致性和客观对错', v: 'T' }, b: { text: '他人感受和关系和谐', v: 'F' } },
            { d: 'JP', t: '处理任务时，你偏好：', a: { text: '有计划有秩序地推进', v: 'J' }, b: { text: '灵活安排和调整', v: 'P' } },
            { d: 'EI', t: '周末社交活动对你来说是：', a: { text: '充满活力，越热闹越好', v: 'E' }, b: { text: '消耗精力，安静时光更好', v: 'I' } },
            { d: 'SN', t: '学习新技能时，你：', a: { text: '从步骤教程开始', v: 'S' }, b: { text: '先掌握原理再练习', v: 'N' } },
            { d: 'TF', t: '评估选项时，你：', a: { text: '列出标准并权衡利弊', v: 'T' }, b: { text: '考虑影响和价值观', v: 'F' } },
            { d: 'JP', t: '旅行前，你的准备是：', a: { text: '完整的行程清单', v: 'J' }, b: { text: '随性探索', v: 'P' } },
            { d: 'EI', t: '在会议中你更常：', a: { text: '积极发言并带动氛围', v: 'E' }, b: { text: '倾听并完善观点', v: 'I' } },
            { d: 'SN', t: '问题出现时，你首先：', a: { text: '核实事实并逐步排查', v: 'S' }, b: { text: '凭直觉找到关键点', v: 'N' } },
            { d: 'TF', t: '收到反馈时，你偏好：', a: { text: '直接、具体、可操作', v: 'T' }, b: { text: '委婉、鼓励、顾及情感', v: 'F' } },
            { d: 'JP', t: '面对截止日期，你通常：', a: { text: '提前完成留出缓冲', v: 'J' }, b: { text: '临近截止时表现更好', v: 'P' } }
        ];

        let currentIndex = -1;
        let selections = Array(QUESTIONS.length).fill(null);
        const scores = { E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0 };

        function $(sel){ return document.querySelector(sel); }

        function show(section){
            ['#welcome','#testing','#result'].forEach(id=>$(id).classList.add('hidden'));
            $(section).classList.remove('hidden');
        }

        function startTest(){
            currentIndex = 0;
            selections.fill(null);
            Object.keys(scores).forEach(k => scores[k] = 0);
            renderQuestion();
            show('#testing');
        }

        function renderQuestion(){
            const q = QUESTIONS[currentIndex];
            $('#qText').textContent = `${currentIndex+1}. ${q.t}`;
            const opts = $('#opts');
            opts.innerHTML = '';
            [q.a, q.b].forEach((opt, idx) => {
                const div = document.createElement('div');
                div.className = 'opt' + (selections[currentIndex] === opt.v ? ' selected' : '');
                div.innerHTML = `${opt.text}`;
                div.onclick = () => selectOption(opt.v);
                opts.appendChild(div);
            });
            $('#prevBtn').disabled = currentIndex === 0;
            $('#nextBtn').textContent = currentIndex === QUESTIONS.length - 1 ? '提交' : '下一题';
            $('#nextBtn').disabled = selections[currentIndex] == null;
            const pct = Math.round(((currentIndex) / QUESTIONS.length) * 100);
            $('#pbar').style.width = `${pct}%`;
            $('#ptext').textContent = `${currentIndex}/${QUESTIONS.length}`;
        }

        function selectOption(val){
            selections[currentIndex] = val;
            const opts = $('#opts').children;
            Array.from(opts).forEach(el => el.classList.remove('selected'));
            const chosen = Array.from(opts).find(el => el.textContent.trim());
            $('#nextBtn').disabled = false;
            setTimeout(() => { next(); }, 600);
        }

        function next(){
            if (selections[currentIndex] == null) return;
            if (currentIndex === QUESTIONS.length - 1) { submit(); return; }
            currentIndex += 1;
            renderQuestion();
        }

        function prev(){
            if (currentIndex === 0) return;
            currentIndex -= 1;
            renderQuestion();
        }

        function submit(){
            // 计算分数
            Object.keys(scores).forEach(k => scores[k] = 0);
            selections.forEach((val) => { if (val) scores[val] += 1; });
            const getPair = (a,b) => scores[a] >= scores[b] ? a : b;
            const type = [ getPair('E','I'), getPair('S','N'), getPair('T','F'), getPair('J','P') ].join('');

            // 百分比
            const countByDim = { EI:0, SN:0, TF:0, JP:0 };
            QUESTIONS.forEach(q => countByDim[q.d] += 1);
            const pct = {
                E: Math.round(100 * scores.E / countByDim.EI),
                I: Math.round(100 * scores.I / countByDim.EI),
                S: Math.round(100 * scores.S / countByDim.SN),
                N: Math.round(100 * scores.N / countByDim.SN),
                T: Math.round(100 * scores.T / countByDim.TF),
                F: Math.round(100 * scores.F / countByDim.TF),
                J: Math.round(100 * scores.J / countByDim.JP),
                P: Math.round(100 * scores.P / countByDim.JP)
            };

            // 渲染结果
            $('#type').textContent = type;
            $('#breakdown').innerHTML = `
                <div class="grid">
                    <div class="card"><div class="pill">外向 E / 内向 I</div><p class="muted">E ${pct.E}% · I ${pct.I}%</p></div>
                    <div class="card"><div class="pill">感觉 S / 直觉 N</div><p class="muted">S ${pct.S}% · N ${pct.N}%</p></div>
                    <div class="card"><div class="pill">思考 T / 情感 F</div><p class="muted">T ${pct.T}% · F ${pct.F}%</p></div>
                    <div class="card"><div class="pill">判断 J / 感知 P</div><p class="muted">J ${pct.J}% · P ${pct.P}%</p></div>
                </div>
            `;

            show('#result');
        }

        function restart(){
            currentIndex = -1;
            selections.fill(null);
            Object.keys(scores).forEach(k => scores[k] = 0);
            show('#welcome');
        }
    </script>
</body>
</html>