<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI Personality Test - Discover Your Personality Type</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    
    <!-- Inline SVG icon as fallback -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üß†</text></svg>">
    
    <!-- Google OAuth configuration removed -->
    
    <!-- Ads disabled -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* ÁôªÂΩïÈ°µÈù¢Ê†∑Âºè */
        .login-section {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
            box-sizing: border-box;
            /* Á°Æ‰øùÂÜÖÂÆπÂßãÁªàÂ±Ö‰∏≠ */
            min-height: 100vh;
            min-width: 100vw;
        }

        .register-section {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
            box-sizing: border-box;
        }

        .login-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            /* Á°Æ‰øùÂú®flexÂÆπÂô®‰∏≠ÂÆåÁæéÂ±Ö‰∏≠ */
            align-self: center;
            justify-self: center;
            /* ÂìçÂ∫îÂºèËÆæËÆ° */
            box-sizing: border-box;
        }

        /* ÁßªÂä®ËÆæÂ§á‰ºòÂåñ */
        @media (max-width: 768px) {
            .login-card {
                margin: 20px;
                padding: 30px;
                max-width: calc(100% - 40px);
            }
            
            .login-section {
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            .login-card {
                padding: 25px;
                margin: 15px;
                max-width: calc(100% - 30px);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .login-header h1 {
            font-size: 2rem;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .login-header p {
            color: #718096;
            font-size: 1rem;
        }

        .login-form {
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            color: #718096;
            font-size: 0.9rem;
        }

        .checkbox-label input[type="checkbox"] {
            margin-right: 8px;
            width: auto;
        }

        .forgot-password {
            color: #667eea;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .login-btn {
            width: 100%;
            margin-bottom: 20px;
        }

        .divider {
            text-align: center;
            margin: 25px 0;
            position: relative;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e2e8f0;
        }

        .divider span {
            background: rgba(255, 255, 255, 0.95);
            padding: 0 15px;
            color: #718096;
            font-size: 0.9rem;
        }

        /* Google ÊåâÈíÆÊ†∑ÂºèÂ∑≤Âà†Èô§ */

        .register-link {
            text-align: center;
        }

        .register-link p {
            color: #718096;
            margin: 0;
        }

        .register-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .register-link a:hover {
            text-decoration: underline;
        }

        .terms-link {
            color: #667eea;
            text-decoration: none;
        }

        .terms-link:hover {
            text-decoration: underline;
        }

        /* Áî®Êà∑‰ø°ÊÅØÊ†∑Âºè */
        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .user-info span {
            color: white;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .logout-btn {
            padding: 8px 20px;
            font-size: 0.9rem;
        }

        /* GoogleÁôªÂΩïÂºπÁ™óÊ†∑Âºè */
        .google-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .google-modal-content {
            background: white;
            border-radius: 20px;
            padding: 0;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* Google ÂºπÁ™óÂ§¥ÈÉ®Ê†∑ÂºèÂ∑≤Âà†Èô§ */

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: #e9ecef;
            color: #333;
        }

        /* Google ÂºπÁ™óÂÜÖÂÆπÊ†∑ÂºèÂ∑≤Âà†Èô§ */

        /* Google ÊåâÈíÆÊ†∑ÂºèÂ∑≤Âà†Èô§ */

        /* ÂÖ≥Èó≠Ë¶ÜÁõñÂ±ÇÊåâÈíÆÊ†∑Âºè */
        .close-overlay-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-overlay-btn:hover {
            background: #e9ecef;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .welcome-section {
            text-align: center;
        }

        .welcome-section h2 {
            font-size: 2.5rem;
            color: #4a5568;
            margin-bottom: 20px;
        }

        .welcome-section p {
            font-size: 1.1rem;
            color: #718096;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
        }

        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.6);
        }

                .test-section.hidden {
            display: none;
        }
        
        .test-header {
            margin-bottom: 30px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .test-stage-display {
            text-align: center;
        }
        
        .stage-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .question-container {
            text-align: center;
        }

        .question-text {
            font-size: 1.5rem;
            color: #2d3748;
            margin-bottom: 30px;
            line-height: 1.4;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .option-btn {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            color: #4a5568;
            text-align: left;
        }

        .option-btn:hover {
            border-color: #667eea;
            background: #f7fafc;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .option-btn.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            transform: scale(1.02);
            transition: all 0.3s ease;
        }

        /* ÈÄâÈ°πÊåâÈíÆÈÄâÊã©Âä®Áîª */
        .option-btn.selecting {
            animation: selectPulse 0.5s ease-in-out;
        }

        @keyframes selectPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1.02); }
        }

        /* ÈÄâÊã©ÂèçÈ¶àÂä®Áîª */
        @keyframes feedbackFade {
            0% { 
                opacity: 0; 
                transform: translateY(10px) scale(0.8); 
            }
            50% { 
                opacity: 1; 
                transform: translateY(0) scale(1.1); 
            }
            100% { 
                opacity: 0; 
                transform: translateY(-10px) scale(1); 
            }
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        .result-section {
            text-align: center;
        }
        .result-section.hidden {
            display: none;
        }

        .result-section h2 {
            font-size: 2.5rem;
            color: #4a5568;
            margin-bottom: 20px;
        }

        .personality-type {
            font-size: 4rem;
            font-weight: 700;
            color: #667eea;
            margin: 30px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .dimensions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .dimension {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .dimension h4 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .dimension-bar {
            width: 100%;
            height: 12px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .dimension-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 6px;
            transition: width 1s ease;
        }

        .description {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: left;
            line-height: 1.6;
        }

        .description h3 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .description p {
            color: #718096;
            margin-bottom: 15px;
        }

        .hidden {
            display: none;
        }

        /* MBTI‰ªãÁªçÈ°µÈù¢Ê†∑Âºè */
        .mbti-content {
            text-align: left;
        }

        .mbti-content h3 {
            color: #4a5568;
            font-size: 1.8rem;
            margin: 40px 0 20px;
            text-align: center;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .dimension-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }

        .dimension-card h4 {
            color: #2d3748;
            font-size: 1.4rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .dimension-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .dimension-side {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }

        .dimension-side h5 {
            color: #4a5568;
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .dimension-side ul {
            list-style: none;
            padding: 0;
        }

        .dimension-side li {
            color: #718096;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .dimension-side li:before {
            content: "‚Ä¢";
            color: #667eea;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        .types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .type-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .type-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #667eea;
        }

        .type-card h4 {
            color: #2d3748;
            font-size: 1.2rem;
            margin-bottom: 10px;
            text-align: center;
        }

        .type-card p {
            color: #718096;
            font-size: 0.95rem;
            line-height: 1.5;
            text-align: center;
        }

        .tips-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .tip-item {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #f093fb;
        }

        .tip-item h4 {
            color: #2d3748;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .tip-item p {
            color: #718096;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 25px;
            }
            
            .question-text {
                font-size: 1.3rem;
            }
            
            .personality-type {
                font-size: 3rem;
            }
            .dimension-details {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .types-grid {
                grid-template-columns: 1fr;
            }
            
            .tips-content {
                grid-template-columns: 1fr;
            }
        }

        /* Google Ê≥®ÂÜåÂºπÁ™óÊ†∑ÂºèÂ∑≤Âà†Èô§ */

        /* ‰∏ªË¶ÅÊåâÈíÆÊ†∑Âºè */
        .btn-primary {
            background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(66, 133, 244, 0.4);
        }

        .btn-primary:hover {
            box-shadow: 0 8px 25px rgba(66, 133, 244, 0.6);
        }
        /* ÂπøÂëäÈ°µÈù¢Ê†∑Âºè */
        .ad-section {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
            box-sizing: border-box;
            min-height: 100vh;
            min-width: 100vw;
        }

        .ad-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            max-width: 600px;
            width: 100%;
            min-height: 70vh;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            margin: auto;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

                .ad-header h2 {
            color: #2d3748;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .ad-header p {
            color: #718096;
            font-size: 1.1rem;
            margin-bottom: 30px;
        }
        
        .ad-header {
            width: 100%;
            text-align: center;
            margin-bottom: 20px;
        }

                .ad-content {
            margin-bottom: 30px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            justify-content: center;
        }
        
        .ad-video-placeholder {
            margin-bottom: 30px;
            width: 100%;
            max-width: 400px;
        }
        
        .ad-video-frame {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            width: 100%;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Google AdSense ÂπøÂëäÊ†∑Âºè */
        .google-adsense-ad {
            width: 100%;
            height: 100%;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            position: relative;
        }

        /* AdSenseÂπøÂëäÂçïÂÖÉÊ†∑Âºè */
        .adsense-ad-unit {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .adsense-ad-unit ins.adsbygoogle {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ad-loading {
            text-align: center;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fallback-ad {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            animation: adSlideIn 0.5s ease;
        }

        @keyframes adSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fallback-ad .ad-video-player {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: 20px;
            position: relative;
        }

        .ad-header {
            position: absolute;
            top: 15px;
            left: 15px;
            right: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ad-badge {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .ad-sponsor {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .ad-content-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .ad-icon {
            font-size: 4rem;
            margin-bottom: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .ad-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
            line-height: 1.2;
        }

        .ad-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .ad-features {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .feature {
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        .ad-footer {
            position: absolute;
            bottom: 15px;
            left: 15px;
            right: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ad-duration {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .ad-action {
            background: rgba(255, 255, 255, 0.25);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .ad-action:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateY(-2px);
        }

        /* ÂπøÂëäÈÖçÁΩÆÈù¢ÊùøÊ†∑Âºè */
        .ad-config-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 0;
            max-width: 400px;
            width: 90%;
            z-index: 1000;
            animation: configSlideIn 0.3s ease;
        }

        @keyframes configSlideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .ad-config-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ad-config-header h4 {
            margin: 0;
            font-size: 1.2rem;
        }

        .close-config-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-config-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .ad-config-content {
            padding: 20px;
        }

        .config-item {
            margin-bottom: 15px;
        }

        .config-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .config-item select,
        .config-item input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .config-item select:focus,
        .config-item input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .config-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .config-info p {
            margin: 0 0 10px 0;
            font-weight: 500;
            color: #333;
        }

        .config-info ul {
            margin: 0;
            padding-left: 20px;
            color: #666;
        }

        .config-info li {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .ad-info {
            text-align: center;
            width: 100%;
            max-width: 500px;
        }

        .ad-progress {
            margin-bottom: 25px;
            width: 100%;
            text-align: center;
        }

        .ad-progress .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
            width: 100%;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .ad-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            color: #4a5568;
            font-weight: 500;
        }

                .ad-benefits {
            background: #f7fafc;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            width: 100%;
            text-align: center;
        }
        
        .ad-benefits h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .ad-benefits ul {
            list-style: none;
            padding: 0;
            display: inline-block;
            text-align: left;
        }
        
        .ad-benefits li {
            color: #4a5568;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .ad-benefits li:before {
            content: "‚úì";
            color: #10b981;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

                .ad-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .ad-actions .btn {
            min-width: 120px;
            margin: 0 5px;
        }

        /* ÊµãËØïËøõÂ∫¶Êù°Ê†∑Âºè */
        .test-progress-info {
            margin-top: 15px;
            text-align: center;
        }
        
        .progress-badge {
            display: block;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .test-progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 0 auto;
            max-width: 300px;
        }
        
        .test-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .test-stage-indicator {
            margin-top: 12px;
        }
        
        .stage-text {
            display: inline-block;
            background: rgba(255, 255, 255, 0.8);
            color: #333;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* ÈóÆÈ¢òËß£ÈáäÊ†∑Âºè */
        .question-explanation {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 12px;
            border-left: 4px solid #2196f3;
            animation: explanationSlideIn 0.5s ease;
        }

        /* ÈóÆÈ¢òÂõæÊñáÊ†∑Âºè */
        .question-emoji {
            font-size: 4rem;
            text-align: center;
            margin-bottom: 20px;
            animation: emojiFloat 3s ease-in-out infinite;
        }

        @keyframes emojiFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .question-image {
            width: 100%;
            max-width: 300px;
            height: auto;
            border-radius: 12px;
            margin: 0 auto 20px;
            display: block;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease;
        }

        .question-image:hover {
            transform: scale(1.05);
        }

        .question-icon {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 20px;
            color: #667eea;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.5;
            text-align: center;
        }

        .cross-test-hint {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #fff;
            padding: 12px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(255, 154, 158, 0.3);
            animation: crossTestPulse 2s ease-in-out infinite;
        }

        .cross-test-detail {
            font-size: 0.85rem;
            margin-top: 8px;
            opacity: 0.9;
            line-height: 1.3;
            font-weight: 400;
        }

        @keyframes crossTestPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .question-scenario {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 0.95rem;
            line-height: 1.4;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        .scenario-icon {
            font-size: 1.1rem;
            margin-right: 8px;
        }

        @keyframes explanationSlideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .explanation-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .explanation-icon {
            font-size: 1.2rem;
            color: #2196f3;
        }

        .explanation-text {
            color: #1565c0;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        /* Áª¥Â∫¶ËøõÂ∫¶Ê†∑Âºè */
        .dimension-progress {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .progress-label {
            color: #4a5568;
            font-weight: 500;
        }

        .progress-value {
            color: #667eea;
            font-weight: 600;
        }

        /* ‰∫§ÂèâÊµãËØïÂÖ≥Á≥ªÂõæÊ†∑Âºè */
        .cross-test-relationship {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .relationship-title {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            text-align: center;
            margin-bottom: 15px;
        }

        .relationship-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .relationship-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .relationship-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: scale(1.02);
        }

        .dimension-pair {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .status {
            font-size: 1.1rem;
        }

        /* ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢Ê†∑Âºè */
        .forgot-password-section {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }

        .verification-code-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .verification-code-group input {
            flex: 1;
        }

        .send-code-btn {
            white-space: nowrap;
            padding: 12px 16px;
            font-size: 0.9rem;
        }

        .send-code-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .password-strength {
            margin-top: 8px;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
        }
        .password-strength::before {
            content: '';
            display: block;
            height: 100%;
            width: 0%;
            transition: all 0.3s ease;
            border-radius: 2px;
        }

        .password-strength.weak::before {
            width: 25%;
            background: #e53e3e;
        }

        .password-strength.fair::before {
            width: 50%;
            background: #d69e2e;
        }

        .password-strength.good::before {
            width: 75%;
            background: #38a169;
        }

        .password-strength.strong::before {
            width: 100%;
            background: #2f855a;
        }

        .forgot-password-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .forgot-password-options .btn {
            padding: 10px 20px;
            font-size: 0.9rem;
        }

        /* ÂÄíËÆ°Êó∂Ê†∑Âºè */
        .countdown {
            color: #718096;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        /* ÊàêÂäüÊèêÁ§∫Ê†∑Âºè */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
            margin-bottom: 20px;
            text-align: center;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #f5c6cb;
            margin-bottom: 20px;
            text-align: center;
        }

        /* ‰∫íÂä®ÂºèÈ°µËÑöÊ†∑Âºè */
        .footer {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            color: white;
            margin-top: 60px;
            padding: 0;
            border-radius: 25px 25px 0 0;
            box-shadow: 0 -15px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .footer-content.interactive {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
        }

        /* È°µËÑöÂ§¥ÈÉ® */
        .footer-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
        }

        .company-intro h3 {
            font-size: 2rem;
            font-weight: 700;
            margin: 0 0 10px 0;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .company-intro p {
            font-size: 1.1rem;
            margin: 0;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .interactive-stats {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        .stat-counter {
            text-align: center;
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-width: 120px;
            transition: all 0.3s ease;
        }

        .stat-counter:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .stat-counter .counter {
            display: block;
            font-size: 2.5rem;
            font-weight: 800;
            color: #fbbf24;
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .stat-counter .unit {
            font-size: 1.5rem;
            font-weight: 700;
            color: #fbbf24;
        }

        .stat-counter .label {
            display: block;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 8px;
            font-weight: 500;
        }

        /* È°µËÑö‰∏ª‰Ωì */
        .footer-body {
            padding: 40px 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            background: rgba(255, 255, 255, 0.02);
        }

        .footer-section.interactive h4 {
            color: #f7fafc;
            font-size: 1.2rem;
            margin-bottom: 25px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
            position: relative;
        }

        .footer-section.interactive h4::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: #fbbf24;
            transition: width 0.3s ease;
        }

        .footer-section.interactive:hover h4::after {
            width: 100%;
        }

        /* ËÅîÁ≥ªÊñπÂºè */
        .contact-methods {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .contact-method {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .contact-method:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(10px);
            border-color: #667eea;
        }

        .contact-method .icon {
            font-size: 1.5rem;
            margin-right: 15px;
            width: 40px;
            text-align: center;
        }

        .contact-method .text {
            color: #e2e8f0;
            font-weight: 500;
        }

        .contact-method .tooltip {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: #667eea;
            color: white;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .contact-method:hover .tooltip {
            opacity: 1;
        }

        /* Âø´ÈÄüÂèçÈ¶à */
        .feedback-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .feedback-btn {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
        }

        .feedback-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .feedback-btn[data-type="praise"]:hover {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }

        .feedback-btn[data-type="suggestion"]:hover {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .feedback-btn[data-type="bug"]:hover {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .feedback-btn .icon {
            font-size: 1.3rem;
            margin-right: 12px;
        }

        /* Âø´ÈÄüÈìæÊé• */
        .quick-links {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .quick-link {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #e2e8f0;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .quick-link:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(10px);
            border-color: #667eea;
            color: white;
        }

        .quick-link .icon {
            font-size: 1.3rem;
            margin-right: 12px;
            width: 25px;
            text-align: center;
        }

        /* È°µËÑöÂ∫ïÈÉ® */
        .footer-bottom {
            background: rgba(0, 0, 0, 0.3);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-info p {
            color: #a0aec0;
            margin: 5px 0;
            font-size: 0.9rem;
        }

        .footer-controls {
            display: flex;
            gap: 15px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #e2e8f0;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .footer-header {
                flex-direction: column;
                text-align: center;
                padding: 30px 20px;
            }
            
            .interactive-stats {
                justify-content: center;
            }
            
            .footer-body {
                grid-template-columns: 1fr;
                padding: 30px 20px;
                gap: 30px;
            }
            
            .footer-bottom {
                flex-direction: column;
                text-align: center;
                padding: 20px;
            }
            
            .stat-counter {
                min-width: 100px;
                padding: 15px;
            }
            
            .stat-counter .counter {
                font-size: 2rem;
            }
        }

        /* ‰∫åÁª¥Á†ÅÂºπÁ™óÊ†∑Âºè */
        .qr-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }

        .qr-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .qr-modal-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .qr-modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.2rem;
        }

        .qr-modal-body {
            padding: 30px;
            text-align: center;
        }

        .qr-placeholder {
            margin-bottom: 25px;
        }

        .qr-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .qr-placeholder p {
            color: #4a5568;
            margin: 8px 0;
        }

        .qr-info {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .qr-info p {
            color: #4a5568;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        /* ToastÊèêÁ§∫Ê†∑Âºè */
        .toast {
            animation: toastSlideIn 0.3s ease;
        }

        @keyframes toastSlideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* ÈòÖËØªÊèêÈÜíÂºπÁ™óÊ†∑Âºè */
        .reminder-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1001;
        }

        .reminder-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            overflow: hidden;
            animation: reminderSlideIn 0.3s ease;
        }

        @keyframes reminderSlideIn {
            from {
                transform: scale(0.8) translateY(20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .reminder-modal-header {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            padding: 20px;
            text-align: center;
        }

        .reminder-modal-header h3 {
            margin: 0;
            color: white;
            font-size: 1.3rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .reminder-modal-body {
            padding: 30px;
            text-align: center;
        }

        .reminder-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: reminderPulse 2s infinite;
        }

        @keyframes reminderPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .reminder-modal-body h4 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .reminder-modal-body p {
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .reminder-modal-body ul {
            text-align: left;
            display: inline-block;
            margin: 20px 0;
        }

        .reminder-modal-body li {
            color: #4a5568;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .reminder-modal-body li:before {
            content: "‚ö†Ô∏è";
            position: absolute;
            left: 0;
            color: #f59e0b;
        }

        .reminder-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .reminder-actions .btn {
            min-width: 120px;
            padding: 12px 24px;
        }

        /* ÂºπÁ™óÊ†∑Âºè */
        .policy-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }

        .policy-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .policy-modal-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .policy-modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
        }

        .policy-modal-body {
            padding: 30px;
        }

        /* ÂèçÈ¶àÂºπÁ™óÊ†∑Âºè */
        .feedback-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .feedback-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .feedback-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .feedback-modal-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .feedback-modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
        }

        .feedback-modal-body {
            padding: 30px;
        }

        .feedback-form-modal .form-group {
            margin-bottom: 20px;
        }

        .feedback-form-modal label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 500;
        }

        .feedback-form-modal input,
        .feedback-form-modal select,
        .feedback-form-modal textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
        }

        .feedback-form-modal input:focus,
        .feedback-form-modal select:focus,
        .feedback-form-modal textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .feedback-form-modal textarea {
            resize: vertical;
            min-height: 100px;
        }

        .feedback-form-modal .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feedback-form-modal .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .feedback-form-modal .btn:active {
            transform: translateY(0);
        }

        /* Â§¥ÈÉ®Â∏ÉÂ±ÄÊ†∑Âºè */
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 20px;
        }

        .header-content {
            flex: 1;
        }

        .user-info {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-shrink: 0;
        }

        .user-info .btn {
            padding: 8px 16px;
            font-size: 0.9rem;
            border-radius: 6px;
        }



        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
        }
        .logout-btn:hover {
            background: #c82333;
        }

        /* ÂäüËÉΩÊ†èÁõÆÊ†∑Âºè */
        .features-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            margin: 30px 0;
            border-radius: 16px;
            color: white;
            text-align: center;
        }

        .features-section h2 {
            margin-bottom: 15px;
            font-size: 2rem;
            font-weight: 600;
        }

        .features-section p {
            margin-bottom: 30px;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .feature-card h3 {
            margin-bottom: 10px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .feature-card p {
            margin-bottom: 15px;
            font-size: 0.95rem;
            opacity: 0.9;
            line-height: 1.5;
        }

        .feature-status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .feature-status.active {
            background: #28a745;
            color: white;
        }

        .feature-status.coming-soon {
            background: #ffc107;
            color: #212529;
        }
        


        /* ÂäüËÉΩÂºπÁ™óÊ†∑Âºè */
        .feature-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }

        .feature-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .feature-modal-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .feature-modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
        }

        .feature-modal-body {
            padding: 30px;
            text-align: center;
        }

        .feature-modal-body p {
            margin-bottom: 20px;
            color: #4a5568;
            line-height: 1.6;
        }

        /* ÊòüÂ∫ß+MBTIËûçÂêàÊµãËØïÂºπÁ™óÊ†∑Âºè */
        .zodiac-mbti-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }

        .zodiac-mbti-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .zodiac-mbti-modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .zodiac-mbti-modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* ÊòüÂ∫ß+MBTIÂºπÁ™óÁöÑÂÖ≥Èó≠ÊåâÈíÆÁâπÊÆäÊ†∑Âºè */
        .zodiac-mbti-modal-header .close-btn {
            color: white !important;
            background: rgba(255, 255, 255, 0.2) !important;
            border: 2px solid rgba(255, 255, 255, 0.4) !important;
            font-size: 2rem !important;
            font-weight: bold !important;
            width: 40px !important;
            height: 40px !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
        }

        .zodiac-mbti-modal-header .close-btn:hover {
            background: rgba(255, 255, 255, 0.3) !important;
            border-color: rgba(255, 255, 255, 0.6) !important;
            transform: scale(1.1) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4) !important;
        }

        .zodiac-mbti-modal-header .close-btn:active {
            transform: scale(0.95) !important;
        }

        .zodiac-mbti-modal-body {
            padding: 30px;
        }

        .zodiac-mbti-modal .test-section {
            margin-bottom: 30px;
        }

        .zodiac-mbti-modal .test-section h4 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3rem;
            text-align: center;
        }

        .zodiac-mbti-modal .form-group {
            margin-bottom: 20px;
        }

        .zodiac-mbti-modal .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 500;
        }

        .zodiac-mbti-modal .form-group input,
        .zodiac-mbti-modal .form-group select,
        .zodiac-mbti-modal .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
            transition: border-color 0.3s ease;
        }

        .zodiac-mbti-modal .form-group input:focus,
        .zodiac-mbti-modal .form-group select:focus,
        .zodiac-mbti-modal .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .zodiac-mbti-modal .question-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .zodiac-mbti-modal .question-card h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1rem;
        }

        .zodiac-mbti-modal .question-card p {
            margin-bottom: 15px;
            color: #555;
            line-height: 1.6;
        }

        .zodiac-mbti-modal .options-list {
            list-style: none;
            padding: 0;
        }

        .zodiac-mbti-modal .option-item {
            margin-bottom: 12px;
        }

        .zodiac-mbti-modal .option-radio {
            margin-right: 10px;
        }

        .zodiac-mbti-modal .option-label {
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
            display: block;
        }

        .zodiac-mbti-modal .option-label:hover {
            background-color: #e3f2fd;
        }

        .zodiac-mbti-modal .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .zodiac-mbti-modal .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .zodiac-mbti-modal .fusion-type {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }

        .zodiac-mbti-modal .fusion-type h2 {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .zodiac-mbti-modal .fusion-type p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .zodiac-mbti-modal .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .zodiac-mbti-modal .report-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            border-left: 4px solid #667eea;
        }

        .zodiac-mbti-modal .report-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .zodiac-mbti-modal .report-card ul {
            list-style: none;
            padding-left: 0;
        }

        .zodiac-mbti-modal .report-card li {
            padding: 8px 0;
            border-bottom: 1px solid #e1e5e9;
        }

        .zodiac-mbti-modal .report-card li:last-child {
            border-bottom: none;
        }

        .zodiac-mbti-modal .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .zodiac-mbti-modal .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .zodiac-mbti-modal-content {
                max-width: 95%;
                margin: 10px;
            }
            
            .zodiac-mbti-modal .report-grid {
                grid-template-columns: 1fr;
            }
        }

        .feature-status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .feature-status-badge.active {
            background: #28a745;
            color: white;
        }

        .feature-status-badge.coming-soon {
            background: #ffc107;
            color: #212529;
        }

        .feature-actions {
            margin-top: 20px;
        }

        .feature-actions .btn {
            padding: 12px 24px;
            font-size: 1rem;
            border-radius: 8px;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .header-top {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .user-info {
                margin-top: 15px;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                padding: 0 10px;
            }
            
            .feature-card {
                padding: 20px;
            }
        }

        /* ÊîøÁ≠ñÂºπÁ™óÊåâÈíÆÊ†∑Âºè */
        .policy-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .policy-actions-top {
            margin-top: 0;
            margin-bottom: 25px;
            padding-top: 0;
            padding-bottom: 20px;
            border-top: none;
            border-bottom: 1px solid #e9ecef;
        }

        .policy-actions .btn {
            min-width: 120px;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .policy-actions .btn-secondary {
            background: #6c757d;
            color: white;
            border: none;
        }

        .policy-actions .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
        }

        .policy-actions .btn-primary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .policy-actions .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .policy-actions .btn-primary:hover::before {
            left: 100%;
        }

        .policy-actions .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .policy-actions .btn-primary:active {
            transform: translateY(-1px);
        }

        .feedback-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
        }

        .feedback-actions .btn {
            min-width: 120px;
            padding: 12px 24px;
        }

        /* ÁÇπËµûÂºπÁ™óÊ†∑Âºè */
        .praise-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1001;
        }

        .praise-modal-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            overflow: hidden;
            animation: praiseSlideIn 0.3s ease;
        }

        @keyframes praiseSlideIn {
            from {
                transform: scale(0.8) translateY(20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .praise-modal-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            padding: 20px;
            text-align: center;
        }

        .praise-modal-header h3 {
            margin: 0;
            color: white;
            font-size: 1.3rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .praise-modal-body {
            padding: 30px;
        }

        .praise-intro {
            text-align: center;
            margin-bottom: 30px;
        }

        .praise-intro p {
            color: #4a5568;
            font-size: 1.1rem;
            margin: 0;
        }

        .praise-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .praise-option {
            display: flex;
            align-items: center;
            padding: 20px;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .praise-option:hover {
            background: #edf2f7;
            border-color: #10b981;
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.2);
        }

        .praise-option:active {
            transform: scale(0.98);
        }

        .praise-icon {
            font-size: 1.5rem;
            margin-right: 20px;
            min-width: 80px;
            text-align: center;
        }

        .praise-text {
            flex: 1;
        }

        .praise-text h4 {
            color: #2d3748;
            margin: 0 0 8px 0;
            font-size: 1.2rem;
        }

        .praise-text p {
            color: #718096;
            margin: 0;
            line-height: 1.5;
        }

        .praise-arrow {
            font-size: 1.5rem;
            color: #10b981;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .praise-option:hover .praise-arrow {
            opacity: 1;
        }

        .praise-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .praise-actions .btn {
            min-width: 120px;
            padding: 12px 24px;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .praise-modal-content {
                margin: 20px;
                max-width: calc(100% - 40px);
            }
            
            .praise-option {
                padding: 15px;
            }
            
            .praise-icon {
                font-size: 1.2rem;
                margin-right: 15px;
                min-width: 60px;
            }
            
            .praise-text h4 {
                font-size: 1.1rem;
            }
            
            .praise-text p {
                font-size: 0.9rem;
            }
        }

        /* ÊâãÊú∫Âè∑Ê≥®ÂÜåÂºπÁ™óÊ†∑Âºè */
        .phone-register-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1001;
        }

        .phone-register-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 0;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            animation: phoneSlideIn 0.3s ease;
        }

        @keyframes phoneSlideIn {
            from {
                transform: scale(0.8) translateY(20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .phone-register-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            text-align: center;
        }

        .phone-register-header h3 {
            margin: 0;
            color: white;
            font-size: 1.3rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .phone-register-body {
            padding: 30px;
        }

        .verification-info {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .verification-info p {
            margin: 5px 0;
            color: #0369a1;
        }

        .countdown-text {
            font-weight: 600;
            color: #dc2626;
        }

        .verification-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .verification-input-group input {
            flex: 1;
        }

        .verification-input-group .btn {
            white-space: nowrap;
            padding: 12px 16px;
            font-size: 0.9rem;
        }
        .verification-input-group .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .phone-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }

        .phone-actions .btn {
            min-width: 120px;
            padding: 12px 24px;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .phone-register-content {
                margin: 20px;
                max-width: calc(100% - 40px);
            }
            
            .verification-input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .phone-actions {
                flex-direction: column;
                align-items: stretch;
            }
        }

        .policy-modal-body h4 {
            color: #2d3748;
            margin: 25px 0 15px;
            font-size: 1.1rem;
        }

        .policy-modal-body h4:first-child {
            margin-top: 0;
        }

        .policy-modal-body p {
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .policy-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .policy-actions .btn {
            min-width: 120px;
            padding: 12px 24px;
        }

        .policy-actions .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }

        .policy-actions .btn-secondary:hover {
            background: #cbd5e0;
            border-color: #a0aec0;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .footer-bottom-content {
                flex-direction: column;
                text-align: center;
            }
            
            .footer-stats {
                justify-content: center;
            }
            
            .social-links {
                justify-content: center;
            }
            
            .feedback-modal-content,
            .policy-modal-content {
                margin: 20px;
                max-width: calc(100% - 40px);
            }
        }
    </style>
    <style>
        /* Âº∫Âà∂ÈöêËóèÊâÄÊúâÂπøÂëä/ÊäïÊîæÁõ∏ÂÖ≥Âå∫Âüü */
        .ad-section,
        .ad-config-panel,
        .google-adsense-ad,
        ins.adsbygoogle { display: none !important; visibility: hidden !important; }
    </style>
    <!-- Flatpickr (English) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        if (window.flatpickr) {
          const birthDateInput = document.getElementById('birthDate');
          if (birthDateInput) {
            window.flatpickr(birthDateInput, {
              dateFormat: 'Y-m-d',
              locale: 'en',
              allowInput: true,
              maxDate: 'today'
            });
          }
          const birthTimeInput = document.getElementById('birthTime');
          if (birthTimeInput) {
            window.flatpickr(birthTimeInput, {
              enableTime: true,
              noCalendar: true,
              dateFormat: 'H:i',
              time_24hr: true,
              locale: 'en',
              minuteIncrement: 1
            });
          }
        }
      });
    </script>
</head>
<body>
    <div class="container">
        <!-- ‰∏ªÊ†áÈ¢ò -->
        <div class="header" id="mainHeader">
            <div class="header-top">
                <div class="header-content">
                                <h1>üß† MBTI Personality Test</h1>
            <p>Discover your personality type and understand your true self</p>
                </div>
                

                
                <!-- Áî®Êà∑ÁôªÂΩï/Ê≥®ÂÜåÊåâÈíÆÂ∑≤ÈöêËóè -->
            </div>
        </div>

        <!-- ÂäüËÉΩÊ†èÁõÆÂå∫Âüü -->
        <div class="features-section" id="featuresSection">
            <h2>üåü Explore More Mystical Tests</h2>
            <p>Besides MBTI personality test, we have more interesting tests waiting for you</p>
            
            <div class="features-grid">
                <div class="feature-card" onclick="showMBTIWelcome()">
                    <div class="feature-icon">üß†</div>
                    <h3 data-i18n="features.mbtitest.title">Professional MBTI Test</h3>
                    <p data-i18n="features.mbtitest.desc">Professional test based on Jung's theory of 16 personality types, fast and accurate</p>
                    <div class="feature-status active" data-i18n="common.start_test">Start Test</div>
                </div>
                
                <div class="feature-card" id="zodiacMbtiExperienceCard" onclick="location.href='zodiac-mbti-fusion.html'">
                    <div class="feature-icon">‚ôà</div>
                    <h3>Fun Zodiac Test</h3>
                    <p>Light and fun zodiac personality test, explore your zodiac traits</p>
                    <div class="feature-status active">Start Test</div>
                </div>
                
                <div class="feature-card" onclick="location.href='bazi-test.html'">
                    <div class="feature-icon">üìÖ</div>
                    <h3>Bazi Fortune Telling</h3>
                    <p>Traditional Chinese astrology, interpret your destiny code</p>
                    <div class="feature-status active">Start Test</div>
                </div>
                
                <div class="feature-card" onclick="location.href='tarot-test.html'">
                    <div class="feature-icon">üîÆ</div>
                    <h3>Tarot Card Test</h3>
                    <p>Mysterious tarot cards, reveal your inner world</p>
                    <div class="feature-status active">Start Test</div>
                </div>
                
                <div class="feature-card" onclick="showFeatureInfo('numerology')">
                    <div class="feature-icon">üî¢</div>
                    <h3>Numerology</h3>
                    <p>Interpret your personality and destiny through numbers</p>
                    <div class="feature-status active">Start Test</div>
                </div>
                
                <div class="feature-card" onclick="showFeatureInfo('chinese-zodiac')">
                    <div class="feature-icon">üêâ</div>
                    <h3>Chinese Zodiac Test</h3>
                    <p>Deep analysis of twelve zodiac animal personality traits</p>
                    <div class="feature-status active">Start Test</div>
                </div>
            </div>
        </div>

        <!-- ÊòüÂ∫ß+MBTIËûçÂêàÊµãËØïÂºπÁ™ó -->
        <div class="zodiac-mbti-modal hidden" id="zodiacMBTIModal">
            <div class="zodiac-mbti-modal-content">
                <div class="zodiac-mbti-modal-header">
                    <h3>üåü Ë∂£Âë≥ÊòüÂ∫ßÊµãËØï</h3>
                    <button class="close-btn" onclick="closeZodiacMBTIModal()">&times;</button>
                    <!-- Ë∞ÉËØïÊåâÈíÆÂ∑≤ÈöêËóè -->
                </div>
                <div class="zodiac-mbti-modal-body">
                    <!-- Basic Information Collection -->
                    <div class="test-section" id="basicInfoSection">
                        <h4>üìÖ Basic Information Collection</h4>
                        <div class="form-group">
                            <label for="birthDate">Birth Date</label>
                            <input type="text" id="birthDate" lang="en" placeholder="YYYY-MM-DD Êàñ ÂÜúÂéÜ2020Âπ¥ÂçÅÊúàÂàù‰∏â" required>
                            <div class="muted" style="margin-top:6px">ÊîØÊåÅÔºöYYYY-MM-DD / YYYY/MM/DD / MM/DD/YYYY / YYYYMMDD / YYYY.M.D / YYYYÂπ¥MÊúàDÊó• / ÂÜúÂéÜ/Èò¥ÂéÜÔºàÂê´Èó∞ÊúàÔºâ„ÄÇÁ§∫‰æãÔºöÂÜúÂéÜ2020Âπ¥Èó∞ÂõõÊúàÂàù‰∏Ä</div>
                        </div>
                        <div class="form-group">
                            <label for="birthTime">Birth Time (Precise to minute)</label>
                            <input type="time" id="birthTime" required>
                        </div>
                        <div class="form-group">
                            <button class="btn" type="button" onclick="setIndexSample('gregorian')" style="background:#10b981">Á§∫‰æã(ÂÖ¨ÂéÜ)</button>
                            <button class="btn" type="button" onclick="setIndexSample('lunar')" style="background:#8b5cf6; margin-left:8px">Á§∫‰æã(ÂÜúÂéÜ)</button>
                            <button class="btn" type="button" onclick="setIndexSample('leap')" style="background:#ef4444; margin-left:8px">Á§∫‰æã(Èó∞Êúà)</button>
                        </div>
                        <div class="form-group">
                            <label for="birthPlace">Birth Place</label>
                            <input type="text" id="birthPlace" placeholder="e.g., Beijing, Shanghai, Guangzhou" required>
                        </div>
                        <button class="btn" onclick="startZodiacTest()" id="startTestBtn">Start Test</button>
                        <p style="text-align: center; color: #666; font-size: 0.9rem; margin-top: 10px;">
                            üí° Click this button to save your birth information and start the test
                        </p>
                        <!-- Test data save button hidden -->
                        <!--
                        <div style="text-align: center; margin-top: 15px;">
                            <button class="btn" onclick="testDataSave()" style="background: #4ecdc4; padding: 8px 16px; font-size: 0.9rem;">Test Data Save</button>
                        </div>
                        -->
                    </div>

                    <!-- MBTI Test Section -->
                    <div class="test-section hidden" id="mbtiSection">
                        <h4>üß† MBTI Personality Test</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="mbtiProgress"></div>
                        </div>
                        <div id="mbtiQuestions"></div>
                        <button class="btn btn-secondary" onclick="previousZodiacSection('basicInfoSection')">Back</button>
                        <button class="btn" onclick="nextZodiacSection('zodiacSection')" id="mbtiNextBtn" disabled>Submit</button>
                    </div>

                    <!-- Zodiac Traits Test -->
                    <div class="test-section hidden" id="zodiacSection">
                        <h4>‚ôà Zodiac Traits Test</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="zodiacProgress"></div>
                        </div>
                        <div id="zodiacQuestions"></div>
                        <button class="btn btn-secondary" onclick="previousZodiacSection('mbtiSection')">Back</button>
                        <button class="btn" onclick="nextZodiacSection('fusionSection')" id="zodiacNextBtn" disabled>Next</button>
                    </div>

                    <!-- Fusion Verification Test -->
                    <div class="test-section hidden" id="fusionSection">
                        <h4>üîÑ Fusion Verification Test</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="fusionProgress"></div>
                        </div>
                        <div id="fusionQuestions"></div>
                        <button class="btn btn-secondary" onclick="previousZodiacSection('zodiacSection')">Back</button>
                        <button class="btn" onclick="generateZodiacResults()" id="fusionNextBtn" disabled>Generate Results</button>
                    </div>

                    <!-- Results Display -->
                    <div class="test-section hidden" id="zodiacResultSection">
                        <h4>üéØ Your Fusion Test Results</h4>
                        <div id="zodiacFusionResult"></div>
                        <div id="zodiacDetailedReport"></div>
                        <button class="btn btn-secondary" onclick="restartZodiacTest()">Restart Test</button>
                        <button class="btn" onclick="shareZodiacResults()">Share Results</button>
                    </div>

                    <!-- Loading State -->
                    <div class="loading hidden" id="zodiacLoadingSection">
                        <div class="spinner"></div>
                        <p>Analyzing your zodiac traits and MBTI preferences...</p>
                    </div>
                </div>
            </div>
        </div>





        <!-- Login Page -->
        <div class="login-section hidden" id="loginSection">
            <div class="login-card">
                <div class="login-header">
                    <h1>üîê Login to MBTI Test</h1>
                    <p>Please login to start your personality exploration journey</p>
                    <button class="close-overlay-btn" onclick="closeLogin()">&times;</button>
                </div>
                
                <form class="login-form" id="loginForm">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" placeholder="Enter username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" placeholder="Enter password" required>
                    </div>
                    
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="rememberMe">
                            <span class="checkmark"></span>
                            Remember me
                        </label>
                        <a href="#" class="forgot-password" onclick="showForgotPassword()">Forgot password?</a>
                    </div>
                    
                    <button type="submit" class="btn login-btn">Login</button>
                </form>
                
                <!-- Google ÁôªÂΩïÊåâÈíÆÂ∑≤Âà†Èô§ -->
                
                <div class="register-link">
                    <p>Don't have an account? <a href="#" onclick="showRegister()">Register now</a></p>
                </div>
            </div>
        </div>

        <!-- Register Page -->
        <div class="register-section hidden" id="registerSection">
            <div class="login-card">
                <div class="login-header">
                    <h1>üìù Register Account</h1>
                    <p>Create your MBTI test account</p>
                    <button class="close-overlay-btn" onclick="closeRegister()">&times;</button>
                </div>
                
                <form class="login-form" id="registerForm">
                    <div class="form-group">
                        <label for="regUsername">Username</label>
                        <input type="text" id="regUsername" name="username" placeholder="Enter username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="regEmail">Email</label>
                        <input type="email" id="regEmail" name="email" placeholder="Enter email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="regPassword">Password</label>
                        <input type="password" id="regPassword" name="password" placeholder="Enter password" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="regConfirmPassword">Confirm Password</label>
                        <input type="password" id="regConfirmPassword" name="confirmPassword" placeholder="Enter password again" required>
                    </div>
                    
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="agreeTerms" required>
                            <span class="checkmark"></span>
                            I agree to <a href="#" class="terms-link">Terms of Service</a> and <a href="#" class="terms-link">Privacy Policy</a>
                        </label>
                    </div>
                    
                    <button type="submit" class="btn login-btn">Register</button>
                </form>
                
                <!-- Google register button deleted -->
                
                <div class="register-link">
                    <p>Already have an account? <a href="#" onclick="showLogin()">Login now</a></p>
                </div>
            </div>
        </div>

        <!-- MBTI Introduction Section -->
        <div class="card mbti-info-section hidden" id="mbtiInfoSection">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2>üß† MBTI Personality Type Theory Explained</h2>
                                    <!-- Back to test button hidden -->
                    <!--
                    <button class="btn btn-secondary" onclick="hideMBTIInfo()" style="margin-top: 20px;">Back to Test</button>
                    -->
            </div>
            
            <div class="mbti-content">
                <div class="dimension-explanation">
                    <h3>üìä Four Core Dimensions</h3>
                    
                    <div class="dimension-card">
                        <h4>1. Energy Direction (E - I)</h4>
                        <div class="dimension-details">
                            <div class="dimension-side">
                                <h5>Extraversion (E)</h5>
                                <ul>
                                    <li>Gain energy from the external world</li>
                                    <li>Enjoy socializing and interaction</li>
                                    <li>Action-oriented, like to express</li>
                                    <li>Feel energized in crowds</li>
                                    <li>Like variety and stimulation</li>
                                </ul>
                            </div>
                            <div class="dimension-side">
                                <h5>Introversion (I)</h5>
                                <ul>
                                    <li>Gain energy from the inner world</li>
                                    <li>Enjoy solitude and deep thinking</li>
                                    <li>Thought-oriented, like to listen</li>
                                    <li>Recharge energy in quiet environments</li>
                                    <li>Like focus and depth</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="dimension-card">
                        <h4>2. Information Reception (S - N)</h4>
                        <div class="dimension-details">
                            <div class="dimension-side">
                                <h5>Sensing (S)</h5>
                                <ul>
                                    <li>Focus on concrete facts and details</li>
                                    <li>Trust experience and tradition</li>
                                    <li>Like practical and verifiable information</li>
                                    <li>Live in the present, focus on reality</li>
                                    <li>Like step-by-step approaches</li>
                                </ul>
                            </div>
                            <div class="dimension-side">
                                <h5>Intuition (N)</h5>
                                <ul>
                                    <li>Focus on possibilities and future</li>
                                    <li>Trust innovation and change</li>
                                    <li>Like theories and concepts</li>
                                    <li>Focus on the whole and patterns</li>
                                    <li>Like to think in leaps</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="dimension-card">
                        <h4>3. Decision Making (T - F)</h4>
                        <div class="dimension-details">
                            <div class="dimension-side">
                                <h5>Thinking (T)</h5>
                                <ul>
                                    <li>Based on logic and objective analysis</li>
                                    <li>Pursue fairness and consistency</li>
                                    <li>Value truth and accuracy</li>
                                    <li>Analyze problems, find solutions</li>
                                    <li>May appear direct and frank</li>
                                </ul>
                            </div>
                            <div class="dimension-side">
                                <h5>Feeling (F)</h5>
                                <ul>
                                    <li>Based on values and feelings</li>
                                    <li>Pursue harmony and relationships</li>
                                    <li>Value human connection and empathy</li>
                                    <li>Consider impact on others</li>
                                    <li>May appear gentle and caring</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="dimension-card">
                        <h4>4. Lifestyle (J - P)</h4>
                        <div class="dimension-details">
                            <div class="dimension-side">
                                <h5>Judging (J)</h5>
                                <ul>
                                    <li>Like planning and structure</li>
                                    <li>Complete tasks on time</li>
                                    <li>Like clear expectations</li>
                                    <li>Stick to decisions once made</li>
                                    <li>Like control and certainty</li>
                                </ul>
                            </div>
                            <div class="dimension-side">
                                <h5>Perceiving (P)</h5>
                                <ul>
                                    <li>Like flexibility and options</li>
                                    <li>Stay open and adaptable</li>
                                    <li>Like exploration and discovery</li>
                                    <li>Delay decisions, gather information</li>
                                    <li>Like spontaneity and freedom</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="personality-types">
                    <h3>üåü 16 Personality Types Overview</h3>
                    <div class="types-grid">
                        <div class="type-card">
                            <h4>INTJ - Architect</h4>
                            <p>Imaginative and strategic thinkers, everything must be carefully considered</p>
                        </div>
                        <div class="type-card">
                            <h4>INTP - Logician</h4>
                            <p>Innovative inventors with an insatiable thirst for knowledge</p>
                        </div>
                        <div class="type-card">
                            <h4>ENTJ - Commander</h4>
                            <p>Bold, imaginative and strong leaders, always finding or creating solutions</p>
                        </div>
                        <div class="type-card">
                            <h4>ENTP - Debater</h4>
                            <p>Smart and curious thinkers who never miss an intellectual challenge</p>
                        </div>
                        <div class="type-card">
                            <h4>INFJ - Advocate</h4>
                            <p>Quiet and mysterious, yet inspiring and tireless idealists</p>
                        </div>
                        <div class="type-card">
                            <h4>INFP - Mediator</h4>
                            <p>Poetic, kind altruists who are always passionate about fighting for just causes</p>
                        </div>
                        <div class="type-card">
                            <h4>ENFJ - Protagonist</h4>
                            <p>Charismatic and inspiring leaders with innate leadership abilities</p>
                        </div>
                        <div class="type-card">
                            <h4>ENFP - Campaigner</h4>
                            <p>Enthusiastic, creative and socially skilled individuals who can find possibilities to connect with others</p>
                        </div>
                        <div class="type-card">
                            <h4>ISTJ - Logistician</h4>
                            <p>Practical and fact-focused reliable individuals whose reliability is unquestionable</p>
                        </div>
                        <div class="type-card">
                            <h4>ISFJ - Defender</h4>
                            <p>Very dedicated and warm guardians, always ready to protect loved ones</p>
                        </div>
                        <div class="type-card">
                            <h4>ESTJ - Executive</h4>
                            <p>Excellent managers, unparalleled in managing things or people</p>
                        </div>
                        <div class="type-card">
                            <h4>ESFJ - Consul</h4>
                            <p>Extremely caring about others' feelings, known for warmth and friendliness</p>
                        </div>
                        <div class="type-card">
                            <h4>ISTP - Virtuoso</h4>
                            <p>Bold and practical experimenters, skilled at using various tools</p>
                        </div>
                        <div class="type-card">
                            <h4>ISFP - Adventurer</h4>
                            <p>Flexible and charming artists, always ready to explore and experience new things</p>
                        </div>
                        <div class="type-card">
                            <h4>ESTP - Entrepreneur</h4>
                            <p>Smart, energetic and very perceptive people who truly enjoy life's excitement</p>
                        </div>
                        <div class="type-card">
                            <h4>ESFP - Entertainer</h4>
                            <p>Spontaneous, energetic and enthusiastic performers whose lives are never boring</p>
                        </div>
                    </div>
                </div>

                <div class="mbti-tips">
                    <h3>üí° MBTI Usage Tips</h3>
                    <div class="tips-content">
                        <div class="tip-item">
                            <h4>Understanding, Not Labeling</h4>
                            <p>MBTI is a tool to help you better understand yourself and others, not to label people. Everyone is a unique individual.</p>
                        </div>
                        <div class="tip-item">
                            <h4>Development, Not Limitation</h4>
                            <p>Understanding your preferences can help you leverage your strengths while consciously developing other abilities.</p>
                        </div>
                        <div class="tip-item">
                            <h4>Communication and Understanding</h4>
                            <p>Understanding different personality types can help you communicate better with others and build more harmonious relationships.</p>
                        </div>
                        <div class="tip-item">
                            <h4>Career Development</h4>
                            <p>Understanding your personality type can provide reference for career choices and development direction, but should not be the only basis.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Section -->
        <div class="card test-section hidden" id="testSection">
            <div class="test-header">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="test-stage-display">
                    <span class="stage-badge" id="currentStageBadge">üå± Personality Foundation Exploration</span>
                </div>
            </div>
            
            <div class="question-container">
                <div class="question-text" id="questionText"></div>
                <div class="options-container" id="optionsContainer"></div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" style="display: none;">Previous</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()" disabled>Next</button>
            </div>
        </div>

        <!-- Results Section -->
        <div class="card result-section hidden" id="resultSection">
            <h2>üéâ Test Completed!</h2>
            <div class="personality-type" id="personalityType"></div>
            
            <div class="dimensions" id="dimensionsContainer"></div>
            
            <div class="description">
                <h3>Your Personality Type Analysis</h3>
                <div id="typeDescription"></div>
            </div>
            
                                    <!-- Restart test button hidden -->
                        <!--
                        <button class="btn btn-secondary" onclick="restartTest()" style="margin-top: 30px;">Restart Test</button>
                        -->
        </div>

        <!-- Advertisement Page -->
        <div class="ad-section hidden" id="adSection">
            <div class="ad-container">
                <div class="ad-header">
                    <h2>üì∫ Watch Ad to Continue Test</h2>
                    <p>To support free testing services, please watch the following ad before continuing</p>
                    <div class="test-progress-info">
                        <span class="progress-badge">Test Progress: Question <span id="currentQuestionNumber"></span> / 10</span>
                        <div class="test-progress-bar">
                            <div class="test-progress-fill" id="testProgressFill"></div>
                        </div>
                        <div class="test-stage-indicator">
                            <span class="stage-text" id="testStageText"></span>
                        </div>
                    </div>
                </div>
                
                <div class="ad-content">
                    <div class="ad-video-placeholder">
                        <div class="ad-video-frame">
                            <!-- Google AdSense ÂπøÂëäÂÆπÂô®Â∑≤Âà†Èô§ -->
                            
                            <!-- Fallback Ad Content -->
                            <div id="fallback-ad" class="fallback-ad" style="display: none;">
                                <div class="ad-video-player">
                                    <div class="ad-header">
                                        <div class="ad-badge">Recommended</div>
                                        <div class="ad-sponsor">MBTI Test</div>
                                </div>
                                    <div class="ad-content-main">
                                        <div class="ad-icon">üß†</div>
                                        <div class="ad-title">MBTI Personality Test Results Unlock</div>
                                        <div class="ad-subtitle">Discover your true personality type</div>
                                        <div class="ad-features">
                                            <span class="feature">‚ú® Professional Analysis</span>
                                            <span class="feature">üìä Detailed Report</span>
                                            <span class="feature">üéØ Career Advice</span>
                                        </div>
                                    </div>
                                    <div class="ad-footer">
                                        <div class="ad-duration">‚è±Ô∏è 15s</div>
                                        <div class="ad-action">Watch to Unlock</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ad-info">
                        <div class="ad-progress">
                            <div class="progress-bar">
                                <div class="ad-progress-fill" id="adProgressFill"></div>
                            </div>
                            <div class="progress-text">
                                <span id="adCountdown">15</span> seconds to unlock results
                            </div>
                        </div>
                        
                        <div class="ad-benefits">
                            <h3>Benefits of watching ads:</h3>
                            <ul>
                                <li>‚úÖ Continue completing the MBTI test</li>
                                <li>‚úÖ Get full personality analysis results</li>
                                <li>‚úÖ Support us to keep the service free</li>
                                <li>‚úÖ No hidden fees</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="ad-actions">
                    <button class="btn btn-secondary" onclick="skipAd()">Skip Ad</button>
                    <button class="btn" onclick="watchAd()" id="watchAdBtn">Start Watching</button>
                    <button class="btn btn-info" onclick="toggleAdConfig()" style="margin-top: 10px; font-size: 0.9rem;">Ad Configuration</button>
                    <!-- ÊµãËØïÊåâÈíÆÂ∑≤ÈöêËóè -->
                    <!--
                    <button class="btn btn-success" onclick="testAdSense()" style="margin-top: 10px; font-size: 0.9rem;">ÊµãËØïAdSense</button>

                    <button class="btn btn-primary" onclick="testQuestionDisplay()" style="margin-top: 10px; font-size: 0.9rem;">ÊµãËØïÈóÆÈ¢òÊòæÁ§∫</button>
                    -->
                </div>

                <!-- ÂπøÂëäÈÖçÁΩÆÈù¢Êùø -->
                <div id="adConfigPanel" class="ad-config-panel" style="display: none;">
                    <div class="ad-config-header">
                        <h4>üîß Ad Configuration</h4>
                        <button class="close-config-btn" onclick="toggleAdConfig()">&times;</button>
            </div>
                    <div class="ad-config-content">
                        <div class="config-item">
                            <label>Google AdSense:</label>
                            <select id="adSenseEnabled" onchange="updateAdConfig()">
                                <option value="false">Use Fallback Ads</option>
                                <option value="true">Enable AdSense</option>
                            </select>
                        </div>
                        <div class="config-item">
                            <label>Publisher ID:</label>
                            <input type="text" id="adClientId" placeholder="ca-pub-XXXXXXXXXX" onchange="updateAdConfig()">
                        </div>
                        <div class="config-item">
                            <label>Ad Slot ID:</label>
                            <input type="text" id="adSlotId" placeholder="XXXXXXXXXX" onchange="updateAdConfig()">
                        </div>
                                        <div class="config-info">
                    <p><strong>Instructions:</strong></p>
                    <ul>
                        <li>‚Ä¢ Fallback Ads: No configuration needed, display directly</li>
                        <li>‚Ä¢ AdSense: Requires Google AdSense account and ad slots</li>
                        <li>‚Ä¢ Refresh page after configuration to take effect</li>
                    </ul>
                    
                    <div class="adsense-status" style="margin-top: 15px; padding: 10px; background: #e8f5e8; border-radius: 6px;">
                        <p><strong>AdSense Status:</strong></p>
                        <ul>
                            <li>‚Ä¢ Script Loading: <span id="scriptStatus">Checking...</span></li>
                            <li>‚Ä¢ Publisher ID: <span id="publisherStatus">Configured</span></li>
                            <li>‚Ä¢ Ad Slot ID: <span id="slotStatus">Needs Configuration</span></li>
                            <li>‚Ä¢ Connection Status: <span id="connectionStatus">Testing...</span></li>
                        </ul>
                    </div>
                </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Forgot Password Page -->
        <div class="forgot-password-section hidden" id="forgotPasswordSection">
            <div class="login-card">
                <div class="login-header">
                    <h1>üîë Forgot Password</h1>
                    <p>Please enter your email address, we will send a reset link</p>
                    <button class="close-overlay-btn" onclick="closeForgotPassword()">&times;</button>
                </div>
                
                <!-- Step 1: Email Input -->
                <div id="forgotPasswordStep1">
                    <div class="form-group">
                        <label for="resetEmail">Email Address</label>
                        <input type="email" id="resetEmail" name="email" placeholder="Enter the email used for registration" required>
                    </div>
                    
                    <button type="button" class="btn login-btn" onclick="sendResetEmail()">Send Reset Link</button>
                    
                    <div class="forgot-password-options">
                        <button class="btn btn-secondary" onclick="showLogin()">Back to Login</button>
                        <button class="btn btn-secondary" onclick="showRegister()">Register New Account</button>
                    </div>
                </div>
                
                <!-- Step 2: Verification Code and New Password -->
                <div id="forgotPasswordStep2" style="display: none;">
                    <div class="form-group">
                        <label for="resetCode">Verification Code</label>
                        <div class="verification-code-group">
                            <input type="text" id="resetCode" name="code" placeholder="Enter 6-digit verification code" maxlength="6" required>
                            <button type="button" class="btn btn-secondary send-code-btn" onclick="sendVerificationCode()">
                                Resend
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="newPassword">New Password</label>
                        <input type="password" id="newPassword" name="password" placeholder="Enter new password" required>
                        <div class="password-strength" id="passwordStrength"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmNewPassword">Confirm New Password</label>
                        <input type="password" id="confirmNewPassword" name="confirmPassword" placeholder="Enter new password again" required>
                    </div>
                    
                    <button type="submit" class="btn login-btn" onclick="resetPassword()">Reset Password</button>
                    
                    <div class="forgot-password-options">
                        <button class="btn btn-secondary" onclick="backToStep1()">Back to Previous Step</button>
                        <button class="btn btn-secondary" onclick="showLogin()">Back to Login</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Section -->
        <footer class="footer">
            <div class="footer-content interactive">
                <div class="footer-header">
                    <div class="company-intro">
                        <h3>üß† MBTI Personality Test Platform</h3>
                        <p>Professional ¬∑ Accurate ¬∑ Convenient</p>
                    </div>
                    <div class="interactive-stats">
                        <div class="stat-counter" data-target="100">
                            <span class="counter">0</span>
                            <span class="unit">+</span>
                            <span class="label">People Tested</span>
                        </div>
                        <div class="stat-counter" data-target="99.99">
                            <span class="counter">0</span>
                            <span class="unit">%</span>
                            <span class="label">Accuracy</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-body">
                    <div class="footer-section interactive">
                        <h4>üìû Contact Us</h4>
                        <div class="contact-methods">
                            <div class="contact-method" onclick="copyToClipboard('junpengpanchina@gmail.com')">
                                <span class="icon">üìß</span>
                                <span class="text">Copy Email</span>
                                <span class="tooltip">Click to Copy</span>
                            </div>
                            <div class="contact-method" onclick="copyToClipboard('15626005076')">
                                <span class="icon">üì±</span>
                                <span class="text">Copy Phone</span>
                                <span class="tooltip">Click to Copy</span>
                            </div>
                            <div class="contact-method" onclick="showQRCode()">
                                <span class="icon">üí¨</span>
                                <span class="text">WeChat QR Code</span>
                                <span class="tooltip">View QR Code</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="footer-section interactive">
                        <h4>üí¨ Quick Feedback</h4>
                        <div class="feedback-buttons">
                            <button class="feedback-btn" data-type="praise" onclick="showPraiseOptions()">
                                <span class="icon">üëç</span>
                                <span class="text">Great!</span>
                            </button>
                            <button class="feedback-btn" data-type="improvement" onclick="quickFeedback('improvement')">
                                <span class="icon">üöÄ</span>
                                <span class="text">Feature Request</span>
                            </button>
                            <button class="feedback-btn" data-type="bug" onclick="quickFeedback('bug')">
                                <span class="icon">üêõ</span>
                                <span class="text">Bug Report</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="footer-section interactive">
                        <h4>üîó Quick Links</h4>
                        <div class="quick-links">
                            <a href="#" class="quick-link" onclick="showMBTIInfo()">
                                <span class="icon">üìö</span>
                                <span class="text">MBTI Introduction</span>
                            </a>
                            <a href="#" class="quick-link" onclick="showPrivacyPolicy()">
                                <span class="icon">üîí</span>
                                <span class="text">Privacy Policy</span>
                            </a>
                            <a href="#" class="quick-link" onclick="showTermsOfService()">
                                <span class="icon">üìã</span>
                                <span class="text">Terms of Service</span>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <div class="footer-info">
                        <p>&copy; 2024 MBTI Personality Test</p>
                        <p>Based on Jungian typology theory, for entertainment and reference only</p>
                    </div>
                    <div class="footer-controls">
                        <button class="control-btn" onclick="backToTop()">‚¨ÜÔ∏è Back to Top</button>
                        <button class="control-btn" onclick="toggleTheme()">üåô Toggle Theme</button>
                    </div>
                </div>
            </div>
        </footer>

        <!-- Feedback Modal -->
        <div class="feedback-modal hidden" id="feedbackModal">
            <div class="feedback-modal-content">
                <div class="feedback-modal-header">
                    <h3>üí¨ Feedback</h3>
                    <button class="close-btn" onclick="closeFeedbackModal()">&times;</button>
                </div>
                <div class="feedback-modal-body">
                    <form class="feedback-form-modal" id="feedbackFormModal" onsubmit="handleFeedbackSubmit(event)">
                        <div class="form-group">
                            <label for="modalFeedbackName">Name</label>
                            <input type="text" id="modalFeedbackName" name="name" placeholder="Enter your name" required>
                        </div>
                        <div class="form-group">
                            <label for="modalFeedbackEmail">Email</label>
                            <input type="email" id="modalFeedbackEmail" name="email" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label for="modalFeedbackType">Feedback Type</label>
                            <select id="modalFeedbackType" name="type" required>
                                <option value="">Please select feedback type</option>
                                <option value="praise">Praise</option>
                                <option value="improvement">Feature Request</option>
                                <option value="bug">Bug Report</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="modalFeedbackMessage">Message</label>
                            <textarea id="modalFeedbackMessage" name="message" placeholder="Please describe your opinions or suggestions in detail..." rows="5" required></textarea>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="modalAgreePrivacy" name="agreePrivacy" required>
                                <span class="checkmark"></span>
                                I agree to <a href="#" onclick="showPrivacyPolicy()">Privacy Policy</a>
                            </label>
                        </div>
                        <button type="submit" class="btn">Submit Feedback</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Privacy Policy Modal -->
        <div class="policy-modal hidden" id="privacyPolicyModal">
            <div class="policy-modal-content">
                <div class="policy-modal-header">
                    <h3>üîí Privacy Policy</h3>
                    <button class="close-btn" onclick="closePolicyModal()">&times;</button>
                </div>
                <div class="policy-modal-body">
                    <div class="policy-actions policy-actions-top">
                        <button class="btn btn-secondary" onclick="closePolicyModal()">Close</button>
                        <button class="btn btn-primary" onclick="acknowledgePrivacyPolicy()">I Understand</button>
                    </div>
                    
                    <h4>Information Collection</h4>
                    <p>We only collect necessary personal information during testing, including test answers and basic user information.</p>
                    
                    <h4>Information Usage</h4>
                    <p>Collected information is only used to provide MBTI testing services and improve user experience, not for other commercial purposes.</p>
                    
                    <h4>Information Protection</h4>
                    <p>We adopt industry-standard security measures to protect your personal information from unauthorized access, use, or disclosure.</p>
                    
                    <h4>Information Sharing</h4>
                    <p>We will not sell, trade, or transfer your personal information to third parties without your explicit consent.</p>
                    
                    <h4>Cookie Usage</h4>
                    <p>We use cookies to improve website functionality and user experience. You can disable cookies in your browser settings.</p>
                </div>
            </div>
        </div>

        <!-- Terms of Service Modal -->
        <div class="policy-modal hidden" id="termsModal">
            <div class="policy-modal-content">
                <div class="policy-modal-header">
                    <h3>üìã Terms of Service</h3>
                    <button class="close-btn" onclick="closeTermsModal()">&times;</button>
                </div>
                <div class="policy-modal-body">
                    <div class="policy-actions policy-actions-top">
                        <button class="btn btn-secondary" onclick="showReadReminder()">Cancel</button>
                        <button class="btn btn-primary" id="agreeTermsBtn" onclick="acknowledgeTerms()">I Understand and Agree</button>
                    </div>
                    
                    <h4>Service Description</h4>
                    <p>This website provides free MBTI personality testing services. Test results are for entertainment and reference only.</p>
                    
                    <h4>User Responsibilities</h4>
                    <p>Users should ensure the information provided is true and accurate, and must not maliciously damage website functionality or affect other users.</p>
                    
                    <h4>Disclaimer</h4>
                    <p>Test results are for reference only and do not constitute professional psychological advice. Please consult a professional psychologist if needed.</p>
                    
                    <h4>Service Changes</h4>
                    <p>We reserve the right to modify or terminate services at any time without prior notice.</p>
                    
                    <h4>Governing Law</h4>
                    <p>These terms of service are governed by the laws of the People's Republic of China. In case of disputes, the Chinese version shall prevail.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // MBTI Test Questions - Progressive Depth + Multi-dimensional Cross-validation + Visual Enhancement
        const questions = [
            // ===== Level 1: Basic Preference Testing =====
            {
                id: 1,
                level: 1,
                question: "In social situations, you usually:",
                options: ["A. Actively engage in conversations with others, enjoy being the center of attention", "B. Tend to observe others, become active only in familiar environments"],
                dimension: "EI",
                category: "social_energy",
                weight: 1.0,
                explanation: "This question tests how you gain social energy",
                image: "üåê",
                visualType: "emoji",
                crossTest: ["EI", "SN"],
                scenario: "Imagine you're attending a friend's party with many strangers in the room..."
            },
            {
                id: 2,
                level: 1,
                question: "You tend to:",
                options: ["A. Focus on specific details and current reality", "B. Think about possibilities and future trends"],
                dimension: "SN",
                category: "information_processing",
                weight: 1.0,
                explanation: "This question tests how you receive and process information",
                image: "üîç",
                visualType: "emoji",
                crossTest: ["SN", "JP"],
                scenario: "When you need to make a decision, you focus more on..."
            },
            {
                id: 3,
                level: 1,
                question: "When you need to make a decision, you rely more on:",
                options: ["A. Logical analysis and objective facts", "B. Personal values and feelings"],
                dimension: "TF",
                category: "decision_making",
                weight: 1.0,
                explanation: "This question tests your decision-making style",
                image: "‚öñÔ∏è",
                visualType: "emoji",
                crossTest: ["TF", "SN"],
                scenario: "Facing an important choice, you would..."
            },
            {
                id: 4,
                level: 1,
                question: "You prefer a work environment that is:",
                options: ["A. Clearly structured and planned", "B. Flexible and adaptable to changes"],
                dimension: "JP",
                category: "lifestyle_preference",
                weight: 1.0,
                explanation: "This question tests your lifestyle preferences",
                image: "üè¢",
                visualType: "emoji",
                crossTest: ["JP", "EI"],
                scenario: "Imagine your ideal work environment..."
            },

            // ===== Level 2: Specific Behavior Testing =====
            {
                id: 5,
                level: 2,
                question: "In team meetings, you usually:",
                options: ["A. Actively speak up, share ideas and opinions", "B. Listen carefully, offer suggestions at appropriate times"],
                dimension: "EI",
                category: "team_communication",
                weight: 1.2,
                explanation: "Based on your social preferences, testing specific performance in teams",
                requires: "EI",
                image: "üë•",
                visualType: "emoji",
                crossTest: ["EI", "TF"],
                scenario: "Imagine you're attending an important team meeting discussing a new project proposal...",
                visualHint: "Meeting scene with some people actively speaking and others listening attentively"
            },
            {
                id: 6,
                level: 2,
                question: "Â≠¶‰π†Êñ∞ÊäÄËÉΩÊó∂Ôºå‰Ω†Êõ¥ÂñúÊ¨¢Ôºö",
                options: ["A. ÈÄöËøáÂÆûÈôÖÊìç‰ΩúÂíåÁªÉ‰π†Êù•ÊéåÊè°", "B. ÂÖàÁêÜËß£Ê¶ÇÂøµÂíåÂéüÁêÜÔºåÂÜç‰ªòËØ∏ÂÆûË∑µ"],
                dimension: "SN",
                category: "learning_style",
                weight: 1.2,
                explanation: "Âü∫‰∫é‰Ω†ÁöÑ‰ø°ÊÅØÂ§ÑÁêÜÊñπÂºèÔºåÊµãËØïÂÖ∑‰ΩìÁöÑÂ≠¶‰π†ÂÅèÂ•Ω",
                requires: "SN",
                image: "üìö",
                visualType: "emoji",
                crossTest: ["SN", "JP"],
                scenario: "ÊÉ≥Ë±°‰Ω†Ë¶ÅÂ≠¶‰π†‰∏ÄÈó®Êñ∞ÁöÑÁºñÁ®ãËØ≠Ë®ÄÔºå‰Ω†‰ºöÈÄâÊã©Âì™ÁßçÊñπÂºèÔºü",
                visualHint: "Â≠¶‰π†Âú∫ÊôØÔºåÊúâ‰∫∫Áõ¥Êé•Âä®ÊâãÔºåÊúâ‰∫∫ÂÖàÁúã‰π¶"
            },
            {
                id: 7,
                level: 2,
                question: "Èù¢ÂØπÊúãÂèãÁöÑÊÉÖÊÑüÈóÆÈ¢òÊó∂Ôºå‰Ω†‰ºöÔºö",
                options: ["A. ÂàÜÊûêÈóÆÈ¢òÁöÑÈÄªËæëÔºåÂ∏ÆÂä©ÊâæÂà∞Ëß£ÂÜ≥ÊñπÊ°à", "B. ÂÄæÂê¨ÊÑüÂèóÔºåÊèê‰æõÊÉÖÊÑüÊîØÊåÅÂíåÂÆâÊÖ∞"],
                dimension: "TF",
                category: "emotional_support",
                weight: 1.2,
                explanation: "Âü∫‰∫é‰Ω†ÁöÑÂÜ≥Á≠ñÊñπÂºèÔºåÊµãËØïÊÉÖÊÑüÊîØÊåÅÁöÑÂÖ∑‰ΩìË°®Áé∞",
                requires: "TF"
            },
            {
                id: 8,
                level: 2,
                question: "Â§ÑÁêÜÂ∑•‰Ωú‰ªªÂä°Êó∂Ôºå‰Ω†ÂÄæÂêë‰∫éÔºö",
                options: ["A. Âà∂ÂÆöËØ¶ÁªÜËÆ°ÂàíÔºåÊåâÊ≠•È™§ÊâßË°å", "B. ‰øùÊåÅÁÅµÊ¥ªÊÄßÔºåÊ†πÊçÆÊÉÖÂÜµË∞ÉÊï¥Á≠ñÁï•"],
                dimension: "JP",
                category: "work_organization",
                weight: 1.2,
                explanation: "Âü∫‰∫é‰Ω†ÁöÑÁîüÊ¥ªÊñπÂºèÂÅèÂ•ΩÔºåÊµãËØïÂ∑•‰ΩúÁªÑÁªáÊñπÂºè",
                requires: "JP"
            },

            // ===== Á¨¨‰∏âÂ±ÇÔºöÊ∑±Â∫¶ÂàÜÊûêÊµãËØï =====
            {
                id: 9,
                level: 3,
                question: "ÂΩìÈúÄË¶ÅÂàõÊñ∞Ëß£ÂÜ≥ÊñπÊ°àÊó∂Ôºå‰Ω†‰ºöÔºö",
                options: ["A. Âü∫‰∫éÁé∞ÊúâÁªèÈ™åÂíåÊàêÂäüÊ°à‰æãËøõË°åÊîπËøõ", "B. Ë∑≥Âá∫Ê°ÜÊû∂ÔºåÊé¢Á¥¢ÂÖ®Êñ∞ÁöÑÂèØËÉΩÊÄß"],
                dimension: "SN",
                category: "innovation_approach",
                weight: 1.5,
                explanation: "Ê∑±Â∫¶ÊµãËØï‰Ω†ÁöÑÂàõÊñ∞ÊÄùÁª¥Ê®°Âºè",
                requires: ["SN", "TF"]
            },
            {
                id: 10,
                level: 3,
                question: "Âú®ÂéãÂäõÊÉÖÂÜµ‰∏ãÔºå‰Ω†Êõ¥‰æùËµñÔºö",
                options: ["A. Á≥ªÁªüÊÄßÁöÑÂàÜÊûêÂíåËßÑÂàí", "B. Áõ¥ËßâÂíåÂø´ÈÄüÂà§Êñ≠"],
                dimension: "SN",
                category: "stress_response",
                weight: 1.5,
                explanation: "ÊµãËØïÂéãÂäõ‰∏ãÁöÑÂÜ≥Á≠ñÂÅèÂ•Ω",
                requires: ["SN", "JP"]
            },
            {
                id: 11,
                level: 3,
                question: "Â§ÑÁêÜ‰∫∫ÈôÖÂÖ≥Á≥ªÂÜ≤Á™ÅÊó∂Ôºå‰Ω†‰ºòÂÖàËÄÉËôëÔºö",
                options: ["A. ÂÖ¨Âπ≥ÂíåÂéüÂàôÁöÑÁª¥Êä§", "B. ÂÖ≥Á≥ªÁöÑÂíåË∞êÂíåÈïøÊúüÂèëÂ±ï"],
                dimension: "TF",
                category: "conflict_resolution",
                weight: 1.5,
                explanation: "Ê∑±Â∫¶ÊµãËØï‰Ω†ÁöÑ‰ª∑ÂÄºËßÇÂíåÂÜ≤Á™ÅÂ§ÑÁêÜÊñπÂºè",
                requires: ["TF", "EI"]
            },
            {
                id: 12,
                level: 3,
                question: "Èù¢ÂØπÂèòÂåñÂíå‰∏çÁ°ÆÂÆöÊÄßÊó∂Ôºå‰Ω†‰ºöÔºö",
                options: ["A. ÂØªÊ±ÇÁ®≥ÂÆöÂíåÊéßÂà∂ÔºåÂà∂ÂÆöÂ∫îÂØπËÆ°Âàí", "B. ‰øùÊåÅÂºÄÊîæÂíåÈÄÇÂ∫îÔºå‰∫´ÂèóÂèòÂåñÂ∏¶Êù•ÁöÑÊú∫‰ºö"],
                dimension: "JP",
                category: "change_adaptation",
                weight: 1.5,
                explanation: "ÊµãËØï‰Ω†ÂØπÂèòÂåñÁöÑÈÄÇÂ∫îËÉΩÂäõ",
                requires: ["JP", "SN"]
            },

            // ===== Á¨¨ÂõõÂ±ÇÔºö‰∫§ÂèâÈ™åËØÅÊµãËØï =====
            {
                id: 13,
                level: 4,
                question: "Âú®Âõ¢ÈòüÈ¢ÜÂØº‰∏≠Ôºå‰Ω†Êõ¥ÊìÖÈïøÔºö",
                options: ["A. Âà∂ÂÆöÊòéÁ°ÆÁõÆÊ†áÔºåÁõëÁù£ÊâßË°åËøáÁ®ã", "B. ÊøÄÂèëÂõ¢ÈòüÂàõÊÑèÔºåËê•ÈÄ†ÂºÄÊîæÊ∞õÂõ¥"],
                dimension: "JP",
                category: "leadership_style",
                weight: 2.0,
                explanation: "‰∫§ÂèâÈ™åËØÅ‰Ω†ÁöÑÈ¢ÜÂØºÈ£éÊ†ºÂÅèÂ•Ω",
                requires: ["JP", "EI", "TF"]
            },
            {
                id: 14,
                level: 4,
                question: "Ëß£ÂÜ≥ÈóÆÈ¢òÊó∂Ôºå‰Ω†ÁöÑÊÄùÁª¥ËøáÁ®ãÊòØÔºö",
                options: ["A. ÈÄêÊ≠•ÂàÜÊûêÔºåÁ°Æ‰øùÊØè‰∏™ÁéØËäÇÈÉΩÂáÜÁ°Æ", "B. Êï¥‰ΩìÊääÊè°ÔºåÂø´ÈÄüËØÜÂà´ÂÖ≥ÈîÆË¶ÅÁ¥†"],
                dimension: "SN",
                category: "problem_solving",
                weight: 2.0,
                explanation: "‰∫§ÂèâÈ™åËØÅ‰Ω†ÁöÑÈóÆÈ¢òËß£ÂÜ≥ÊñπÂºè",
                requires: ["SN", "TF", "JP"]
            },
            {
                id: 15,
                level: 4,
                question: "Âú®‰∏™‰∫∫ÂèëÂ±ï‰∏≠Ôºå‰Ω†Êõ¥ÈáçËßÜÔºö",
                options: ["A. ÊäÄËÉΩÁöÑÊèêÂçáÂíåÊàêÂ∞±ÁöÑËé∑Âæó", "B. ÂÜÖÂú®ÁöÑÊàêÈïøÂíåÂÖ≥Á≥ªÁöÑÂª∫Á´ã"],
                dimension: "TF",
                category: "personal_growth",
                weight: 2.0,
                explanation: "‰∫§ÂèâÈ™åËØÅ‰Ω†ÁöÑ‰∏™‰∫∫ÂèëÂ±ï‰ª∑ÂÄºËßÇ",
                requires: ["TF", "EI", "SN"]
            },
            {
                id: 16,
                level: 4,
                question: "Èù¢ÂØπÂ§çÊùÇÈ°πÁõÆÊó∂Ôºå‰Ω†ÁöÑÂ∑•‰ΩúÊñπÂºèÊòØÔºö",
                options: ["A. Á≥ªÁªüËßÑÂàíÔºåÂàÜÈò∂ÊÆµÊé®Ëøõ", "B. ÁÅµÊ¥ªË∞ÉÊï¥ÔºåÊäì‰ΩèÂÖ≥ÈîÆÊó∂Êú∫"],
                dimension: "JP",
                category: "project_management",
                weight: 2.0,
                explanation: "‰∫§ÂèâÈ™åËØÅ‰Ω†ÁöÑÈ°πÁõÆÁÆ°ÁêÜÈ£éÊ†º",
                requires: ["JP", "SN", "EI"]
            },

            // ===== Á¨¨‰∫îÂ±ÇÔºöÁªºÂêàÈ™åËØÅÊµãËØï =====
            {
                id: 17,
                level: 5,
                question: "Âú®ÈáçË¶ÅÂÜ≥Á≠ñ‰∏≠Ôºå‰Ω†ÁöÑÂÜ≥Á≠ñÊ®°ÂºèÊòØÔºö",
                options: ["A. Êî∂ÈõÜÂÖÖÂàÜ‰ø°ÊÅØÔºåÂàÜÊûêÂà©ÂºäÔºåÂà∂ÂÆöËØ¶ÁªÜËÆ°Âàí", "B. Áõ∏‰ø°Áõ¥ËßâÂà§Êñ≠Ôºå‰øùÊåÅÁÅµÊ¥ªÊÄßÔºåÊ†πÊçÆÊÉÖÂÜµË∞ÉÊï¥"],
                dimension: "JP",
                category: "problem_solving",
                weight: 2.5,
                explanation: "ÁªºÂêàÈ™åËØÅ‰Ω†ÁöÑÂÜ≥Á≠ñÊ®°Âºè",
                requires: ["JP", "SN", "TF", "EI"]
            },
            {
                id: 18,
                level: 5,
                question: "‰Ω†ÁöÑÁêÜÊÉ≥Â∑•‰ΩúÁéØÂ¢ÉÂ∫îËØ•ÂÖ∑Â§áÔºö",
                options: ["A. Ê∏ÖÊô∞ÁöÑÁªìÊûÑ„ÄÅÊòéÁ°ÆÁöÑÁõÆÊ†á„ÄÅÁ®≥ÂÆöÁöÑÊµÅÁ®ã", "B. ÂàõÊñ∞ÁöÑÊ∞õÂõ¥„ÄÅÁÅµÊ¥ªÁöÑÂÆâÊéí„ÄÅÂèòÂåñÁöÑÊú∫‰ºö"],
                dimension: "JP",
                category: "ideal_workplace",
                weight: 2.5,
                explanation: "ÁªºÂêàÈ™åËØÅ‰Ω†ÁöÑÂ∑•‰ΩúÁéØÂ¢ÉÂÅèÂ•Ω",
                requires: ["JP", "SN", "EI", "TF"]
            },
            {
                id: 19,
                level: 5,
                question: "Âú®‰∫∫ÈôÖÂÖ≥Á≥ª‰∏≠Ôºå‰Ω†Êõ¥ÁúãÈáçÔºö",
                options: ["A. ÁúüËØöÁöÑ‰∫§ÊµÅ„ÄÅÂÖ±ÂêåÁöÑÁõÆÊ†á„ÄÅÁõ∏‰∫íÁöÑÂ∞äÈáç", "B. ÊÉÖÊÑüÁöÑËøûÊé•„ÄÅ‰∏™ÊÄßÁöÑË°®Ëææ„ÄÅËá™Áî±ÁöÑÊ∞õÂõ¥"],
                dimension: "TF",
                category: "relationship_values",
                weight: 2.5,
                explanation: "ÁªºÂêàÈ™åËØÅ‰Ω†ÁöÑ‰∫∫ÈôÖÂÖ≥Á≥ª‰ª∑ÂÄºËßÇ",
                requires: ["TF", "EI", "SN", "JP"]
            },
            {
                id: 20,
                level: 5,
                question: "‰Ω†ÁöÑÁîüÊ¥ªÂì≤Â≠¶Êõ¥ÂÄæÂêë‰∫éÔºö",
                options: ["A. ÈÄöËøáËßÑÂàíÂíåÂä™ÂäõÂÆûÁé∞ÁõÆÊ†áÔºåÂàõÈÄ†ÊúâÂ∫èÁöÑÁîüÊ¥ª", "B. ‰øùÊåÅÂºÄÊîæÂíåÈÄÇÂ∫îÔºå‰∫´ÂèóÁîüÊ¥ªÁöÑÂ§öÊ†∑ÊÄßÂíåÂèØËÉΩÊÄß"],
                dimension: "JP",
                category: "life_philosophy",
                weight: 2.5,
                explanation: "ÁªºÂêàÈ™åËØÅ‰Ω†ÁöÑÁîüÊ¥ªÂì≤Â≠¶",
                requires: ["JP", "SN", "TF", "EI"]
            },

            // ===== ÊñáÁåÆÂª∫Ê®°Êâ©Â±ïÔºöÂü∫Á°ÄÂÅèÂ•ΩÔºàÂøÉÁêÜÁ±ªÂûã/Â§©Áîü‰∏çÂêåÔºâ =====
            {
                id: 21,
                level: 1,
                question: "ÂàùÂà∞Êñ∞ÁéØÂ¢ÉÊó∂Ôºå‰Ω†ÈÄöÂ∏∏Ôºö",
                options: ["A. ‰∏ªÂä®Â∞ùËØïËûçÂÖ•ÔºåÂø´ÈÄüÂª∫Á´ãËøûÊé•", "B. ÂÖàËßÇÂØüÊï¥‰ΩìÊ∞õÂõ¥ÔºåÊã©Êú∫ÂèÇ‰∏é"],
                dimension: "EI",
                category: "social_energy",
                weight: 1.0,
                explanation: "ÊÄÅÂ∫¶(E/I)ÂÅèÂ•ΩÔºàËç£Ê†º„ÄäÂøÉÁêÜÁ±ªÂûã„ÄãÔºâ",
                source: "ÂøÉÁêÜÁ±ªÂûã",
                facet: "ÊÄÅÂ∫¶(E/I)"
            },
            {
                id: 22,
                level: 1,
                question: "ÂÅöÊñπÊ°àÊó∂‰Ω†Êõ¥ÁúãÈáçÔºö",
                options: ["A. ÂèØÈ™åËØÅÁöÑÊï∞ÊçÆ‰∏éÊó¢ÊúâÁªèÈ™å", "B. ÊΩúÂú®Ê®°Âºè‰∏éÊú™Êù•ÂèØËÉΩ"],
                dimension: "SN",
                category: "information_processing",
                weight: 1.0,
                explanation: "ÂäüËÉΩ(S/N)ÂÅèÂ•ΩÔºàËç£Ê†º„ÄäÂøÉÁêÜÁ±ªÂûã„ÄãÔºâ",
                source: "ÂøÉÁêÜÁ±ªÂûã",
                facet: "ÂäüËÉΩ(S/N)"
            },
            {
                id: 23,
                level: 1,
                question: "Èù¢ÂØπÂàÜÊ≠ß‰Ω†Êõ¥ÂÄæÂêë‰∫éÔºö",
                options: ["A. ÂõûÂà∞Ê†áÂáÜ‰∏éËØÅÊçÆÔºåÁêÜÊ∏ÖÊòØÈùû", "B. ËÄÉÈáèÂèåÊñπÊÑüÂèóÔºåÈ°æÂèäÂÖ≥Á≥ª"],
                dimension: "TF",
                category: "decision_making",
                weight: 1.0,
                explanation: "ÂäüËÉΩ(T/F)ÂÅèÂ•ΩÔºàËç£Ê†º„ÄäÂøÉÁêÜÁ±ªÂûã„ÄãÔºâ",
                source: "ÂøÉÁêÜÁ±ªÂûã",
                facet: "ÂäüËÉΩ(T/F)"
            },
            {
                id: 24,
                level: 1,
                question: "‰Ω†ÁöÑÊó∂Èó¥ËßÇÊõ¥ÂÉèÔºö",
                options: ["A. ÂÖàÂÆöËÆ°ÂàíÂÜçÊé®ËøõÔºåÊåâÈÉ®Â∞±Áè≠", "B. ÂÖàÂêØÂä®Êé¢Á¥¢ÔºåÂÜçÈÄêÊ≠•ÊàêÂΩ¢"],
                dimension: "JP",
                category: "lifestyle_preference",
                weight: 1.0,
                explanation: "ÂèñÂêë(J/P)ÂÅèÂ•ΩÔºàMBTIÊ°ÜÊû∂Ôºâ",
                source: "Â§©Áîü‰∏çÂêå/ËØ∑ÁêÜËß£Êàë",
                facet: "ÂèñÂêë(J/P)"
            },

            // ===== ÊñáÁåÆÂª∫Ê®°Êâ©Â±ïÔºöÂÖ∑‰ΩìË°å‰∏∫ÔºàËØ∑ÁêÜËß£Êàë/Á±ªÂûã‰∏éÊ≤üÈÄöÔºâ =====
            {
                id: 25,
                level: 2,
                question: "Ê≤üÈÄöÊó∂‰Ω†Êõ¥Â∏∏Ôºö",
                options: ["A. Áõ¥ÈôàË¶ÅÁÇπÔºåËøΩÊ±ÇÊïàÁéá‰∏éÊ∏ÖÊô∞", "B. ÂÖàÂª∫Á´ãÊ∞õÂõ¥ÔºåÂæ™Â∫èÊ∏êËøõË°®Ëææ"],
                dimension: "EI",
                category: "team_communication",
                weight: 1.2,
                explanation: "Ê≤üÈÄöÂèñÂêëÔºà„ÄäÁ±ªÂûã‰∏éÊ≤üÈÄö„Äã„ÄäËØ∑ÁêÜËß£Êàë„ÄãÔºâ",
                source: "Á±ªÂûã‰∏éÊ≤üÈÄö",
                facet: "Ë°®Ëææ/ÂÄæÂê¨"
            },
            {
                id: 26,
                level: 2,
                question: "Â≠¶‰π†Ë∑ØÂæÑÈÄâÊã©Êó∂‰Ω†Êõ¥ÁúãÈáçÔºö",
                options: ["A. ÂèØÂ§çÁî®ÁöÑËåÉÂºè‰∏éÊúÄ‰Ω≥ÂÆûË∑µ", "B. ÂéüÁêÜÊ°ÜÊû∂‰∏éÊ®°ÂûãÊé®Êºî"],
                dimension: "SN",
                category: "learning_style",
                weight: 1.2,
                explanation: "ÁªèÈ™å(S) vs Áõ¥Ëßâ(N)ÁöÑÂ≠¶‰π†ÂÅèÂ•ΩÔºà„ÄäËØ∑ÁêÜËß£Êàë„ÄãÔºâ",
                source: "ËØ∑ÁêÜËß£Êàë",
                facet: "Â≠¶‰π†ÊñπÂºè"
            },
            {
                id: 27,
                level: 2,
                question: "ÂèçÈ¶à‰ªñ‰∫∫Êó∂‰Ω†Êõ¥Ôºö",
                options: ["A. ÊåáÂá∫ÈóÆÈ¢ò‰∏éÊîπËøõÂª∫ËÆÆ", "B. ÂÖàËÇØÂÆöÂÜçÊèêÂá∫ÊÑüÂèó‰∏éÊúüÊúõ"],
                dimension: "TF",
                category: "emotional_support",
                weight: 1.2,
                explanation: "ÂÜ≥Á≠ñ‰∏é‰∫∫ÈôÖÊùÉË°°Ôºà„ÄäÁ±ªÂûã‰∏éÊ≤üÈÄö„ÄãÔºâ",
                source: "Á±ªÂûã‰∏éÊ≤üÈÄö",
                facet: "ÂèçÈ¶àÈ£éÊ†º"
            },
            {
                id: 28,
                level: 2,
                question: "Èù¢ÂØπ‰∏çÁ°ÆÂÆö‰ªªÂä°‰Ω†ÈÄöÂ∏∏Ôºö",
                options: ["A. Âø´ÈÄüÊæÑÊ∏ÖÁõÆÊ†áÔºåÂàíÂàÜÈò∂ÊÆµÊé®Ëøõ", "B. ‰øùÊåÅÂºÄÊîæÊé¢Á¥¢ÔºåÂ§öÊñπÊ°àÂπ∂Ë°åËØïÈîô"],
                dimension: "JP",
                category: "work_organization",
                weight: 1.2,
                explanation: "ÁªìÊûÑ(J) vs Êú∫Âä®(P)Ôºà„ÄäËØ∑ÁêÜËß£Êàë„ÄãÔºâ",
                source: "ËØ∑ÁêÜËß£Êàë",
                facet: "ÁªÑÁªáÈ£éÊ†º"
            },

            // ===== ÊñáÁåÆÂª∫Ê®°Êâ©Â±ïÔºöÊ∑±Â∫¶ÂäüËÉΩÂÅèÂ•ΩÔºàÂøÉÁêÜÁ±ªÂûã/ËÆ§Áü•ÂäüËÉΩÔºâ =====
            {
                id: 29,
                level: 3,
                question: "Èù¢ÂêëÊú™Êù•ÁöÑÊÄùËÄÉ‰∏≠‰Ω†Êõ¥Ôºö",
                options: ["A. ‰ªéÂΩì‰∏ãÊï∞ÊçÆÂ§ñÊé®Ë∂ãÂäøÔºàSe/TeÂÄæÂêëÔºâ", "B. Áî±Áõ¥ËßâÊ¥ûËßÅÂõûÊé®Ë∑ØÂæÑÔºàNi/NeÂÄæÂêëÔºâ"],
                dimension: "SN",
                category: "innovation_approach",
                weight: 1.5,
                explanation: "ÊÑüÁü•/Áõ¥ËßâÁöÑÂäüËÉΩÂèñÂêëÔºàËç£Ê†ºÂäüËÉΩÔºâ",
                source: "ÂøÉÁêÜÁ±ªÂûã",
                facet: "ÂäüËÉΩÂèñÂêë"
            },
            {
                id: 30,
                level: 3,
                question: "ËØÑ‰º∞ÊñπÊ°à‰ºòÂÖàÁ∫ßÊó∂‰Ω†‰æßÈáçÔºö",
                options: ["A. ÂÆ¢ËßÇÊ†áÂáÜ„ÄÅ‰∏ÄËá¥ÊÄß‰∏éÂèØÂ§çÁé∞ÔºàTi/TeÔºâ", "B. ‰ª∑ÂÄºÂ•ëÂêà„ÄÅÂΩ±ÂìçÂÖ≥Á≥ª‰∏é‰∫∫Áæ§ÔºàFi/FeÔºâ"],
                dimension: "TF",
                category: "conflict_resolution",
                weight: 1.5,
                explanation: "ÊÄùËÄÉ/ÊÉÖÊÑüÁöÑÂäüËÉΩÂèñÂêëÔºàËç£Ê†ºÂäüËÉΩÔºâ",
                source: "ÂøÉÁêÜÁ±ªÂûã",
                facet: "ÂäüËÉΩÂèñÂêë"
            },
            {
                id: 31,
                level: 3,
                question: "Êé®ËøõÂ§çÊùÇËÆÆÈ¢òÊó∂‰Ω†Êõ¥Ôºö",
                options: ["A. ÈîÅÂÆöÁõÆÊ†á‰∏éË∑ØÂæÑÔºåÂáèÂ∞ëÂèòÈáèÔºàJÔºâ", "B. ‰øùÁïôÊé¢Á¥¢Á™óÂè£ÔºåÂä®ÊÄÅÈÄÇÈÖçÔºàPÔºâ"],
                dimension: "JP",
                category: "change_adaptation",
                weight: 1.5,
                explanation: "ÂèñÂêë(J/P)Âú®Â§çÊùÇÊÄßÊÉÖÂ¢É‰∏ãÁöÑË°®Áé∞",
                source: "Â§©Áîü‰∏çÂêå",
                facet: "Â§çÊùÇÊÄßÁÆ°ÁêÜ"
            },
            {
                id: 32,
                level: 3,
                question: "Á§æ‰∫§Â±ïÁ§∫‰∏≠‰Ω†Êõ¥Ôºö",
                options: ["A. ‰ª•‰ªªÂä°/ÁõÆÊ†áÈ©±Âä®‰∫íÂä®ÔºàE-‰ªªÂä°ÂûãÔºâ", "B. ‰ª•ÂÖ≥Á≥ª/Ê∞õÂõ¥È©±Âä®‰∫íÂä®ÔºàI-ÂÖ≥Á≥ªÂûãÔºâ"],
                dimension: "EI",
                category: "stress_response",
                weight: 1.5,
                explanation: "E/IÂú®ÁõÆÊ†á‰∏éÂÖ≥Á≥ª‰πãÈó¥ÁöÑ‰æßÈáç",
                source: "Á±ªÂûã‰∏éÊ≤üÈÄö",
                facet: "Á§æ‰∫§ÂèñÂêë"
            },

            // ===== ÊñáÁåÆÂª∫Ê®°Êâ©Â±ïÔºö‰∫§ÂèâÈ™åËØÅÔºàÁ±ªÂûã‰∏é‰∫≤ÂØÜÂÖ≥Á≥ª/Â∞±‰∏öÂÆùÂÖ∏Ôºâ =====
            {
                id: 33,
                level: 4,
                question: "‰∫≤ÂØÜÂÖ≥Á≥ª‰∏≠‰Ω†Êõ¥ÁúãÈáçÔºö",
                options: ["A. ÂÖ±ÂêåÁõÆÊ†á„ÄÅËßíËâ≤ÂàÜÂ∑•‰∏éÁ®≥ÂÆöÊÄß", "B. ÊÉÖÊÑüËøûÊé•„ÄÅË°®ËææËá™Áî±‰∏éÁêÜËß£"],
                dimension: "TF",
                category: "relationship_values",
                weight: 2.0,
                explanation: "‰º¥‰æ£ÊúüÊúõÁöÑ‰ª∑ÂÄºÂèñÂêëÔºà„ÄäÁ±ªÂûã‰∏é‰∫≤ÂØÜÂÖ≥Á≥ª„ÄãÔºâ",
                source: "Á±ªÂûã‰∏é‰∫≤ÂØÜÂÖ≥Á≥ª",
                facet: "‰º¥‰æ£ÊúüÊúõ"
            },
            {
                id: 34,
                level: 4,
                question: "ËÅå‰∏öÂú∫ÊôØÈáåÊõ¥ÈÄÇÈÖç‰Ω†ÁöÑÊòØÔºö",
                options: ["A. ËßÑÂàôÊòéÁ°Æ„ÄÅÊµÅÁ®ãÁ®≥ÂÆöÁöÑÂ≤ó‰ΩçÔºàSJ/NTÂÅèÂ•ΩÔºâ", "B. ÂàõÊÑèÈ©±Âä®„ÄÅÂèòÂåñÂø´ÈÄüÁöÑÂ≤ó‰ΩçÔºàSP/NFÂÅèÂ•ΩÔºâ"],
                dimension: "JP",
                category: "ideal_workplace",
                weight: 2.0,
                explanation: "ÂáØÂ∞îË•øÊ∞îË¥®‰∏éËÅå‰∏öÂåπÈÖçÔºà„ÄäÂ∞±‰∏öÂÆùÂÖ∏„ÄãÔºâ",
                source: "Â∞±‰∏öÂÆùÂÖ∏",
                facet: "Ê∞îË¥®‰∏éËÅå‰∏ö"
            },
            {
                id: 35,
                level: 4,
                question: "‰ø°ÊÅØËé∑ÂèñÊõ¥ÂÅèÂ•ΩÔºö",
                options: ["A. ‰∏ÄÊâã‰∫ãÂÆû„ÄÅÂèØÊµãÈáèÊåáÊ†áÔºàSÔºâ", "B. Ê®°ÂºèËØÜÂà´„ÄÅÈöêÂê´ÊÑè‰πâÔºàNÔºâ"],
                dimension: "SN",
                category: "problem_solving",
                weight: 2.0,
                explanation: "ÊÑüËßâ/Áõ¥ËßâÂú®Áü•ËØÜÊëÑÂÖ•ÁöÑÂ∑ÆÂºÇ",
                source: "ÂøÉÁêÜÁ±ªÂûã",
                facet: "‰ø°ÊÅØÂÅèÂ•Ω"
            },
            {
                id: 36,
                level: 4,
                question: "Âõ¢ÈòüÂçè‰ΩúÊó∂Êõ¥ÂÖ≥Ê≥®Ôºö",
                options: ["A. ËßíËâ≤Ê∏ÖÊô∞„ÄÅËøõÂ∫¶‰∏é‰∫ßÂá∫", "B. ÂøÉÁêÜÂÆâÂÖ®„ÄÅÂÖ≥Á≥ª‰∏éÂä®Âäõ"],
                dimension: "EI",
                category: "leadership_style",
                weight: 2.0,
                explanation: "Â§ñÂêë/ÂÜÖÂêëÂú®Âõ¢ÈòüÁõÆÊ†á‰∏≠ÁöÑ‰æßÈáç",
                source: "Á±ªÂûã‰∏éÊ≤üÈÄö",
                facet: "Âõ¢ÈòüÂÖ≥Ê≥®ÁÇπ"
            },

            // ===== ÊñáÁåÆÂª∫Ê®°Êâ©Â±ïÔºöÁªºÂêàÈ™åËØÅÔºà‰∫Ü‰∏çËµ∑ÁöÑ16Âûã‰∫∫Ê†º/Â≠¶ÊúØËÆ∫ÊñáÔºâ =====
            {
                id: 37,
                level: 5,
                question: "ÈÅáÂà∞‰ª∑ÂÄºÂÜ≤Á™ÅÊó∂‰Ω†Êõ¥ÂèØËÉΩÔºö",
                options: ["A. ÂùöÊåÅÂéüÂàôÂπ∂‰ºòÂåñËßÑÂàôÔºàT/NTÊ∞îË¥®Ôºâ", "B. ÂçèË∞ÉÂÖ≥Á≥ªÂπ∂ÂØªÊ±ÇÂÖ±ËØÜÔºàF/NFÊ∞îË¥®Ôºâ"],
                dimension: "TF",
                category: "life_philosophy",
                weight: 2.5,
                explanation: "‰ª∑ÂÄºÁ≥ªÁªüÂèñÂêëÔºà„Ää‰∫Ü‰∏çËµ∑ÁöÑ16Âûã‰∫∫Ê†º„Äã„ÄäÂ≠¶ÊúØËÆ∫ÊñáÁªºËø∞„ÄãÔºâ",
                source: "Â≠¶ÊúØËÆ∫Êñá/16Âûã‰∫∫Ê†º",
                facet: "‰ª∑ÂÄºÂèñÂêë"
            },
            {
                id: 38,
                level: 5,
                question: "ÈïøÊúüÂ≠¶‰π†Á≠ñÁï•‰Ω†Êõ¥Ôºö",
                options: ["A. ‰ª•ÁõÆÊ†á‰∏∫ÂØºÂêëÔºåÈò∂ÊÆµÊÄßÂ§çÁõò‰∏éÂõ∫Âåñ", "B. ‰ª•ÂÖ¥Ë∂£‰∏∫È©±Âä®ÔºåÂπøÂ∫¶Êé¢Á¥¢‰∏éËÅîÁªì"],
                dimension: "JP",
                category: "personal_growth",
                weight: 2.5,
                explanation: "J/PÂú®ÂÖÉÂ≠¶‰π†‰∏≠ÁöÑÂ∑ÆÂºÇÔºàÊñáÁåÆÁªºÂêàÔºâ",
                source: "Â≠¶ÊúØËÆ∫Êñá",
                facet: "ÂÖÉÂ≠¶‰π†"
            },
            {
                id: 39,
                level: 5,
                question: "Â§çÊùÇÈóÆÈ¢òÊ±ÇËß£‰Ω†Êõ¥Ôºö",
                options: ["A. Ëá™Â∫ïÂêë‰∏äÊ±áÊÄªËØÅÊçÆÔºàS/TÔºâ", "B. Ëá™È°∂Âêë‰∏ãËÆæÂÆöÂÅáËØ¥ÔºàN/TÊàñN/FÔºâ"],
                dimension: "SN",
                category: "problem_solving",
                weight: 2.5,
                explanation: "S/NÂú®Êé®ÁêÜË∑ØÂæÑ‰∏äÁöÑÂ∑ÆÂºÇÔºàÂ≠¶ÊúØÁªºËø∞Ôºâ",
                source: "Â≠¶ÊúØËÆ∫Êñá",
                facet: "Êé®ÁêÜË∑ØÂæÑ"
            },
            {
                id: 40,
                level: 5,
                question: "‰∫∫ÈôÖÂÜ≥Á≠ñ‰Ω†Êõ¥Ôºö",
                options: ["A. ‰æùÊçÆËßíËâ≤/ËßÑÂàô‰øùÊåÅ‰∏ÄËá¥ÊÄßÔºàT/JÔºâ", "B. ‰æùÊçÆÊÉÖÂ¢É/‰∫∫ÂøÉÁÅµÊ¥ªË∞ÉÊï¥ÔºàF/PÔºâ"],
                dimension: "TF",
                category: "relationship_values",
                weight: 2.5,
                explanation: "T/F‰∏éJ/PÁöÑ‰∫§‰∫íÔºàÊñáÁåÆÁªºÂêàÔºâ",
                source: "Á±ªÂûã‰∏é‰∫≤ÂØÜÂÖ≥Á≥ª/Â≠¶ÊúØËÆ∫Êñá",
                facet: "‰∫∫ÈôÖÂÜ≥Á≠ñ"
            }
        ];

        // ÊÄßÊ†ºÁ±ªÂûãÊèèËø∞
        const typeDescriptions = {
            "INTJ": "Âª∫Á≠ëÂ∏à - ÂØåÊúâÊÉ≥Ë±°ÂäõÂíåÊàòÁï•ÊÄßÁöÑÊÄùËÄÉËÄÖÔºå‰∏ÄÂàáÈÉΩË¶ÅÁªèËøáÊ∑±ÊÄùÁÜüËôë„ÄÇ",
            "INTP": "ÈÄªËæëÂ≠¶ÂÆ∂ - ÂàõÊñ∞ÁöÑÂèëÊòéÂÆ∂ÔºåÂØπÁü•ËØÜÊúâÁùÄ‰∏çÂèØÊäëÂà∂ÁöÑÊ∏¥Êúõ„ÄÇ",
            "ENTJ": "ÊåáÊå•ÂÆò - Â§ßËÉÜ„ÄÅÂØåÊúâÊÉ≥Ë±°ÂäõÁöÑÂº∫È¢ÜÂØºËÄÖÔºåÊÄªÊòØËÉΩÊâæÂà∞ÊàñÂàõÈÄ†Ëß£ÂÜ≥ÊñπÊ°à„ÄÇ",
            "ENTP": "Ëæ©ËÆ∫ÂÆ∂ - ËÅ™ÊòéÂ•ΩÂ•áÁöÑÊÄùÊÉ≥ÂÆ∂Ôºå‰∏ç‰ºöÊîæËøá‰ªª‰ΩïÊô∫ÂäõÊåëÊàò„ÄÇ",
            "INFJ": "ÊèêÂÄ°ËÄÖ - ÂÆâÈùôËÄåÁ•ûÁßòÔºåÂêåÊó∂ÈºìËàû‰∫∫ÂøÉ‰∏î‰∏çÁü•Áñ≤ÂÄ¶ÁöÑÁêÜÊÉ≥‰∏ª‰πâËÄÖ„ÄÇ",
            "INFP": "Ë∞ÉÂÅúËÄÖ - ËØóÊÑè„ÄÅÂñÑËâØÁöÑÂà©‰ªñ‰∏ª‰πâËÄÖÔºåÊÄªÊòØÁÉ≠ÊÉÖÂú∞‰∏∫Ê≠£ÂΩìÁêÜÁî±ËÄåÊàò„ÄÇ",
            "ENFJ": "‰∏ª‰∫∫ÂÖ¨ - ÂØåÊúâÈ≠ÖÂäõÂíåÈºìËàû‰∫∫ÂøÉÁöÑÈ¢ÜÂØºËÄÖÔºåÊúâÁùÄ‰∏éÁîü‰ø±Êù•ÁöÑÈ¢ÜÂØºËÉΩÂäõ„ÄÇ",
            "ENFP": "Á´ûÈÄâËÄÖ - ÁÉ≠ÊÉÖ„ÄÅÊúâÂàõÈÄ†Âäõ„ÄÅÁ§æ‰∫§ËÉΩÂäõÂº∫ÁöÑ‰∫∫ÔºåËÉΩÂ§üÊâæÂà∞‰∏é‰ªñ‰∫∫ËÅîÁ≥ªÁöÑÂèØËÉΩÊÄß„ÄÇ",
            "ISTJ": "Áâ©ÊµÅÂ∏à - ÂÆûÈôÖ‰∏îÊ≥®Èáç‰∫ãÂÆûÁöÑÂèØÈù†‰∏™‰ΩìÔºåÂÖ∂ÂèØÈù†ÊÄß‰∏çÂÆπÁΩÆÁñë„ÄÇ",
            "ISFJ": "ÂÆàÂç´ËÄÖ - ÈùûÂ∏∏‰∏ìÊ≥®ÂíåÊ∏©ÊöñÁöÑÂÆàÊä§ËÄÖÔºåÊó∂ÂàªÂáÜÂ§á‰øùÊä§ÊâÄÁà±‰πã‰∫∫„ÄÇ",
            "ESTJ": "ÊÄªÁªèÁêÜ - Âá∫Ëâ≤ÁöÑÁÆ°ÁêÜËÄÖÔºåÂú®ÁÆ°ÁêÜ‰∫ãÊÉÖÊàñ‰∫∫ÂëòÊñπÈù¢Êó†‰∏é‰º¶ÊØî„ÄÇ",
            "ESFJ": "ÊâßÊîøÂÆò - ÊûÅÂÖ∂ÂÖ≥ÂøÉ‰ªñ‰∫∫ÁöÑÊÑüÂèóÔºå‰ª•ÁÉ≠ÊÉÖÂíåÂèãÂñÑËëóÁß∞„ÄÇ",
            "ISTP": "Èâ¥ËµèÂÆ∂ - Â§ßËÉÜËÄåÂÆûÁî®ÁöÑÂÆûÈ™åÂÆ∂ÔºåÊìÖÈïø‰ΩøÁî®ÂêÑÁßçÂ∑•ÂÖ∑„ÄÇ",
            "ISFP": "Êé¢Èô©ÂÆ∂ - ÁÅµÊ¥ª‰∏îÊúâÈ≠ÖÂäõÁöÑËâ∫ÊúØÂÆ∂ÔºåÈöèÊó∂ÂáÜÂ§áÊé¢Á¥¢Âíå‰ΩìÈ™åÊñ∞‰∫ãÁâ©„ÄÇ",
            "ESTP": "‰ºÅ‰∏öÂÆ∂ - ËÅ™Êòé„ÄÅÁ≤æÂäõÂÖÖÊ≤õ‰∏îÈùûÂ∏∏ÂñÑ‰∫éÊÑüÁü•ÁöÑ‰∫∫ÔºåÁúüÊ≠£‰∫´ÂèóÁîüÊ¥ªÁöÑÂà∫ÊøÄ„ÄÇ",
            "ESFP": "Ë°®ÊºîËÄÖ - Ëá™ÂèëÁöÑ„ÄÅÁ≤æÂäõÂÖÖÊ≤õ‰∏îÁÉ≠ÊÉÖÁöÑË°®ÊºîËÄÖÔºå‰ªñ‰ª¨ÁöÑÁîüÊ¥ªÊ∞∏Ëøú‰∏ç‰ºöÊó†ËÅä„ÄÇ"
        };

        let currentQuestion = 0;
        let answers = [];
        let scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
        let currentUser = JSON.parse(localStorage.getItem('mbti_user') || 'null');
        let questionSequence = []; // Âä®ÊÄÅÈóÆÈ¢òÂ∫èÂàó
        let dimensionProgress = { EI: 0, SN: 0, TF: 0, JP: 0 }; // ÂêÑÁª¥Â∫¶ËøõÂ∫¶
        let testLevel = 1; // ÂΩìÂâçÊµãËØïÂ±ÇÁ∫ß

        // Google AdSense ÈÖçÁΩÆÂ∑≤Âà†Èô§
        // È°µÈù¢Áä∂ÊÄÅÁÆ°ÁêÜ
        const PAGE_STATES = {
            HOME: 'home',
            TEST: 'test',
            AD: 'ad',
            RESULT: 'result',
            LOGIN: 'login',
            REGISTER: 'register',
            FORGOT_PASSWORD: 'forgot-password',
            MBTI_INFO: 'mbti-info'
        };

        let currentPage = PAGE_STATES.HOME;
        let pageHistory = [];

        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
        window.onload = function() {
            initializeNavigation();
            checkLoginStatus();
            
            // Ê∑ªÂä†ÊúçÂä°Êù°Ê¨æÊåâÈíÆÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
            addTermsButtonListeners();
        };

        // Ê∑ªÂä†ÊúçÂä°Êù°Ê¨æÊåâÈíÆÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function addTermsButtonListeners() {
            // Á≠âÂæÖDOMÂä†ËΩΩÂÆåÊàê
            setTimeout(() => {
                const agreeButton = document.getElementById('agreeTermsBtn');
                if (agreeButton) {
                    console.log('ÊâæÂà∞ÂêåÊÑèÊåâÈíÆÔºåÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®');
                    
                    // Ê∑ªÂä†Êñ∞ÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
                    agreeButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('ÂêåÊÑèÊåâÈíÆË¢´ÁÇπÂáª');
                        
                        // Ë∞ÉÁî®acknowledgeTermsÂáΩÊï∞
                        acknowledgeTerms();
                    });
                    
                    console.log('‰∫ã‰ª∂ÁõëÂê¨Âô®Â∑≤Ê∑ªÂä†');
                } else {
                    console.log('Êú™ÊâæÂà∞ÂêåÊÑèÊåâÈíÆ');
                }
            }, 1000);
        }

        // ÂàùÂßãÂåñÂØºËà™Á≥ªÁªü
        function initializeNavigation() {
            // ËÆæÁΩÆÂàùÂßãÈ°µÈù¢‰∏∫ÂäüËÉΩÂç°ÁâáÂå∫Âüü
            showFeaturesSection();
            
            // ÁõëÂê¨ÊµèËßàÂô®ÂêéÈÄÄÊåâÈíÆ
            window.addEventListener('popstate', function(event) {
                if (event.state && event.state.page) {
                    navigateToPage(event.state.page, false);
                }
            });
        }

        // ÂØºËà™Âà∞ÊåáÂÆöÈ°µÈù¢
        function navigateToPage(page, addToHistory = true) {
            console.log(`ÂØºËà™Âà∞È°µÈù¢: ${page}`);
            
            // ‰øùÂ≠òÂΩìÂâçÈ°µÈù¢Âà∞ÂéÜÂè≤ËÆ∞ÂΩï
            if (addToHistory && currentPage !== page) {
                pageHistory.push(currentPage);
                // Êõ¥Êñ∞ÊµèËßàÂô®ÂéÜÂè≤
                window.history.pushState({ page: page }, '', `#${page}`);
            }
            
            // Êõ¥Êñ∞ÂΩìÂâçÈ°µÈù¢Áä∂ÊÄÅ
            currentPage = page;
            
            // ÈöêËóèÊâÄÊúâÈ°µÈù¢
            hideAllPages();
            
            // ÊòæÁ§∫ÁõÆÊ†áÈ°µÈù¢
            showPage(page);
            
            console.log(`È°µÈù¢ÂàáÊç¢ÂÆåÊàê: ${page}`);
            // Ensure i18n after navigation
            if (window.i18n && typeof i18n.apply === 'function') {
                if (typeof i18n.setLanguage === 'function') i18n.setLanguage('en');
                i18n.apply();
            }
        }

        // ÈöêËóèÊâÄÊúâÈ°µÈù¢
        function hideAllPages() {
            const pages = [
                'testSection', 'adSection', 'resultSection',
                'loginSection', 'registerSection', 'forgotPasswordSection',
                'mbtiInfoSection'
            ];
            
            pages.forEach(pageId => {
                const element = document.getElementById(pageId);
                if (element) {
                    element.classList.add('hidden');
                    element.style.display = 'none';
                }
            });
        }

        // ÊòæÁ§∫ÊåáÂÆöÈ°µÈù¢
        function showPage(page) {
            let targetElement = null;
            
            switch (page) {
                case PAGE_STATES.HOME:
                    // È¶ñÈ°µÁé∞Âú®Áõ¥Êé•ÊòæÁ§∫ÂäüËÉΩÂç°ÁâáÂå∫Âüü
                    targetElement = document.getElementById('featuresSection');
                    break;
                case PAGE_STATES.TEST:
                    targetElement = document.getElementById('testSection');
                    break;
                case PAGE_STATES.AD:
                    targetElement = document.getElementById('adSection');
                    break;
                case PAGE_STATES.RESULT:
                    targetElement = document.getElementById('resultSection');
                    break;
                case PAGE_STATES.LOGIN:
                    targetElement = document.getElementById('loginSection');
                    break;
                case PAGE_STATES.REGISTER:
                    targetElement = document.getElementById('registerSection');
                    break;
                case PAGE_STATES.FORGOT_PASSWORD:
                    targetElement = document.getElementById('forgotPasswordSection');
                    break;
                case PAGE_STATES.MBTI_INFO:
                    targetElement = document.getElementById('mbtiInfoSection');
                    break;
            }
            
            if (targetElement) {
                targetElement.classList.remove('hidden');
                targetElement.style.display = 'block';
                console.log(`ÊòæÁ§∫È°µÈù¢: ${page}`);
                // Apply i18n for newly shown content
                if (window.i18n && typeof i18n.apply === 'function') {
                    if (typeof i18n.setLanguage === 'function') i18n.setLanguage('en');
                    i18n.apply();
                }
                
                // Â¶ÇÊûúÊòØÂπøÂëäÈ°µÈù¢ÔºåÂàùÂßãÂåñÂπøÂëä
                if (page === PAGE_STATES.AD) {
                    setTimeout(() => {
                        initAdPage();
                    }, 100);
                }
            } else {
                console.error(`Êâæ‰∏çÂà∞È°µÈù¢ÂÖÉÁ¥†: ${page}`);
            }
        }

        // ËøîÂõû‰∏ä‰∏ÄÈ°µ
        function goBack() {
            if (pageHistory.length > 0) {
                const previousPage = pageHistory.pop();
                navigateToPage(previousPage, false);
            } else {
                navigateToPage(PAGE_STATES.HOME, false);
            }
        }

        // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('mbti_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showLoggedInState();
            } else {
                showGuestState();
            }
        }

        // ÊòæÁ§∫Â∑≤ÁôªÂΩïÁä∂ÊÄÅ
        function showLoggedInState() {
            document.getElementById('userInfoSection').classList.add('hidden');
            document.getElementById('loggedInSection').classList.remove('hidden');
            
            // Êõ¥Êñ∞Áî®Êà∑ÊòæÁ§∫ÂêçÁß∞
            if (currentUser) {
                document.getElementById('userDisplayName').textContent = `Welcome back, ${currentUser.username}!`;
            }
        }

        // ÊòæÁ§∫ËÆøÂÆ¢Áä∂ÊÄÅ
        function showGuestState() {
            document.getElementById('loggedInSection').classList.add('hidden');
            document.getElementById('userInfoSection').classList.remove('hidden');
        }

        // ÊòæÁ§∫ÁôªÂΩïÈ°µÈù¢
        function showLoginPage() {
            navigateToPage(PAGE_STATES.LOGIN);
        }

        // ÊòæÁ§∫‰∏ªÂÜÖÂÆπ
        function showMainContent() {
            navigateToPage(PAGE_STATES.HOME);
            // Êõ¥Êñ∞ÁôªÂΩïÁä∂ÊÄÅ
            showLoggedInState();
        }

        // ÊòæÁ§∫Ê≥®ÂÜåÈ°µÈù¢
        function showRegister() {
            try {
                navigateToPage(PAGE_STATES.REGISTER);
                const el = document.getElementById('registerSection');
                if (el) { el.classList.remove('hidden'); el.style.display = 'flex'; }
                const features = document.getElementById('featuresSection');
                const header = document.getElementById('mainHeader');
                if (features) features.classList.add('hidden');
                if (header) header.classList.add('hidden');
            } catch (e) { console.error('showRegister error', e); }
        }

        // ÊòæÁ§∫ÁôªÂΩïÈ°µÈù¢
        function showLogin() {
            try {
                navigateToPage(PAGE_STATES.LOGIN);
                const el = document.getElementById('loginSection');
                if (el) { el.classList.remove('hidden'); el.style.display = 'flex'; el.style.visibility = 'visible'; }
                const features = document.getElementById('featuresSection');
                const header = document.getElementById('mainHeader');
                if (features) features.classList.add('hidden');
                if (header) header.classList.add('hidden');
                // ÈîÅÂÆöÊªöÂä®Âπ∂ËÅöÁÑ¶Áî®Êà∑Âêç
                document.body.style.overflow = 'hidden';
                const userInput = document.getElementById('username');
                if (userInput) setTimeout(() => userInput.focus(), 50);
                if (typeof showToast === 'function') showToast('ËØ∑ÁôªÂΩï‰ª•ÁªßÁª≠', 'info');
                // Force EN
                if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
            } catch (e) {
                console.error('showLogin error', e);
                const el = document.getElementById('loginSection');
                if (el) { el.classList.remove('hidden'); el.style.display = 'flex'; }
            }
        }

        // Â§ÑÁêÜÁôªÂΩïË°®ÂçïÊèê‰∫§
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // ÁÆÄÂçïÁöÑÁôªÂΩïÈ™åËØÅÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•ËøûÊé•ÂêéÁ´ØAPIÔºâ
                if (username && password) {
                    currentUser = { username: username, email: username + '@example.com' };
                    localStorage.setItem('mbti_user', JSON.stringify(currentUser));
                    // ÂèçÈ¶à‰∏éÊ∏ÖÁêÜ
                    if (typeof showToast === 'function') showToast('ÁôªÂΩïÊàêÂäü', 'success');
                    // ÂÖ≥Èó≠ÁôªÂΩïÊµÆÂ±Ç
                    const el = document.getElementById('loginSection');
                    if (el) { el.classList.add('hidden'); el.style.display = 'none'; }
                    document.body.style.overflow = '';
                    // ËøîÂõûÈ¶ñÈ°µÂπ∂Â±ïÁ§∫Â∑≤ÁôªÂΩïÁä∂ÊÄÅ
                    showMainContent();
                } else {
                    if (typeof showToast === 'function') showToast('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å', 'error');
                    else alert('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å');
                }
            });
        }

        // Â§ÑÁêÜÊ≥®ÂÜåË°®ÂçïÊèê‰∫§
        const registerForm = document.getElementById('registerForm');
        if (registerForm) {
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('regUsername').value;
                const email = document.getElementById('regEmail').value;
                const password = document.getElementById('regPassword').value;
                const confirmPassword = document.getElementById('regConfirmPassword').value;
                const agreeTerms = document.getElementById('agreeTerms').checked;
                
                if (!agreeTerms) {
                    alert('ËØ∑ÂêåÊÑèÊúçÂä°Êù°Ê¨æÂíåÈöêÁßÅÊîøÁ≠ñ');
                    return;
                }
                
                if (password !== confirmPassword) {
                    alert('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥');
                    return;
                }
                
                if (username && email && password) {
                    currentUser = { username: username, email: email };
                    localStorage.setItem('mbti_user', JSON.stringify(currentUser));
                    showMainContent();
                } else {
                    alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ');
                }
            });
        }

        // Áî®Êà∑Ë¥¶Êà∑ÁÆ°ÁêÜÁ≥ªÁªü
        var userAccounts = JSON.parse(localStorage.getItem('mbti_user_accounts') || '{}');
        var authMethod = localStorage.getItem('mbti_auth_method') || 'local';

        // Google OAuth Client ID Â∑≤Âà†Èô§

        // Google Áõ∏ÂÖ≥ÂèòÈáèÂ∑≤Âà†Èô§

                // loadGoogleIdentityScript ÂáΩÊï∞Â∑≤Âà†Èô§

        // ensureGoogleIdInitialized ÂáΩÊï∞Â∑≤Âà†Èô§

                // handleGoogleCredentialResponse ÂáΩÊï∞Â∑≤Âà†Èô§

        function decodeJwtPayload(jwt) {
            var parts = jwt.split('.');
            if (parts.length < 2) return null;
            var base64 = parts[1].replace(/-/g, '+').replace(/_/g, '/');
            try {
                var json = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                return JSON.parse(json);
            } catch (e) {
                return null;
            }
        }

        // Âú®ÂèØÁî®Êó∂Ê∏≤ÊüìÂÆòÊñπÊåâÈíÆÔºàOne Tap Ëá™ÁªòÊåâÈíÆÔºâÔºå‰∏çÂèØÁî®Âàô‰∏çÂΩ±ÂìçÂéüÊúâÊµÅÁ®ã
        function renderGoogleButtonsIfPossible() {
            if (!(window.google && window.google.accounts && window.google.accounts.id)) return;
            ensureGoogleIdInitialized();

            var targets = [];
            // 1) ‰ºòÂÖà‰ΩøÁî®È°µÈù¢‰∏≠ÊòæÂºèÂç†‰ΩçÂÆπÂô®
            var explicit = document.querySelectorAll('#googleButtonContainer, .google-button-container');
            explicit.forEach(function(node) { targets.push(node); });

            // 2) Â¶ÇÊûúÊ≤°ÊúâÂç†‰ΩçÂÆπÂô®ÔºåÂàôÂú®Áé∞Êúâ .google-btn ÊóÅËæπÊèíÂÖ•‰∏Ä‰∏™ÂÆπÂô®Âπ∂ÈöêËóèÂéüÊåâÈíÆ
            if (targets.length === 0) {
                var legacyBtns = document.querySelectorAll('.google-btn');
                legacyBtns.forEach(function(btn) {
                    var holder = document.createElement('div');
                    holder.className = 'google-button-container';
                    holder.style.marginTop = '8px';
                    btn.insertAdjacentElement('afterend', holder);
                    // ÈöêËóèÊóßÁöÑÊú¨Âú∞ÊåâÈíÆÔºåÈÅøÂÖçÈáçÂ§ç
                    btn.style.display = 'none';
                    targets.push(holder);
                });
            }

            targets.forEach(function(container) {
                try {
                    window.google.accounts.id.renderButton(container, {
                        type: 'standard',
                        theme: 'outline',
                        size: 'large',
                        text: 'signin_with',
                        shape: 'rectangular',
                        logo_alignment: 'left'
                    });
                } catch (e) {
                    // ÂøΩÁï•Ê∏≤ÊüìÈîôËØØÔºå‰øùÁïôÂéüÊúâÈôçÁ∫ßÈÄªËæë
                }
            });
        }

        // googleLogin ÂáΩÊï∞Â∑≤Âà†Èô§

        // Áî®Êà∑Ë¥¶Êà∑ÁÆ°ÁêÜÂáΩÊï∞
        function saveUserAccount(user) {
            if (user && user.email) {
                userAccounts[user.email] = {
                    ...user,
                    lastLogin: new Date().toISOString(),
                    loginCount: (userAccounts[user.email]?.loginCount || 0) + 1
                };
                localStorage.setItem('mbti_user_accounts', JSON.stringify(userAccounts));
            }
        }

        function getUserAccount(email) {
            return userAccounts[email] || null;
        }

        function updateUserProfile(email, updates) {
            if (userAccounts[email]) {
                userAccounts[email] = { ...userAccounts[email], ...updates };
                localStorage.setItem('mbti_user_accounts', JSON.stringify(userAccounts));
            }
        }

        function logout() {
            currentUser = null;
            authMethod = 'local';
            localStorage.removeItem('mbti_user');
            localStorage.setItem('mbti_auth_method', 'local');
            showLoginContent();
            
            // ÊòæÁ§∫ÈÄÄÂá∫ÊàêÂäüÊèêÁ§∫
            if (typeof showToast === 'function') {
                showToast('Â∑≤ÈÄÄÂá∫ÁôªÂΩï', 'success');
            }
        }

        // Firebase Auth ÈõÜÊàêÔºà‰Ωú‰∏∫ Google Identity Services ÁöÑÊõø‰ª£ÊñπÊ°àÔºâ
        function loadFirebaseAuth() {
            return new Promise((resolve, reject) => {
                if (window.firebase && window.firebase.auth) {
                    firebaseAuthLoaded = true;
                    resolve();
                    return;
                }

                // Âä†ËΩΩ Firebase SDK
                const script = document.createElement('script');
                script.src = 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js';
                script.onload = () => {
                    const authScript = document.createElement('script');
                    authScript.src = 'https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js';
                    authScript.onload = () => {
                        firebaseAuthLoaded = true;
                        resolve();
                    };
                    authScript.onerror = reject;
                    document.head.appendChild(authScript);
                };
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        function firebaseGoogleSignIn() {
            if (!firebaseAuthLoaded) {
                loadFirebaseAuth().then(() => firebaseGoogleSignIn());
                return;
            }

            const provider = new window.firebase.auth.GoogleAuthProvider();
            window.firebase.auth().signInWithPopup(provider)
                .then((result) => {
                    const user = result.user;
                    const userInfo = {
                        username: user.displayName || user.email.split('@')[0],
                        email: user.email,
                        loginMethod: 'Firebase-Google',
                        uid: user.uid
                    };
                    
                    currentUser = userInfo;
                    authMethod = 'firebase';
                    saveUserAccount(userInfo);
                    localStorage.setItem('mbti_user', JSON.stringify(userInfo));
                    localStorage.setItem('mbti_auth_method', 'firebase');
                    showMainContent();
                })
                .catch((error) => {
                    if (typeof showToast === 'function') {
                        showToast('Firebase ÁôªÂΩïÂ§±Ë¥•: ' + error.message, 'error');
                    }
                });
        }

        // È°µÈù¢Âä†ËΩΩÂêéÂ∞ùËØïÈ¢ÑÂä†ËΩΩÂπ∂Ê∏≤ÊüìÊåâÈíÆÔºåÂπ∂ÂÅö‰∏ÄÊ¨° One Tap ÊèêÁ§∫ÔºàÈùû‰æµÂÖ•Ôºå‰∏îÂêå‰ºöËØùÂè™ÊèêÁ§∫‰∏ÄÊ¨°Ôºâ
        document.addEventListener('DOMContentLoaded', function() {
            // Ê£ÄÊü•ÊòØÂê¶ÊúâÂ∑≤ÁôªÂΩïÁî®Êà∑
            if (currentUser) {
                showMainContent();
            }

            loadGoogleIdentityScript(3000)
                .then(function() {
                    renderGoogleButtonsIfPossible();
                    try {
                        var suppressed = sessionStorage.getItem('google_onetap_suppressed') === '1';
                        if (!suppressed && window.google && window.google.accounts && window.google.accounts.id) {
                            ensureGoogleIdInitialized();
                            window.google.accounts.id.prompt(function(notification) {
                                // Ëã•Áî®Êà∑ÂÖ≥Èó≠Êàñ‰∏çÊîØÊåÅÔºå‰∏çÂÜçÁªßÁª≠ÊèêÁ§∫Êú¨‰ºöËØù
                                if (notification && notification.isNotDisplayed()) {
                                    sessionStorage.setItem('google_onetap_suppressed', '1');
                                }
                                if (notification && notification.isSkippedMoment()) {
                                    sessionStorage.setItem('google_onetap_suppressed', '1');
                                }
                                if (notification && notification.isDismissedMoment()) {
                                    sessionStorage.setItem('google_onetap_suppressed', '1');
                                }
                            });
                        }
                    } catch (e) {
                        // ÈùôÈªòÂ§±Ë¥•
                    }
                })
                .catch(function() {
                    // ‰øùÊåÅÈùôÈªòÔºåËµ∞Áé∞ÊúâÈÇÆÁÆ±/ÊâãÊú∫Âè∑/Êú¨Âú∞Ê®°Êãü
                });
        });

        // showGoogleLoginModal ÂáΩÊï∞Â∑≤Âà†Èô§

                // Google ÁôªÂΩïÁõ∏ÂÖ≥ÂáΩÊï∞Â∑≤Âà†Èô§

        // ÊòæÁ§∫GoogleÊ≥®ÂÜåÂºπÁ™ó
        function showGoogleRegisterModal() {
            const modal = document.createElement('div');
            modal.className = 'google-modal';
            modal.innerHTML = `
                <div class="google-modal-content">
                    <div class="google-modal-header">
                        <h3>üîê GoogleË¥¶Âè∑Ê≥®ÂÜå</h3>
                        <button class="close-btn" onclick="closeGoogleModal()">&times;</button>
                    </div>
                    <div class="google-modal-body">
                        <div class="google-register-options">
                            <div class="google-register-item">
                                <div class="google-register-icon">üìß</div>
                                <div class="google-register-info">
                                    <h4>ÂàõÂª∫Êñ∞ÁöÑGoogleË¥¶Âè∑</h4>
                                    <p>Ê≥®ÂÜåÊñ∞ÁöÑGmailÈÇÆÁÆ±ÂíåGoogleË¥¶Âè∑</p>
                                </div>
                                <button class="btn btn-primary" onclick="openGoogleRegister()">
                                    ÂâçÂæÄÊ≥®ÂÜå
                                </button>
                            </div>
                            
                            <div class="google-register-item">
                                <div class="google-register-icon">üîë</div>
                                <div class="google-register-info">
                                    <h4>Â∑≤ÊúâGoogleË¥¶Âè∑</h4>
                                    <p>‰ΩøÁî®Áé∞ÊúâÁöÑGmailÈÇÆÁÆ±ÁôªÂΩï</p>
                                </div>
                                <button class="btn btn-secondary" onclick="showGoogleLoginModal()">
                                    ËøîÂõûÁôªÂΩï
                                </button>
                            </div>
                            
                            <div class="google-register-item">
                                <div class="google-register-icon">üì±</div>
                                <div class="google-register-info">
                                    <h4>ÊâãÊú∫Âè∑Ê≥®ÂÜå</h4>
                                    <p>‰ΩøÁî®ÊâãÊú∫Âè∑ÂàõÂª∫GoogleË¥¶Âè∑</p>
                                </div>
                                <button class="btn btn-secondary" onclick="phoneRegister()">
                                    ÊâãÊú∫Ê≥®ÂÜå
                                </button>
                            </div>
                        </div>
                        
                        <div class="google-help">
                            <p>üí° ÊèêÁ§∫ÔºöÊ≥®ÂÜåÂÆåÊàêÂêéÔºåËØ∑‰ΩøÁî®Êñ∞Ë¥¶Âè∑ÁôªÂΩï</p>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // ÊâìÂºÄGoogleÊ≥®ÂÜåÈ°µÈù¢
        function openGoogleRegister() {
            // Âú®Êñ∞Á™óÂè£ÊâìÂºÄGoogleÊ≥®ÂÜåÈ°µÈù¢
            const googleRegisterUrl = 'https://accounts.google.com/signup';
            window.open(googleRegisterUrl, '_blank', 'width=800,height=600');
            
            // ÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ
            alert('Â∑≤ÊâìÂºÄGoogleÊ≥®ÂÜåÈ°µÈù¢ÔºåËØ∑Âú®Êñ∞Á™óÂè£‰∏≠ÂÆåÊàêÊ≥®ÂÜå„ÄÇÊ≥®ÂÜåÂÆåÊàêÂêéÔºåËØ∑ËøîÂõûÊ≠§È°µÈù¢‰ΩøÁî®Êñ∞Ë¥¶Âè∑ÁôªÂΩï„ÄÇ');
            
            // ÂÖ≥Èó≠ÂΩìÂâçÂºπÁ™ó
            closeGoogleModal();
        }

        // ÊâãÊú∫Âè∑Ê≥®ÂÜå
        function phoneRegister() {
            // ÊòæÁ§∫ÊâãÊú∫Âè∑Ê≥®ÂÜåÂºπÁ™ó
            showPhoneRegisterModal();
        }

        // ÊòæÁ§∫ÊâãÊú∫Âè∑Ê≥®ÂÜåÂºπÁ™ó
        function showPhoneRegisterModal() {
            const modal = document.createElement('div');
            modal.className = 'phone-register-modal';
            modal.innerHTML = `
                <div class="phone-register-content">
                    <div class="phone-register-header">
                        <h3>üì± ÊâãÊú∫Âè∑Ê≥®ÂÜå</h3>
                        <button class="close-btn" onclick="closePhoneRegisterModal()">&times;</button>
                    </div>
                    <div class="phone-register-body">
                        <!-- Á¨¨‰∏ÄÊ≠•ÔºöÊâãÊú∫Âè∑ËæìÂÖ• -->
                        <div id="phoneStep1">
                            <div class="form-group">
                                <label for="phoneNumber">ÊâãÊú∫Âè∑Á†Å</label>
                                <input type="tel" id="phoneNumber" placeholder="ËØ∑ËæìÂÖ•11‰ΩçÊâãÊú∫Âè∑Á†Å" maxlength="11" required>
                            </div>
                            <div class="form-group">
                                <label for="userName">ÂßìÂêç</label>
                                <input type="text" id="userName" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂßìÂêç" required>
                            </div>
                            <button class="btn" onclick="sendPhoneVerification()">ÂèëÈÄÅÈ™åËØÅÁ†Å</button>
                        </div>
                        
                        <!-- Á¨¨‰∫åÊ≠•ÔºöÈ™åËØÅÁ†ÅÈ™åËØÅ -->
                        <div id="phoneStep2" style="display: none;">
                            <div class="verification-info">
                                <p>È™åËØÅÁ†ÅÂ∑≤ÂèëÈÄÅËá≥ <span id="displayPhone"></span></p>
                                <p class="countdown-text">ÂÄíËÆ°Êó∂Ôºö<span id="phoneCountdown">60</span>Áßí</p>
                            </div>
                            <div class="form-group">
                                <label for="phoneVerificationCode">È™åËØÅÁ†Å</label>
                                <div class="verification-input-group">
                                    <input type="text" id="phoneVerificationCode" placeholder="ËØ∑ËæìÂÖ•6‰ΩçÈ™åËØÅÁ†Å" maxlength="6" required>
                                    <button type="button" class="btn btn-secondary" id="resendCodeBtn" onclick="resendPhoneCode()" disabled>ÈáçÊñ∞ÂèëÈÄÅ</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="phonePassword">ËÆæÁΩÆÂØÜÁ†Å</label>
                                <input type="password" id="phonePassword" placeholder="ËØ∑ËÆæÁΩÆÁôªÂΩïÂØÜÁ†ÅÔºàËá≥Â∞ë8‰ΩçÔºâ" required>
                                <div class="password-strength" id="phonePasswordStrength"></div>
                            </div>
                            <div class="form-group">
                                <label for="phoneConfirmPassword">Á°ÆËÆ§ÂØÜÁ†Å</label>
                                <input type="password" id="phoneConfirmPassword" placeholder="ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å" required>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="agreePhoneTerms" required>
                                    <span class="checkmark"></span>
                                    ÊàëÂêåÊÑè <a href="#" onclick="showTermsOfService()">ÊúçÂä°Êù°Ê¨æ</a> Âíå <a href="#" onclick="showPrivacyPolicy()">ÈöêÁßÅÊîøÁ≠ñ</a>
                                </label>
                            </div>
                            <div class="phone-actions">
                                <button class="btn btn-secondary" onclick="backToPhoneStep1()">ËøîÂõû‰∏ä‰∏ÄÊ≠•</button>
                                <button class="btn" onclick="verifyPhoneAndRegister()">ÂÆåÊàêÊ≥®ÂÜå</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ÂºπÁ™ó
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // ÂÖ≥Èó≠ÊâãÊú∫Âè∑Ê≥®ÂÜåÂºπÁ™ó
        function closePhoneRegisterModal() {
            const modal = document.querySelector('.phone-register-modal');
            if (modal) {
                modal.remove();
            }
        }

        // ÂèëÈÄÅÊâãÊú∫È™åËØÅÁ†Å
        function sendPhoneVerification() {
            const phone = document.getElementById('phoneNumber').value;
            const name = document.getElementById('userName').value;
            
            if (!phone || phone.length !== 11) {
                showToast('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑ11‰ΩçÊâãÊú∫Âè∑Á†Å', 'error');
                return;
            }
            
            if (!name || name.trim().length < 2) {
                showToast('ËØ∑ËæìÂÖ•Ëá≥Â∞ë2‰ΩçÂßìÂêç', 'error');
                return;
            }
            
            // È™åËØÅÊâãÊú∫Âè∑Ê†ºÂºè
            if (!/^1[3-9]\d{9}$/.test(phone)) {
                showToast('ËØ∑ËæìÂÖ•Ê≠£Á°ÆÁöÑÊâãÊú∫Âè∑Á†ÅÊ†ºÂºè', 'error');
                return;
            }
            
            // Ê®°ÊãüÂèëÈÄÅÈ™åËØÅÁ†Å
            showToast('È™åËØÅÁ†ÅÂèëÈÄÅ‰∏≠...', 'info');
            
            // ÁîüÊàê6‰ΩçÈöèÊú∫È™åËØÅÁ†Å
            const verificationCode = Math.floor(100000 + Math.random() * 900000);
            localStorage.setItem('phone_verification_code', verificationCode.toString());
            localStorage.setItem('phone_number', phone);
            localStorage.setItem('phone_user_name', name);
            
            // ÊòæÁ§∫Á¨¨‰∫åÊ≠•
            document.getElementById('phoneStep1').style.display = 'none';
            document.getElementById('phoneStep2').style.display = 'block';
            document.getElementById('displayPhone').textContent = phone;
            
            // ÂºÄÂßãÂÄíËÆ°Êó∂
            startPhoneCountdown();
            
            // ÊòæÁ§∫È™åËØÅÁ†ÅÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•ÈÄöËøáÁü≠‰ø°ÂèëÈÄÅÔºâ
            setTimeout(() => {
                showToast(`È™åËØÅÁ†ÅÔºö${verificationCode}ÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠‰ºöÈÄöËøáÁü≠‰ø°ÂèëÈÄÅÔºâ`, 'success');
            }, 1000);
        }

        // ÂºÄÂßãÊâãÊú∫È™åËØÅÁ†ÅÂÄíËÆ°Êó∂
        function startPhoneCountdown() {
            let countdown = 60;
            const countdownElement = document.getElementById('phoneCountdown');
            const resendBtn = document.getElementById('resendCodeBtn');
            
            const timer = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(timer);
                    resendBtn.disabled = false;
                    resendBtn.textContent = 'ÈáçÊñ∞ÂèëÈÄÅ';
                    countdownElement.textContent = '0';
                }
            }, 1000);
        }

        // ÈáçÊñ∞ÂèëÈÄÅÊâãÊú∫È™åËØÅÁ†Å
        function resendPhoneCode() {
            const phone = document.getElementById('phoneNumber').value;
            
            // ÁîüÊàêÊñ∞ÁöÑÈ™åËØÅÁ†Å
            const verificationCode = Math.floor(100000 + Math.random() * 900000);
            localStorage.setItem('phone_verification_code', verificationCode.toString());
            
            // ÈáçÊñ∞ÂºÄÂßãÂÄíËÆ°Êó∂
            startPhoneCountdown();
            
            // ÊòæÁ§∫Êñ∞È™åËØÅÁ†Å
            showToast(`Êñ∞È™åËØÅÁ†ÅÔºö${verificationCode}ÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠‰ºöÈÄöËøáÁü≠‰ø°ÂèëÈÄÅÔºâ`, 'success');
        }

        // ËøîÂõûÊâãÊú∫Âè∑Ê≥®ÂÜåÁ¨¨‰∏ÄÊ≠•
        function backToPhoneStep1() {
            document.getElementById('phoneStep2').style.display = 'none';
            document.getElementById('phoneStep1').style.display = 'block';
        }

        // È™åËØÅÊâãÊú∫Âè∑Âπ∂ÂÆåÊàêÊ≥®ÂÜå
        function verifyPhoneAndRegister() {
            const code = document.getElementById('phoneVerificationCode').value;
            const password = document.getElementById('phonePassword').value;
            const confirmPassword = document.getElementById('phoneConfirmPassword').value;
            const agreeTerms = document.getElementById('agreePhoneTerms').checked;
            
            // È™åËØÅÈ™åËØÅÁ†Å
            const storedCode = localStorage.getItem('phone_verification_code');
            if (code !== storedCode) {
                showToast('È™åËØÅÁ†ÅÈîôËØØÔºåËØ∑ÈáçÊñ∞ËæìÂÖ•', 'error');
                return;
            }
            
            // È™åËØÅÂØÜÁ†Å
            if (password.length < 8) {
                showToast('ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë8‰Ωç', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showToast('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥', 'error');
                return;
            }
            
            if (!agreeTerms) {
                showToast('ËØ∑ÂêåÊÑèÊúçÂä°Êù°Ê¨æÂíåÈöêÁßÅÊîøÁ≠ñ', 'error');
                return;
            }
            
            // Ëé∑ÂèñÂ≠òÂÇ®ÁöÑ‰ø°ÊÅØ
            const phone = localStorage.getItem('phone_number');
            const name = localStorage.getItem('phone_user_name');
            const email = phone + '@phone.com';
            
            // ÂàõÂª∫Áî®Êà∑Ë¥¶Âè∑
            const phoneUser = {
                    username: name,
                    email: email,
                    phone: phone,
                password: password,
                loginMethod: 'Phone',
                registerDate: new Date().toISOString()
            };
            
            // ‰øùÂ≠òÁî®Êà∑‰ø°ÊÅØ
            currentUser = phoneUser;
            localStorage.setItem('mbti_user', JSON.stringify(phoneUser));
            
            // Ê∏ÖÁêÜ‰∏¥Êó∂Êï∞ÊçÆ
            localStorage.removeItem('phone_verification_code');
            localStorage.removeItem('phone_number');
            localStorage.removeItem('phone_user_name');
            
            // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
            showToast('ÊâãÊú∫Âè∑Ê≥®ÂÜåÊàêÂäüÔºÅ', 'success');
            
            // ÂÖ≥Èó≠ÂºπÁ™óÂπ∂Ë∑≥ËΩ¨
            closePhoneRegisterModal();
                closeGoogleModal();
                showMainContent();
                
            console.log('ÊâãÊú∫Âè∑Ê≥®ÂÜåÊàêÂäü:', phoneUser);
        }
        // ÈÄÄÂá∫ÁôªÂΩï
        function logout() {
            try {
                console.log('Logout clicked');
                // Clear user session
                currentUser = null;
                localStorage.removeItem('mbti_user');

                // Update header state
                showGuestState();

                // Give user feedback
                if (typeof showToast === 'function') {
                    showToast('Â∑≤ÈÄÄÂá∫ÁôªÂΩï', 'success');
                }

                // Ensure we are on home and header/feature sections are visible
                if (typeof navigateToPage === 'function') {
                    navigateToPage(PAGE_STATES.HOME, false);
                }

                // Fallback: explicitly unhide header sections
                const featuresSection = document.getElementById('featuresSection');
                const mainHeader = document.getElementById('mainHeader');
                if (featuresSection) featuresSection.classList.remove('hidden');
                if (mainHeader) mainHeader.classList.remove('hidden');
            } catch (e) {
                console.error('Error during logout:', e);
                alert('ÈÄÄÂá∫ÁôªÂΩïÂ§±Ë¥•Ôºö' + (e && e.message ? e.message : e));
            }
        }

        // ÊòæÁ§∫ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢
        function showForgotPassword() {
            navigateToPage(PAGE_STATES.FORGOT_PASSWORD);
        }

        // ÂÖ≥Èó≠ÁôªÂΩïË¶ÜÁõñÂ±Ç
        function closeLogin() {
            try {
                const el = document.getElementById('loginSection');
                if (el) { el.classList.add('hidden'); el.style.display = 'none'; }
                document.body.style.overflow = '';
                navigateToPage(PAGE_STATES.HOME, false);
                const features = document.getElementById('featuresSection');
                const header = document.getElementById('mainHeader');
                if (features) features.classList.remove('hidden');
                if (header) header.classList.remove('hidden');
            } catch (e) {
                console.error('closeLogin error', e);
                goBack();
            }
        }

        // ÂÖ≥Èó≠Ê≥®ÂÜåË¶ÜÁõñÂ±Ç
        function closeRegister() {
            goBack();
        }

        // ÂèëÈÄÅÈ™åËØÅÁ†Å
        function sendVerificationCode() {
            const email = document.getElementById('resetEmail').value;
            if (!email) {
                alert('ËØ∑ÂÖàËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄ');
                return;
            }
            
            if (!email.includes('@')) {
                alert('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ');
                return;
            }
            
            // Ê®°ÊãüÂèëÈÄÅÈ™åËØÅÁ†Å
            const sendBtn = document.querySelector('.send-code-btn');
            sendBtn.disabled = true;
            sendBtn.textContent = 'ÂèëÈÄÅ‰∏≠...';
            
            // Ê®°ÊãüÁΩëÁªúÂª∂Ëøü
            setTimeout(() => {
                // ÁîüÊàê6‰ΩçÈöèÊú∫È™åËØÅÁ†Å
                const code = Math.floor(100000 + Math.random() * 900000);
                
                // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
                showMessage('È™åËØÅÁ†ÅÂ∑≤ÂèëÈÄÅÂà∞ ' + email + '\nÈ™åËØÅÁ†ÅÔºö' + code, 'success');
                
                // ÂºÄÂßãÂÄíËÆ°Êó∂
                startCountdown(sendBtn);
                
                // Â≠òÂÇ®È™åËØÅÁ†ÅÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠Â∫îËØ•ÈÄöËøáÂêéÁ´ØÂèëÈÄÅÔºâ
                localStorage.setItem('reset_code', code.toString());
                localStorage.setItem('reset_email', email);
            }, 1500);
        }

        // ÂºÄÂßãÂÄíËÆ°Êó∂
        function startCountdown(button) {
            let countdown = 60;
            const timer = setInterval(() => {
                button.textContent = `ÈáçÊñ∞ÂèëÈÄÅ(${countdown}s)`;
                countdown--;
                
                if (countdown < 0) {
                    clearInterval(timer);
                    button.disabled = false;
                    button.textContent = 'ÂèëÈÄÅÈ™åËØÅÁ†Å';
                }
            }, 1000);
        }

        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(message, type) {
            // ÁßªÈô§‰πãÂâçÁöÑÊ∂àÊÅØ
            const existingMessage = document.querySelector('.success-message, .error-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            
            const form = document.getElementById('forgotPasswordForm');
            form.insertBefore(messageDiv, form.firstChild);
            
            // 5ÁßíÂêéËá™Âä®ÁßªÈô§Ê∂àÊÅØ
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.remove();
                }
            }, 5000);
        }

        // Ê£ÄÊµãÂØÜÁ†ÅÂº∫Â∫¶
        function checkPasswordStrength(password) {
            let strength = 0;
            const strengthBar = document.getElementById('passwordStrength');
            
            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            strengthBar.className = 'password-strength';
            
            if (strength <= 1) {
                strengthBar.classList.add('weak');
            } else if (strength <= 2) {
                strengthBar.classList.add('fair');
            } else if (strength <= 3) {
                strengthBar.classList.add('good');
            } else {
                strengthBar.classList.add('strong');
            }
        }

        // Â§ÑÁêÜÂøòËÆ∞ÂØÜÁ†ÅË°®ÂçïÊèê‰∫§
        const forgotPasswordForm = document.getElementById('forgotPasswordForm');
        if (forgotPasswordForm) {
            forgotPasswordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('resetEmail').value;
                const code = document.getElementById('resetCode').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmNewPassword').value;
                
                // È™åËØÅÈÇÆÁÆ±
                if (!email || !email.includes('@')) {
                    showMessage('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ', 'error');
                    return;
                }
                
                // È™åËØÅÈ™åËØÅÁ†Å
                const storedCode = localStorage.getItem('reset_code');
                const storedEmail = localStorage.getItem('reset_email');
                
                if (!storedCode || !storedEmail || storedEmail !== email) {
                    showMessage('ËØ∑ÂÖàÂèëÈÄÅÈ™åËØÅÁ†Å', 'error');
                    return;
                }
                
                if (code !== storedCode) {
                    showMessage('È™åËØÅÁ†ÅÈîôËØØÔºåËØ∑ÈáçÊñ∞ËæìÂÖ•', 'error');
                    return;
                }
                
                // È™åËØÅÂØÜÁ†Å
                if (newPassword.length < 8) {
                    showMessage('ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë8‰Ωç', 'error');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    showMessage('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥', 'error');
                    return;
                }
                
                // Ê®°ÊãüÂØÜÁ†ÅÈáçÁΩÆÊàêÂäü
                showMessage('ÂØÜÁ†ÅÈáçÁΩÆÊàêÂäüÔºÅÊ≠£Âú®Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢...', 'success');
                
                // Ê∏ÖÈô§Â≠òÂÇ®ÁöÑÈ™åËØÅÁ†Å
                localStorage.removeItem('reset_code');
                localStorage.removeItem('reset_email');
                
                // 3ÁßíÂêéË∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µÈù¢
                setTimeout(() => {
                    showLogin();
                }, 3000);
            });
        }

        // ÁõëÂê¨Êñ∞ÂØÜÁ†ÅËæìÂÖ•ÔºåÊ£ÄÊµãÂØÜÁ†ÅÂº∫Â∫¶
        const newPasswordInput = document.getElementById('newPassword');
        if (newPasswordInput) {
            newPasswordInput.addEventListener('input', function(e) {
                checkPasswordStrength(e.target.value);
            });
        }

        function startTest() {
            if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
            navigateToPage(PAGE_STATES.TEST);
            initializeTest();
            showQuestion();
        }

        // ÂàùÂßãÂåñÊµãËØï
        function initializeTest() {
            currentQuestion = 0;
            answers = [];
            scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            dimensionProgress = { EI: 0, SN: 0, TF: 0, JP: 0 };
            testLevel = 1;
            
            // ÁîüÊàêÊô∫ËÉΩÈóÆÈ¢òÂ∫èÂàó
            questionSequence = generateQuestionSequence();
        }

        // ÁîüÊàêÊô∫ËÉΩÈóÆÈ¢òÂ∫èÂàó
        function generateQuestionSequence() {
            const sequence = [];
            
            // Á¨¨‰∏ÄÂ±ÇÔºöÂü∫Á°ÄÂÅèÂ•ΩÊµãËØïÔºàÂøÖÈ°ªÂÆåÊàêÔºâ
            const level1Questions = questions.filter(q => q.level === 1);
            sequence.push(...level1Questions);
            
            // Á¨¨‰∫åÂ±ÇÔºöÂÖ∑‰ΩìË°å‰∏∫ÊµãËØï
            const level2Questions = questions.filter(q => q.level === 2);
            sequence.push(...level2Questions);
            
            // Á¨¨‰∏âÂ±ÇÔºöÊ∑±Â∫¶ÂàÜÊûêÊµãËØï
            const level3Questions = questions.filter(q => q.level === 3);
            sequence.push(...level3Questions);
            
            // Á¨¨ÂõõÂ±ÇÔºö‰∫§ÂèâÈ™åËØÅÊµãËØï
            const level4Questions = questions.filter(q => q.level === 4);
            sequence.push(...level4Questions);
            
            // Á¨¨‰∫îÂ±ÇÔºöÁªºÂêàÈ™åËØÅÊµãËØï
            const level5Questions = questions.filter(q => q.level === 5);
            sequence.push(...level5Questions);
            
            return sequence;
        }

        // Êô∫ËÉΩÈÄâÊã©‰∏ã‰∏Ä‰∏™ÈóÆÈ¢ò
        function selectNextQuestion() {
            console.log('selectNextQuestionË¢´Ë∞ÉÁî®');
            console.log('ÂΩìÂâçÈóÆÈ¢òÂ∫èÂàóÈïøÂ∫¶:', questionSequence.length);
            console.log('ÂΩìÂâçÊµãËØïÂ±ÇÁ∫ß:', testLevel);
            console.log('ÂêÑÁª¥Â∫¶ËøõÂ∫¶:', dimensionProgress);
            
            // Â¶ÇÊûúÂΩìÂâçÈóÆÈ¢òÂ∫èÂàó‰∏∫Á©∫ÔºåÈáçÊñ∞ÁîüÊàê
            if (questionSequence.length === 0) {
                console.log('ÈóÆÈ¢òÂ∫èÂàó‰∏∫Á©∫ÔºåÈáçÊñ∞ÁîüÊàê');
                questionSequence = generateQuestionSequence();
            }
            
            // Ê†πÊçÆÂΩìÂâçËøõÂ∫¶ÂíåÁî®Êà∑ÂõûÁ≠îÊ®°ÂºèÈÄâÊã©ÊúÄÂêàÈÄÇÁöÑÈóÆÈ¢ò
            const nextQuestion = findOptimalQuestion();
            
            if (nextQuestion) {
                console.log('ÊâæÂà∞ÊúÄ‰ºòÈóÆÈ¢ò:', nextQuestion);
                currentQuestion = nextQuestion.id - 1; // ËΩ¨Êç¢‰∏∫Á¥¢Âºï
                return nextQuestion;
            } else {
                console.log('Ê≤°ÊúâÊâæÂà∞ÂêàÈÄÇÁöÑÈóÆÈ¢ò');
                return null;
            }
        }

        // ÊâæÂà∞ÊúÄ‰ºòÁöÑ‰∏ã‰∏Ä‰∏™ÈóÆÈ¢ò
        function findOptimalQuestion() {
            console.log('findOptimalQuestionË¢´Ë∞ÉÁî®');
            console.log('ÂΩìÂâçÊµãËØïÂ±ÇÁ∫ß:', testLevel);
            console.log('Â∑≤ÂõûÁ≠îÈóÆÈ¢òÊï∞:', answers.length);
            
            // ‰ºòÂÖàÈÄâÊã©ÂΩìÂâçÂ±ÇÁ∫ßÁöÑÈóÆÈ¢ò
            let availableQuestions = questionSequence.filter(q => 
                q.level === testLevel && 
                !answers.find(a => a.questionId === q.id)
            );
            
            console.log('ÂΩìÂâçÂ±ÇÁ∫ßÂèØÁî®ÈóÆÈ¢òÊï∞:', availableQuestions.length);
            
            // Â¶ÇÊûúÊ≤°ÊúâÂΩìÂâçÂ±ÇÁ∫ßÁöÑÈóÆÈ¢òÔºåÊ£ÄÊü•ÂâçÁΩÆÊù°‰ª∂
            if (availableQuestions.length === 0) {
                console.log('ÂΩìÂâçÂ±ÇÁ∫ßÊ≤°ÊúâÂèØÁî®ÈóÆÈ¢òÔºåÊ£ÄÊü•ÂâçÁΩÆÊù°‰ª∂');
                availableQuestions = questionSequence.filter(q => 
                    !answers.find(a => a.questionId === q.id) &&
                    checkQuestionRequirements(q)
                );
                console.log('Êª°Ë∂≥ÂâçÁΩÆÊù°‰ª∂ÁöÑÈóÆÈ¢òÊï∞:', availableQuestions.length);
            }
            
            // Â¶ÇÊûúËøòÊòØÊ≤°ÊúâÔºåÈÄâÊã©‰ªª‰ΩïÊú™ÂõûÁ≠îÁöÑÈóÆÈ¢ò
            if (availableQuestions.length === 0) {
                console.log('Ê≤°ÊúâÊª°Ë∂≥ÂâçÁΩÆÊù°‰ª∂ÁöÑÈóÆÈ¢òÔºåÈÄâÊã©‰ªª‰ΩïÊú™ÂõûÁ≠îÁöÑÈóÆÈ¢ò');
                availableQuestions = questionSequence.filter(q => 
                    !answers.find(a => a.questionId === q.id)
                );
                console.log('Êú™ÂõûÁ≠îÁöÑÈóÆÈ¢òÊï∞:', availableQuestions.length);
            }
            
            // Ê†πÊçÆÁª¥Â∫¶ËøõÂ∫¶ÂíåÊùÉÈáçÈÄâÊã©ÊúÄ‰ºòÈóÆÈ¢ò
            if (availableQuestions.length > 0) {
                console.log('ÊâæÂà∞ÂèØÁî®ÈóÆÈ¢òÔºåÊåâ‰ºòÂÖàÁ∫ßÈÄâÊã©');
                return selectQuestionByPriority(availableQuestions);
            }
            
            console.log('Ê≤°ÊúâÊâæÂà∞‰ªª‰ΩïÂèØÁî®ÈóÆÈ¢ò');
            return null;
        }

        // Ê£ÄÊü•ÈóÆÈ¢òÂâçÁΩÆÊù°‰ª∂
        function checkQuestionRequirements(question) {
            if (!question.requires) return true;
            
            const requirements = Array.isArray(question.requires) ? question.requires : [question.requires];
            
            for (const req of requirements) {
                if (req === 'EI' && dimensionProgress.EI < 2) return false;
                if (req === 'SN' && dimensionProgress.SN < 2) return false;
                if (req === 'TF' && dimensionProgress.TF < 2) return false;
                if (req === 'JP' && dimensionProgress.JP < 2) return false;
            }
            
            return true;
        }

        // Ê†πÊçÆ‰ºòÂÖàÁ∫ßÈÄâÊã©ÈóÆÈ¢ò
        function selectQuestionByPriority(availableQuestions) {
            // ËÆ°ÁÆóÊØè‰∏™ÈóÆÈ¢òÁöÑ‰ºòÂÖàÁ∫ßÂàÜÊï∞
            const questionScores = availableQuestions.map(q => {
                let score = q.weight;
                
                // Ê†πÊçÆÁª¥Â∫¶ËøõÂ∫¶Ë∞ÉÊï¥ÂàÜÊï∞
                const dimension = q.dimension;
                if (dimension === 'EI') score += dimensionProgress.EI * 0.1;
                if (dimension === 'SN') score += dimensionProgress.SN * 0.1;
                if (dimension === 'TF') score += dimensionProgress.TF * 0.1;
                if (dimension === 'JP') score += dimensionProgress.JP * 0.1;
                
                return { question: q, score: score };
            });
            
            // ÊåâÂàÜÊï∞ÊéíÂ∫èÔºåÈÄâÊã©ÊúÄÈ´òÂàÜÁöÑÈóÆÈ¢ò
            questionScores.sort((a, b) => b.score - a.score);
            return questionScores[0].question;
        }

        function showQuestion() {
            console.log('showQuestionË¢´Ë∞ÉÁî®');
            console.log('ÂΩìÂâçÂ∑≤ÂõûÁ≠îÈóÆÈ¢òÊï∞:', answers.length);
            console.log('ÊÄªÈóÆÈ¢òÊï∞:', questions.length);
            
            // Êô∫ËÉΩÈÄâÊã©‰∏ã‰∏Ä‰∏™ÈóÆÈ¢ò
            const nextQuestion = selectNextQuestion();
            
            if (!nextQuestion) {
                console.log('Ê≤°ÊúâÊâæÂà∞‰∏ã‰∏Ä‰∏™ÈóÆÈ¢òÔºåÊòæÁ§∫ÁªìÊûú');
                // ÊâÄÊúâÈóÆÈ¢òÈÉΩÂÆåÊàê‰∫Ü
                showResults();
                return;
            }
            
            console.log('ÊâæÂà∞‰∏ã‰∏Ä‰∏™ÈóÆÈ¢ò:', nextQuestion);
            const question = nextQuestion;
            currentQuestion = question.id - 1;
            
            // ÊòæÁ§∫ÈóÆÈ¢ò‰ø°ÊÅØÔºàÂåÖÂê´ÂõæÁâáÂíå‰∫§ÂèâÊµãËØïÊèêÁ§∫Ôºâ
            const questionTextElement = document.getElementById('questionText');
            if (questionTextElement) {
                console.log('ÂºÄÂßãÊûÑÂª∫ÈóÆÈ¢òÊòæÁ§∫...');
                console.log('ÈóÆÈ¢òÂØπË±°:', question);
                
                // Ê∏ÖÁ©∫‰πãÂâçÁöÑÂÜÖÂÆπ
                questionTextElement.innerHTML = '';
                
                // Ê∑ªÂä†ÈóÆÈ¢òÂõæÁâá
                const questionImage = getQuestionImage(question);
                console.log('ÈóÆÈ¢òÂõæÁâáHTML:', questionImage);
                if (questionImage) {
                    const imageDiv = document.createElement('div');
                    imageDiv.innerHTML = questionImage;
                    questionTextElement.appendChild(imageDiv);
                    console.log('ÂõæÁâáÂ∑≤Ê∑ªÂä†');
                }
                
                // Ê∑ªÂä†ÈóÆÈ¢òÊñáÊú¨
                const questionTextDiv = document.createElement('div');
                questionTextDiv.className = 'question-text';
                questionTextDiv.textContent = question.question;
                questionTextElement.appendChild(questionTextDiv);
                console.log('ÈóÆÈ¢òÊñáÊú¨Â∑≤Ê∑ªÂä†');
                
                // Ê∑ªÂä†‰∫§ÂèâÊµãËØïÊèêÁ§∫
                const crossTestHint = getCrossTestHint(question);
                console.log('‰∫§ÂèâÊµãËØïÊèêÁ§∫HTML:', crossTestHint);
                if (crossTestHint) {
                    const crossTestDiv = document.createElement('div');
                    crossTestDiv.innerHTML = crossTestHint;
                    questionTextElement.appendChild(crossTestDiv);
                    console.log('‰∫§ÂèâÊµãËØïÊèêÁ§∫Â∑≤Ê∑ªÂä†');
                }
                
                // Ê∑ªÂä†Âú∫ÊôØÊèèËø∞
                if (question.scenario) {
                    const scenarioDiv = document.createElement('div');
                    scenarioDiv.className = 'question-scenario';
                    scenarioDiv.innerHTML = `<span class="scenario-icon">üé≠</span> ${question.scenario}`;
                    questionTextElement.appendChild(scenarioDiv);
                }
            } else {
                console.error('ÈóÆÈ¢òÊñáÊú¨ÂÖÉÁ¥†Êú™ÊâæÂà∞');
            }
            
            // ÊòæÁ§∫ÈóÆÈ¢òÂ±ÇÁ∫ßÂíåÁ±ªÂà´‰ø°ÊÅØ
            updateQuestionInfo(question);
            
            const optionsContainer = document.getElementById('optionsContainer');
            if (optionsContainer) {
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.textContent = option;
                    button.onclick = () => selectOption(index, question);
                optionsContainer.appendChild(button);
            });
            } else {
                console.error('ÈÄâÈ°πÂÆπÂô®Êú™ÊâæÂà∞');
            }
            
            // Êõ¥Êñ∞ÊµãËØïÈò∂ÊÆµÊòæÁ§∫
            updateTestStage();
            
            updateProgress();
            updateNavigationButtons();
            
            console.log('ÈóÆÈ¢òÊòæÁ§∫ÂÆåÊàê');
        }

        // Êõ¥Êñ∞ÈóÆÈ¢ò‰ø°ÊÅØÊòæÁ§∫
        function updateQuestionInfo(question) {
            const stageBadge = document.getElementById('currentStageBadge');
            if (stageBadge) {
                const levelNames = {
                    1: "üå± Âü∫Á°ÄÂÅèÂ•ΩÊé¢Á¥¢",
                    2: "üîç ÂÖ∑‰ΩìË°å‰∏∫ÂàÜÊûê", 
                    3: "üéØ Ê∑±Â∫¶ÊÄùÁª¥ÊµãËØï",
                    4: "üîÑ ‰∫§ÂèâÈ™åËØÅÁ°ÆËÆ§",
                    5: "‚ú® ÁªºÂêàËÉΩÂäõËØÑ‰º∞"
                };
                
                const levelName = levelNames[question.level] || "ÊµãËØïËøõË°å‰∏≠";
                const categoryName = getCategoryName(question.category);
                
                stageBadge.textContent = `${levelName} - ${categoryName}`;
            }
        }

        // Ëé∑ÂèñÁ±ªÂà´ÂêçÁß∞
        function getCategoryName(category) {
            const categoryNames = {
                'social_energy': 'Á§æ‰∫§ËÉΩÈáè',
                'information_processing': '‰ø°ÊÅØÂ§ÑÁêÜ',
                'decision_making': 'ÂÜ≥Á≠ñÊñπÂºè',
                'lifestyle_preference': 'ÁîüÊ¥ªÊñπÂºè',
                'team_communication': 'Âõ¢ÈòüÊ≤üÈÄö',
                'learning_style': 'Â≠¶‰π†ÊñπÂºè',
                'emotional_support': 'ÊÉÖÊÑüÊîØÊåÅ',
                'work_organization': 'Â∑•‰ΩúÁªÑÁªá',
                'innovation_approach': 'ÂàõÊñ∞ÊñπÂºè',
                'stress_response': 'ÂéãÂäõÂ∫îÂØπ',
                'conflict_resolution': 'ÂÜ≤Á™ÅÂ§ÑÁêÜ',
                'change_adaptation': 'ÂèòÂåñÈÄÇÂ∫î',
                'leadership_style': 'È¢ÜÂØºÈ£éÊ†º',
                'problem_solving': 'ÈóÆÈ¢òËß£ÂÜ≥',
                'personal_growth': '‰∏™‰∫∫ÂèëÂ±ï',
                'project_management': 'È°πÁõÆÁÆ°ÁêÜ',
                'ideal_workplace': 'ÁêÜÊÉ≥Â∑•‰ΩúÁéØÂ¢É',
                'relationship_values': 'ÂÖ≥Á≥ª‰ª∑ÂÄºËßÇ',
                'life_philosophy': 'ÁîüÊ¥ªÂì≤Â≠¶'
            };
            
            return categoryNames[category] || 'ÊÄßÊ†ºÊµãËØï';
        }

        // Ëé∑ÂèñÈóÆÈ¢òÂõæÁâá
        function getQuestionImage(question) {
            if (question.image) {
                if (question.visualType === 'emoji') {
                    return `<div class="question-emoji">${question.image}</div>`;
                } else if (question.visualType === 'image') {
                    return `<img src="${question.image}" alt="ÈóÆÈ¢òÊèíÂõæ" class="question-image">`;
                } else if (question.visualType === 'icon') {
                    return `<div class="question-icon">${question.image}</div>`;
                }
            }
            return '';
        }

        // Ëé∑Âèñ‰∫§ÂèâÊµãËØïÊèêÁ§∫
        function getCrossTestHint(question) {
            if (question.crossTest && question.crossTest.length > 1) {
                const dimensions = question.crossTest.map(d => {
                    const names = { 'EI': 'ÂÜÖÂ§ñÂêë', 'SN': 'ÊÑüËßâÁõ¥Ëßâ', 'TF': 'ÊÄùËÄÉÊÉÖÊÑü', 'JP': 'Âà§Êñ≠ÊÑüÁü•' };
                    return names[d] || d;
                });
                
                // Ëé∑Âèñ‰∫§ÂèâÊµãËØïÁöÑËØ¶ÁªÜËØ¥Êòé
                const crossTestExplanation = getCrossTestExplanation(question.crossTest);
                
                return `
                    <div class="cross-test-hint">
                        üîÑ ‰∫§ÂèâÊµãËØïÔºö${dimensions.join(' + ')}
                        <div class="cross-test-detail">${crossTestExplanation}</div>
                    </div>
                `;
            }
            return '';
        }

        // Ëé∑Âèñ‰∫§ÂèâÊµãËØïËØ¶ÁªÜËØ¥Êòé
        function getCrossTestExplanation(crossTest) {
            const explanations = {
                'EI+SN': 'Ëøô‰∏™ÈóÆÈ¢òÂêåÊó∂ÊµãËØï‰Ω†ÁöÑÁ§æ‰∫§ÂÅèÂ•ΩÂíå‰ø°ÊÅØÂ§ÑÁêÜÊñπÂºèÔºåÂ∏ÆÂä©Êõ¥ÂáÜÁ°ÆÂú∞Âà§Êñ≠‰Ω†ÁöÑÊÄßÊ†ºÁ±ªÂûã',
                'SN+TF': 'ÁªìÂêà‰Ω†ÁöÑ‰ø°ÊÅØÊé•Êî∂ÊñπÂºèÂíåÂÜ≥Á≠ñÂÅèÂ•ΩÔºåÊ∑±ÂÖ•‰∫ÜËß£‰Ω†ÁöÑÊÄùÁª¥Ê®°Âºè',
                'TF+JP': 'ÊµãËØï‰Ω†ÁöÑ‰ª∑ÂÄºËßÇÂíåÁîüÊ¥ªÊñπÂºèÁöÑ‰∏ÄËá¥ÊÄßÔºåÊè≠Á§∫‰Ω†ÁöÑÊ†∏ÂøÉÁâπË¥®',
                'JP+EI': '‰∫ÜËß£‰Ω†ÁöÑËÆ°ÂàíÊÄßÂíåÁ§æ‰∫§ÈúÄÊ±ÇÁöÑÂπ≥Ë°°ÔºåÂ±ïÁé∞‰Ω†ÁöÑÁîüÊ¥ªÊÄÅÂ∫¶',
                'SN+JP': 'Êé¢Á¥¢‰Ω†ÁöÑ‰ø°ÊÅØÂ§ÑÁêÜÂÅèÂ•ΩÂ¶Ç‰ΩïÂΩ±Âìç‰Ω†ÁöÑÁîüÊ¥ªÊñπÂºèÈÄâÊã©',
                'EI+TF': 'ÊµãËØï‰Ω†ÁöÑÁ§æ‰∫§ËÉΩÈáèÊù•Ê∫êÂíåÂÜ≥Á≠ñÊñπÂºèÁöÑÂÖ≥ËÅîÊÄß'
            };
            
            const key = crossTest.join('+');
            return explanations[key] || 'Ëøô‰∏™ÈóÆÈ¢ò‰ªéÂ§ö‰∏™Áª¥Â∫¶ÊµãËØï‰Ω†ÁöÑÊÄßÊ†ºÁâπÂæÅÔºåÊèêÈ´òÊµãËØïÂáÜÁ°ÆÊÄß';
        }

        function selectOption(optionIndex, question) {
            // ÁßªÈô§‰πãÂâçÁöÑÈÄâÊã©
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => {
                btn.classList.remove('selected');
                btn.classList.remove('selecting');
            });
            
            // ÈÄâÊã©ÂΩìÂâçÈÄâÈ°πÂπ∂Ê∑ªÂä†ÈÄâÊã©Âä®Áîª
            const selectedButton = buttons[optionIndex];
            selectedButton.classList.add('selected', 'selecting');
            
            // ËÆ∞ÂΩïÁ≠îÊ°àÔºàÂåÖÂê´ÈóÆÈ¢òIDÂíåÂ±ÇÁ∫ß‰ø°ÊÅØÔºâ
            const answer = {
                questionId: question.id,
                optionIndex: optionIndex,
                dimension: question.dimension,
                level: question.level,
                category: question.category,
                weight: question.weight
            };
            
            answers.push(answer);
            
            // ËÆ°ÁÆóÂä†ÊùÉÂàÜÊï∞
            const isFirstOption = optionIndex === 0;
            const scoreIncrement = question.weight;
            
            if (question.dimension === 'EI') {
                scores[isFirstOption ? 'E' : 'I'] += scoreIncrement;
                dimensionProgress.EI++;
            } else if (question.dimension === 'SN') {
                scores[isFirstOption ? 'S' : 'N'] += scoreIncrement;
                dimensionProgress.SN++;
            } else if (question.dimension === 'TF') {
                scores[isFirstOption ? 'T' : 'F'] += scoreIncrement;
                dimensionProgress.TF++;
            } else if (question.dimension === 'JP') {
                scores[isFirstOption ? 'J' : 'P'] += scoreIncrement;
                dimensionProgress.JP++;
            }
            
            // ÊòæÁ§∫ÈÄâÊã©Á°ÆËÆ§ÊèêÁ§∫
            showSelectionFeedback(selectedButton);
            
            // ÊòæÁ§∫ÈóÆÈ¢òËß£ÈáäÔºàÂèØÈÄâÔºâ
            if (question.explanation) {
                showQuestionExplanation(question.explanation);
            }
            
            // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÊòæÁ§∫ÂπøÂëä
            setTimeout(() => {
                if (shouldShowAd()) {
                    // ÊòæÁ§∫ÂπøÂëäÈ°µÈù¢
                    navigateToPage(PAGE_STATES.AD);
                } else {
                    // ÁªßÁª≠‰∏ã‰∏ÄÈ¢ò
                    nextQuestion();
                }
            }, 1200); // Â¢ûÂä†Âª∂ËøüÔºåËÆ©Áî®Êà∑ÁúãÂà∞Ëß£Èáä
        }

        // ÊòæÁ§∫ÈóÆÈ¢òËß£Èáä
        function showQuestionExplanation(explanation) {
            const explanationDiv = document.createElement('div');
            explanationDiv.className = 'question-explanation';
            explanationDiv.innerHTML = `
                <div class="explanation-content">
                    <span class="explanation-icon">üí°</span>
                    <span class="explanation-text">${explanation}</span>
                </div>
            `;
            
            // Ê∑ªÂä†Âà∞ÈóÆÈ¢ò‰∏ãÊñπ
            const questionContainer = document.querySelector('.question-container');
            questionContainer.appendChild(explanationDiv);
            
            // 3ÁßíÂêéËá™Âä®ÁßªÈô§
            setTimeout(() => {
                if (explanationDiv.parentNode) {
                    explanationDiv.remove();
                }
            }, 3000);
        }

        // ÊòæÁ§∫ÈÄâÊã©Á°ÆËÆ§ÂèçÈ¶à
        function showSelectionFeedback(button) {
            // ÂàõÂª∫ÈÄâÊã©Á°ÆËÆ§ÊèêÁ§∫
            const feedback = document.createElement('div');
            feedback.className = 'selection-feedback';
            feedback.textContent = '‚úì Â∑≤ÈÄâÊã©';
            feedback.style.cssText = `
                position: absolute;
                background: #10b981;
                color: white;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 0.9rem;
                font-weight: 600;
                z-index: 10;
                animation: feedbackFade 0.8s ease-in-out;
                pointer-events: none;
            `;
            
            // Ê∑ªÂä†Âà∞ÊåâÈíÆ‰∏ä
            button.style.position = 'relative';
            button.appendChild(feedback);
            
            // Âä®ÁîªÁªìÊùüÂêéÁßªÈô§ÊèêÁ§∫
            setTimeout(() => {
                if (feedback.parentNode) {
                    feedback.remove();
                }
            }, 800);
        }

        function nextQuestion() {
            // Êô∫ËÉΩÈÄâÊã©‰∏ã‰∏Ä‰∏™ÈóÆÈ¢ò
                showQuestion();
        }

        function previousQuestion() {
            if (answers.length > 0) {
                // ÁßªÈô§ÊúÄÂêé‰∏Ä‰∏™Á≠îÊ°à
                const lastAnswer = answers.pop();
                
                // ÊÅ¢Â§çÂàÜÊï∞
                const dimension = lastAnswer.dimension;
                const isFirstOption = lastAnswer.optionIndex === 0;
                const scoreDecrement = lastAnswer.weight;
                
                if (dimension === 'EI') {
                    scores[isFirstOption ? 'E' : 'I'] -= scoreDecrement;
                    dimensionProgress.EI--;
                } else if (dimension === 'SN') {
                    scores[isFirstOption ? 'S' : 'N'] -= scoreDecrement;
                    dimensionProgress.SN--;
                } else if (dimension === 'TF') {
                    scores[isFirstOption ? 'T' : 'F'] -= scoreDecrement;
                    dimensionProgress.TF--;
                } else if (dimension === 'JP') {
                    scores[isFirstOption ? 'J' : 'P'] -= scoreDecrement;
                    dimensionProgress.JP--;
                }
                
                // ÈáçÊñ∞ÊòæÁ§∫‰∏ä‰∏ÄÈ¢ò
                showQuestion();
            }
        }

        function updateProgress() {
            // ËÆ°ÁÆóÊÄª‰ΩìËøõÂ∫¶
            const totalQuestions = questions.length;
            const answeredQuestions = answers.length;
            const progress = (answeredQuestions / totalQuestions) * 100;
            
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Êõ¥Êñ∞ÂêÑÁª¥Â∫¶ËøõÂ∫¶
            updateDimensionProgress();
        }

        // Êõ¥Êñ∞ÂêÑÁª¥Â∫¶ËøõÂ∫¶
        function updateDimensionProgress() {
            const progressInfo = document.querySelector('.test-progress-info');
            if (progressInfo) {
                const progressText = `
                    <div class="dimension-progress">
                        <div class="progress-item">
                            <span class="progress-label">EIËøõÂ∫¶:</span>
                            <span class="progress-value">${dimensionProgress.EI}/5</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">SNËøõÂ∫¶:</span>
                            <span class="progress-value">${dimensionProgress.SN}/5</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">TFËøõÂ∫¶:</span>
                            <span class="progress-value">${dimensionProgress.TF}/5</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-label">JPËøõÂ∫¶:</span>
                            <span class="progress-value">${dimensionProgress.JP}/5</span>
                        </div>
                    </div>
                    
                    <!-- ‰∫§ÂèâÊµãËØïÂÖ≥Á≥ªÂõæ -->
                    <div class="cross-test-relationship">
                        <div class="relationship-title">üîÑ ‰∫§ÂèâÊµãËØïÂÖ≥Á≥ª</div>
                        <div class="relationship-grid">
                            <div class="relationship-item ${dimensionProgress.EI >= 2 && dimensionProgress.SN >= 2 ? 'active' : ''}">
                                <span class="dimension-pair">EI + SN</span>
                                <span class="status">${dimensionProgress.EI >= 2 && dimensionProgress.SN >= 2 ? '‚úÖ' : '‚è≥'}</span>
                            </div>
                            <div class="relationship-item ${dimensionProgress.SN >= 2 && dimensionProgress.TF >= 2 ? 'active' : ''}">
                                <span class="dimension-pair">SN + TF</span>
                                <span class="status">${dimensionProgress.SN >= 2 && dimensionProgress.TF >= 2 ? '‚úÖ' : '‚è≥'}</span>
                            </div>
                            <div class="relationship-item ${dimensionProgress.TF >= 2 && dimensionProgress.JP >= 2 ? 'active' : ''}">
                                <span class="dimension-pair">TF + JP</span>
                                <span class="status">${dimensionProgress.TF >= 2 && dimensionProgress.JP >= 2 ? '‚úÖ' : '‚è≥'}</span>
                            </div>
                            <div class="relationship-item ${dimensionProgress.JP >= 2 && dimensionProgress.EI >= 2 ? 'active' : ''}">
                                <span class="dimension-pair">JP + EI</span>
                                <span class="status">${dimensionProgress.JP >= 2 && dimensionProgress.EI >= 2 ? '‚úÖ' : '‚è≥'}</span>
                            </div>
                        </div>
                    </div>
                `;
                
                progressInfo.innerHTML = progressText;
            }
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = currentQuestion > 0 ? 'block' : 'none';
            nextBtn.disabled = true;
            
            // ÊÅ¢Â§ç‰πãÂâçÁöÑÈÄâÊã©
            if (answers[currentQuestion] !== undefined) {
                const buttons = document.querySelectorAll('.option-btn');
                buttons[answers[currentQuestion]].classList.add('selected');
                nextBtn.disabled = false;
            }
        }
        function showResults() {
            navigateToPage(PAGE_STATES.RESULT);
            
            // ËÆ°ÁÆóÊÄßÊ†ºÁ±ªÂûã
            const type = (scores.E > scores.I ? 'E' : 'I') +
                        (scores.S > scores.N ? 'S' : 'N') +
                        (scores.T > scores.F ? 'T' : 'F') +
                        (scores.J > scores.P ? 'J' : 'P');
            
            document.getElementById('personalityType').textContent = type;
            
            // ÊòæÁ§∫Áª¥Â∫¶ÂàÜÊûê
            showDimensions();
            
            // ÊòæÁ§∫Á±ªÂûãÊèèËø∞
            document.getElementById('typeDescription').innerHTML = `
                <p><strong>${type}</strong> - ${typeDescriptions[type] || 'ËøôÊòØ‰∏Ä‰∏™Áã¨ÁâπÁöÑÊÄßÊ†ºÁ±ªÂûãÁªÑÂêà„ÄÇ'}</p>
                <p>Âü∫‰∫é‰Ω†ÁöÑÂõûÁ≠îÔºåÊàë‰ª¨ÂàÜÊûê‰∫Ü‰Ω†Âú®Âõõ‰∏™Áª¥Â∫¶‰∏äÁöÑÂÅèÂ•ΩÔºö</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>Â§ñÂêë(E) vs ÂÜÖÂêë(I)</strong>Ôºö‰Ω†ÂÄæÂêë‰∫é${scores.E > scores.I ? 'Â§ñÂêë' : 'ÂÜÖÂêë'}ÔºåÂæóÂàÜ‰∏∫ ${scores.E.toFixed(1)}:${scores.I.toFixed(1)}</li>
                    <li><strong>ÊÑüËßâ(S) vs Áõ¥Ëßâ(N)</strong>Ôºö‰Ω†ÂÄæÂêë‰∫é${scores.S > scores.N ? 'ÊÑüËßâ' : 'Áõ¥Ëßâ'}ÔºåÂæóÂàÜ‰∏∫ ${scores.S.toFixed(1)}:${scores.N.toFixed(1)}</li>
                    <li><strong>ÊÄùËÄÉ(T) vs ÊÉÖÊÑü(F)</strong>Ôºö‰Ω†ÂÄæÂêë‰∫é${scores.T > scores.F ? 'ÊÄùËÄÉ' : 'ÊÉÖÊÑü'}ÔºåÂæóÂàÜ‰∏∫ ${scores.T.toFixed(1)}:${scores.F.toFixed(1)}</li>
                    <li><strong>Âà§Êñ≠(J) vs ÊÑüÁü•(P)</strong>Ôºö‰Ω†ÂÄæÂêë‰∫é${scores.J > scores.P ? 'Âà§Êñ≠' : 'ÊÑüÁü•'}ÔºåÂæóÂàÜ‰∏∫ ${scores.J.toFixed(1)}:${scores.P.toFixed(1)}</li>
                </ul>
                <p><strong>ÊµãËØïÂÆåÊàêÂ∫¶Ôºö</strong>‰Ω†ÂÆåÊàê‰∫Ü ${answers.length} ÈÅìÈ¢òÁõÆÔºåÊ∂µÁõñ‰∫Ü ${Object.values(dimensionProgress).filter(p => p > 0).length} ‰∏™Áª¥Â∫¶ÁöÑÊ∑±Â∫¶ÊµãËØï„ÄÇ</p>
                <p><strong>ÊµãËØïÂ±ÇÁ∫ßÔºö</strong>ÊúÄÈ´òËææÂà∞Á¨¨ ${Math.max(...answers.map(a => a.level))} Â±ÇÁ∫ßÔºåÊµãËØïÊ∑±Â∫¶Ôºö${getTestDepthDescription(Math.max(...answers.map(a => a.level)))}</p>
            `;
        }

        // Ëé∑ÂèñÊµãËØïÊ∑±Â∫¶ÊèèËø∞
        function getTestDepthDescription(level) {
            const depthDescriptions = {
                1: "Âü∫Á°ÄÂÅèÂ•ΩÊé¢Á¥¢",
                2: "ÂÖ∑‰ΩìË°å‰∏∫ÂàÜÊûê",
                3: "Ê∑±Â∫¶ÊÄùÁª¥ÊµãËØï", 
                4: "‰∫§ÂèâÈ™åËØÅÁ°ÆËÆ§",
                5: "ÁªºÂêàËÉΩÂäõËØÑ‰º∞"
            };
            
            return depthDescriptions[level] || "Êú™Áü•Â±ÇÁ∫ß";
        }

        function showDimensions() {
            const container = document.getElementById('dimensionsContainer');
            container.innerHTML = '';
            
            const dimensions = [
                { name: 'Â§ñÂêë (E)', score: scores.E, total: scores.E + scores.I, color: '#667eea' },
                { name: 'ÂÜÖÂêë (I)', score: scores.I, total: scores.E + scores.I, color: '#764ba2' },
                { name: 'ÊÑüËßâ (S)', score: scores.S, total: scores.S + scores.N, color: '#f093fb' },
                { name: 'Áõ¥Ëßâ (N)', score: scores.N, total: scores.S + scores.N, color: '#f5576c' },
                { name: 'ÊÄùËÄÉ (T)', score: scores.T, total: scores.T + scores.F, color: '#4facfe' },
                { name: 'ÊÉÖÊÑü (F)', score: scores.F, total: scores.T + scores.F, color: '#00f2fe' },
                { name: 'Âà§Êñ≠ (J)', score: scores.J, total: scores.J + scores.P, color: '#43e97b' },
                { name: 'ÊÑüÁü• (P)', score: scores.P, total: scores.J + scores.P, color: '#38f9d7' }
            ];
            
            dimensions.forEach(dim => {
                const percentage = dim.total > 0 ? (dim.score / dim.total) * 100 : 50;
                
                const div = document.createElement('div');
                div.className = 'dimension';
                div.innerHTML = `
                    <h4>${dim.name}</h4>
                    <div class="dimension-bar">
                        <div class="dimension-fill" style="width: ${percentage}%; background: ${dim.color}"></div>
                    </div>
                    <p>${dim.score} / ${dim.total} (${Math.round(percentage)}%)</p>
                `;
                container.appendChild(div);
            });
        }

        function restartTest() {
            currentQuestion = 0;
            answers = [];
            scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            
            navigateToPage(PAGE_STATES.HOME);
        }

        function showMBTIWelcome() {
            console.log('Ë∑≥ËΩ¨Âà∞‰∏ì‰∏öMBTIÊµãËØïÈ°µÈù¢');
            // Áõ¥Êé•Ë∑≥ËΩ¨Âà∞MBTIÊµãËØïÈ°µÈù¢
            window.location.href = 'mbti-quick-test.html';
        }



        function showFeaturesSection() {
            console.log('ÊòæÁ§∫ÂäüËÉΩÂç°ÁâáÂå∫Âüü');
            
            // ÈöêËóèÊâÄÊúâÈ°µÈù¢
            hideAllPages();
            
            // ÊòæÁ§∫ÂäüËÉΩÂç°ÁâáÂå∫Âüü
            const featuresSection = document.getElementById('featuresSection');
            if (featuresSection) {
                featuresSection.style.display = 'block';
                console.log('ÂäüËÉΩÂç°ÁâáÂå∫ÂüüÂ∑≤ÊòæÁ§∫');
            }
            // Force English on features
            if (window.i18n && typeof i18n.setLanguage === 'function') {
                i18n.setLanguage('en');
                if (typeof i18n.apply === 'function') i18n.apply();
            }
            
            // Á°Æ‰øùÂäüËÉΩÂç°ÁâáÂå∫ÂüüÂèØËßÅ
            console.log('ÂäüËÉΩÂç°ÁâáÂå∫ÂüüÁä∂ÊÄÅ:', {
                element: featuresSection,
                display: featuresSection ? featuresSection.style.display : 'N/A',
                classes: featuresSection ? featuresSection.className : 'N/A'
            });
        }








        function showMBTIInfo() {
            if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
            navigateToPage(PAGE_STATES.MBTI_INFO);
        }

        function hideMBTIInfo() {
            if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
            navigateToPage(PAGE_STATES.HOME);
        }

        // ÂÖ≥Èó≠ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢
        function closeForgotPassword() {
            console.log('ÂÖ≥Èó≠ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢');
            
            try {
                // ÈáçÁΩÆÂøòËÆ∞ÂØÜÁ†ÅÊ≠•È™§
                resetForgotPasswordSteps();
                
                // ËøîÂõû‰∏ä‰∏ÄÈ°µÔºàÈÄöÂ∏∏ÊòØÁôªÂΩïÈ°µÈù¢Ôºâ
                goBack();
                
                console.log('ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢Â∑≤ÂÖ≥Èó≠');
            } catch (error) {
                console.error('ÂÖ≥Èó≠ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢Êó∂Âá∫Èîô:', error);
                // Â¶ÇÊûúÂá∫ÈîôÔºåÁõ¥Êé•ËøîÂõûÈ¶ñÈ°µ
                navigateToPage(PAGE_STATES.HOME, false);
            }
        }



        // Âº∫Âà∂ÈáçÁΩÆÂà∞È¶ñÈ°µÔºàË∞ÉËØïÁî®Ôºâ
        function forceGoHome() {
            console.log('Âº∫Âà∂ËøîÂõûÈ¶ñÈ°µ');
            pageHistory = [];
            navigateToPage(PAGE_STATES.HOME, false);
        }

        // Âà§Êñ≠ÊòØÂê¶Â∫îËØ•ÊòæÁ§∫ÂπøÂëä
        function shouldShowAd() {
            // Âú®Á¨¨3È¢ò„ÄÅÁ¨¨6È¢ò„ÄÅÁ¨¨9È¢òÂêéÊòæÁ§∫ÂπøÂëä
            const adPositions = [3, 6, 9];
            return adPositions.includes(currentQuestion + 1); // +1 Âõ†‰∏∫currentQuestion‰ªé0ÂºÄÂßã
        }

        // ËßÇÁúãÂπøÂëä
        function watchAd() {
            const watchBtn = document.getElementById('watchAdBtn');
            const progressFill = document.getElementById('adProgressFill');
            const countdown = document.getElementById('adCountdown');
            
            // Êõ¥Êñ∞ËøõÂ∫¶‰ø°ÊÅØ
            updateAdProgressInfo();
            
            // Á¶ÅÁî®ÊåâÈíÆ
            watchBtn.disabled = true;
            watchBtn.textContent = 'ËßÇÁúã‰∏≠...';
            
            // Á´ãÂç≥ÊòæÁ§∫Â§áÁî®ÂπøÂëäÔºàÂõ†‰∏∫AdSenseËøòÊ≤°ÈÖçÁΩÆÔºâ
            showFallbackAd();
            
            let timeLeft = 15;
            const totalTime = 15;
            
            // ÂºÄÂßãÂÄíËÆ°Êó∂
            const timer = setInterval(() => {
                timeLeft--;
                const progress = ((totalTime - timeLeft) / totalTime) * 100;
                
                // Êõ¥Êñ∞ËøõÂ∫¶Êù°
                progressFill.style.width = progress + '%';
                
                // Êõ¥Êñ∞ÂÄíËÆ°Êó∂
                countdown.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    // ÂπøÂëäËßÇÁúãÂÆåÊàêÔºåÁªßÁª≠ÊµãËØï
                    continueTest();
                }
            }, 1000);
        }

        // Âä†ËΩΩGoogle AdSenseÂπøÂëä
        function loadGoogleAd() {
            try {
                console.log('ÂºÄÂßãÂä†ËΩΩÂπøÂëä...');
                
                // Ê£ÄÊü•ÈÖçÁΩÆÂíåAdSenseÊòØÂê¶ÂèØÁî®
                if (window.googleAdConfig && window.googleAdConfig.enabled && 
                    typeof adsbygoogle !== 'undefined') {
                    // ÊúâAdSenseÈÖçÁΩÆ‰∏îÂêØÁî®ÔºåÂ∞ùËØïÂä†ËΩΩÁúüÂÆûÂπøÂëä
                    console.log('Â∞ùËØïÂä†ËΩΩGoogle AdSenseÂπøÂëä...');
                    loadRealAdSense();
                } else {
                    // Ê≤°ÊúâÈÖçÁΩÆÊàñÊú™ÂêØÁî®ÔºåÁõ¥Êé•ÊòæÁ§∫Â§áÁî®ÂπøÂëä
                    console.log('Google AdSenseÊú™ÈÖçÁΩÆÊàñÊú™ÂêØÁî®ÔºåÊòæÁ§∫Â§áÁî®ÂπøÂëä');
                showFallbackAd();
                }
            } catch (error) {
                console.error('ÂπøÂëäÂä†ËΩΩÂ§±Ë¥•:', error);
                showFallbackAd();
            }
        }

        // Âä†ËΩΩÁúüÂÆûÁöÑGoogle AdSenseÂπøÂëä
        function loadRealAdSense() {
            try {
                console.log('ÂºÄÂßãÂä†ËΩΩAdSenseÂπøÂëä...');
                
                const adContainer = document.getElementById('google-adsense-container');
                if (!adContainer) {
                    console.error('ÂπøÂëäÂÆπÂô®Êú™ÊâæÂà∞');
                    showFallbackAd();
                    return;
                }

                // ÈöêËóèÂä†ËΩΩÁä∂ÊÄÅ
                const loadingElement = document.querySelector('.ad-loading');
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
                
                // Ê†πÊçÆÂΩìÂâçÈ°µÈù¢ÈÄâÊã©ÂπøÂëäÂçïÂÖÉ
                let adUnitId = 'test-page-ad';
                if (currentPage === PAGE_STATES.RESULT) {
                    adUnitId = 'result-page-ad';
                }

                const adUnit = document.getElementById(adUnitId);
                if (adUnit) {
                    adUnit.style.display = 'block';
                    
                    // ÊâßË°åAdSense‰ª£Á†Å
                    if (typeof adsbygoogle !== 'undefined') {
                        console.log('AdSenseÂèØÁî®ÔºåÂºÄÂßãÂä†ËΩΩÂπøÂëä...');
                        
                        // ‰∏∫ÂπøÂëäÂçïÂÖÉÊ∑ªÂä†Âä†ËΩΩ‰∫ã‰ª∂
                        const adIns = adUnit.querySelector('.adsbygoogle');
                        if (adIns) {
                            // ËÆæÁΩÆÂä†ËΩΩË∂ÖÊó∂
                            setTimeout(() => {
                                checkAdLoaded(adUnit);
                            }, 3000); // 3ÁßíË∂ÖÊó∂
                            
                            // ÊâãÂä®Ëß¶ÂèëAdSense
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    
                    trackAdImpression();
                        }
                } else {
                        throw new Error('AdSense‰ª£Á†Å‰∏çÂèØÁî®');
                }
                } else {
                    throw new Error('ÂπøÂëäÂçïÂÖÉÊú™ÊâæÂà∞');
                }
            } catch (error) {
                console.error('AdSenseÂπøÂëäÂä†ËΩΩÂ§±Ë¥•:', error);
                showFallbackAd();
            }
        }

        // Ê£ÄÊü•ÂπøÂëäÊòØÂê¶ÊàêÂäüÂä†ËΩΩ
        function checkAdLoaded(adUnit) {
            const adIns = adUnit.querySelector('.adsbygoogle');
            if (adIns) {
                // Ê£ÄÊü•ÂπøÂëäÊòØÂê¶ÊúâÂÜÖÂÆπ
                const hasContent = adIns.innerHTML.trim().length > 0;
                const hasIframe = adIns.querySelector('iframe');
                
                if (!hasContent && !hasIframe) {
                    console.log('AdSenseÂπøÂëäÂä†ËΩΩË∂ÖÊó∂ÔºåÊòæÁ§∫Â§áÁî®ÂπøÂëä');
                    showFallbackAd();
                } else {
                    console.log('AdSenseÂπøÂëäÂä†ËΩΩÊàêÂäü');
                }
            }
        }

        // ÊòæÁ§∫Â§áÁî®ÂπøÂëä
        function showFallbackAd() {
            const fallbackAd = document.getElementById('fallback-ad');
            const googleAdContainer = document.getElementById('google-adsense-container');
            
            if (fallbackAd && googleAdContainer) {
                // ÈöêËóèGoogle AdSenseÂÆπÂô®ÂíåÂä†ËΩΩÁä∂ÊÄÅ
                googleAdContainer.style.display = 'none';
                
                // ÊòæÁ§∫Â§áÁî®ÂπøÂëä
                fallbackAd.style.display = 'flex';
                
                // Ê∑ªÂä†Âä®ÁîªÊïàÊûú
                fallbackAd.style.animation = 'adSlideIn 0.5s ease';
                
                // Ëá™Âä®ÂºÄÂßãÂÄíËÆ°Êó∂
                startFallbackAdCountdown();
                
                console.log('Â§áÁî®ÂπøÂëäÂ∑≤ÊòæÁ§∫');
            }
        }

        // ÂºÄÂßãÂ§áÁî®ÂπøÂëäÂÄíËÆ°Êó∂
        function startFallbackAdCountdown() {
            let countdown = 15;
            const countdownElement = document.getElementById('adCountdown');
            const progressFill = document.getElementById('adProgressFill');
            
            if (!countdownElement || !progressFill) return;
            
            const timer = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                // Êõ¥Êñ∞ËøõÂ∫¶Êù°
                const progress = ((15 - countdown) / 15) * 100;
                progressFill.style.width = progress + '%';
                
                if (countdown <= 0) {
                    clearInterval(timer);
                    // ÂπøÂëäËßÇÁúãÂÆåÊàê
                    continueTest();
                }
            }, 1000);
        }

        // Ë∑üË∏™ÂπøÂëäÂ±ïÁ§∫
        function trackAdImpression() {
            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†Google AnalyticsÊàñÂÖ∂‰ªñÁªüËÆ°‰ª£Á†Å
            console.log('ÂπøÂëäÂ±ïÁ§∫ÊàêÂäü');
            
            // ÂèëÈÄÅÂπøÂëäÂ±ïÁ§∫‰∫ã‰ª∂Âà∞ÊúçÂä°Âô®ÔºàÂèØÈÄâÔºâ
            if (typeof gtag !== 'undefined') {
                gtag('event', 'ad_impression', {
                    'event_category': 'advertising',
                    'event_label': 'mbti_test_ad'
                });
            }
        }

        // Êõ¥Êñ∞ÂπøÂëäÈ°µÈù¢ÁöÑËøõÂ∫¶‰ø°ÊÅØ
        function updateAdProgressInfo() {
            const currentQuestionNumber = document.getElementById('currentQuestionNumber');
            const testProgressFill = document.getElementById('testProgressFill');
            const testStageText = document.getElementById('testStageText');
            
            if (currentQuestionNumber) {
                currentQuestionNumber.textContent = currentQuestion + 1;
            }
            
            if (testProgressFill) {
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                testProgressFill.style.width = progress + '%';
            }
            
            if (testStageText) {
                const stage = getTestStage(currentQuestion);
                testStageText.textContent = stage;
            }
        }

        // ÂàùÂßãÂåñÂπøÂëäÈ°µÈù¢
        function initAdPage() {
            // Á°Æ‰øùÂ§áÁî®ÂπøÂëäÂáÜÂ§áÂ•Ω
            const fallbackAd = document.getElementById('fallback-ad');
            const googleAdContainer = document.getElementById('google-adsense-container');
            
            if (fallbackAd && googleAdContainer) {
                // ÈªòËÆ§ÈöêËóèÂ§áÁî®ÂπøÂëäÔºåÁ≠âÂæÖÁî®Êà∑ÁÇπÂáªËßÇÁúã
                fallbackAd.style.display = 'none';
                googleAdContainer.style.display = 'flex';
            }

            // ÂàùÂßãÂåñÈÖçÁΩÆÈù¢Êùø
            initAdConfigPanel();
        }

        // ÂàùÂßãÂåñÂπøÂëäÈÖçÁΩÆÈù¢Êùø
        function initAdConfigPanel() {
            const enabledSelect = document.getElementById('adSenseEnabled');
            const clientIdInput = document.getElementById('adClientId');
            const slotIdInput = document.getElementById('adSlotId');

            if (enabledSelect && clientIdInput && slotIdInput) {
                // ËÆæÁΩÆÂΩìÂâçÈÖçÁΩÆÂÄº
                enabledSelect.value = window.googleAdConfig.enabled.toString();
                clientIdInput.value = window.googleAdConfig.clientId;
                slotIdInput.value = window.googleAdConfig.slotId;
            }
            
            // Ê£ÄÊü•AdSenseÁä∂ÊÄÅ
            checkAdSenseStatus();
        }

        // Ê£ÄÊü•AdSenseÁä∂ÊÄÅ
        function checkAdSenseStatus() {
            // Ê£ÄÊü•ËÑöÊú¨Âä†ËΩΩÁä∂ÊÄÅ
            const scriptStatus = document.getElementById('scriptStatus');
            if (scriptStatus) {
                if (typeof adsbygoogle !== 'undefined') {
                    scriptStatus.textContent = '‚úÖ Â∑≤Âä†ËΩΩ';
                    scriptStatus.style.color = '#28a745';
                } else {
                    scriptStatus.textContent = '‚ùå Êú™Âä†ËΩΩ';
                    scriptStatus.style.color = '#dc3545';
                }
            }
            
            // Ê£ÄÊü•ÂèëÂ∏ÉÂïÜID
            const publisherStatus = document.getElementById('publisherStatus');
            if (publisherStatus) {
                if (window.googleAdConfig.clientId && 
                    window.googleAdConfig.clientId !== 'ca-pub-1234567890123456') {
                    publisherStatus.textContent = '‚úÖ Â∑≤ÈÖçÁΩÆ';
                    publisherStatus.style.color = '#28a745';
                } else {
                    publisherStatus.textContent = '‚ùå Êú™ÈÖçÁΩÆ';
                    publisherStatus.style.color = '#dc3545';
                }
            }
            
            // Ê£ÄÊü•ÂπøÂëä‰ΩçID
            const slotStatus = document.getElementById('slotStatus');
            if (slotStatus) {
                if (window.googleAdConfig.slotId && 
                    window.googleAdConfig.slotId !== '1234567890') {
                    slotStatus.textContent = '‚úÖ Â∑≤ÈÖçÁΩÆ';
                    slotStatus.style.color = '#28a745';
                } else {
                    slotStatus.textContent = '‚ùå ÈúÄË¶ÅÈÖçÁΩÆ';
                    slotStatus.style.color = '#ffc107';
                }
            }
            
            // Ê£ÄÊü•ËøûÊé•Áä∂ÊÄÅ
            const connectionStatus = document.getElementById('connectionStatus');
            if (connectionStatus) {
                connectionStatus.textContent = 'üîÑ ÁÇπÂáªÊµãËØïÊåâÈíÆÊ£ÄÊü•';
                connectionStatus.style.color = '#17a2b8';
            }
        }

        // ÂàáÊç¢ÂπøÂëäÈÖçÁΩÆÈù¢Êùø
        function toggleAdConfig() {
            const configPanel = document.getElementById('adConfigPanel');
            if (configPanel) {
                configPanel.style.display = configPanel.style.display === 'none' ? 'block' : 'none';
            }
        }

        // Êõ¥Êñ∞ÂπøÂëäÈÖçÁΩÆ
        function updateAdConfig() {
            const enabledSelect = document.getElementById('adSenseEnabled');
            const clientIdInput = document.getElementById('adClientId');
            const slotIdInput = document.getElementById('adSlotId');

            if (enabledSelect && clientIdInput && slotIdInput) {
                window.googleAdConfig.enabled = enabledSelect.value === 'true';
                window.googleAdConfig.clientId = clientIdInput.value;
                window.googleAdConfig.slotId = slotIdInput.value;

                // ‰øùÂ≠òÂà∞localStorage
                localStorage.setItem('googleAdConfig', JSON.stringify(window.googleAdConfig));

                console.log('ÂπøÂëäÈÖçÁΩÆÂ∑≤Êõ¥Êñ∞:', window.googleAdConfig);
                
                // ÊòæÁ§∫ÊèêÁ§∫
                showToast('ÂπøÂëäÈÖçÁΩÆÂ∑≤Êõ¥Êñ∞ÔºåÂà∑Êñ∞È°µÈù¢ÂêéÁîüÊïà', 'success');
            }
        }

        // testAdSense ÂáΩÊï∞Â∑≤Âà†Èô§



        // ÊµãËØïÈóÆÈ¢òÊòæÁ§∫ÂäüËÉΩ
        function testQuestionDisplay() {
            console.log('=== ÊµãËØïÈóÆÈ¢òÊòæÁ§∫ÂäüËÉΩ ===');
            
            // Ê£ÄÊü•Á¨¨‰∏Ä‰∏™ÈóÆÈ¢ò
            const firstQuestion = questions[0];
            console.log('Á¨¨‰∏Ä‰∏™ÈóÆÈ¢ò:', firstQuestion);
            
            // ÊµãËØïÂõæÁâáÁîüÊàê
            const questionImage = getQuestionImage(firstQuestion);
            console.log('ÁîüÊàêÁöÑÂõæÁâáHTML:', questionImage);
            
            // ÊµãËØï‰∫§ÂèâÊµãËØïÊèêÁ§∫
            const crossTestHint = getCrossTestHint(firstQuestion);
            console.log('ÁîüÊàêÁöÑ‰∫§ÂèâÊµãËØïÊèêÁ§∫:', crossTestHint);
            
            // ÊµãËØïÂú∫ÊôØÊèèËø∞
            console.log('Âú∫ÊôØÊèèËø∞:', firstQuestion.scenario);
            
            // ÊâãÂä®ÊûÑÂª∫ÈóÆÈ¢òÊòæÁ§∫
            const questionTextElement = document.getElementById('questionText');
            if (questionTextElement) {
                questionTextElement.innerHTML = '';
                
                // Ê∑ªÂä†ÂõæÁâá
                if (questionImage) {
                    const imageDiv = document.createElement('div');
                    imageDiv.innerHTML = questionImage;
                    questionTextElement.appendChild(imageDiv);
                    console.log('ÂõæÁâáÂ∑≤ÊâãÂä®Ê∑ªÂä†');
                }
                
                // Ê∑ªÂä†ÈóÆÈ¢òÊñáÊú¨
                const questionTextDiv = document.createElement('div');
                questionTextDiv.className = 'question-text';
                questionTextDiv.textContent = firstQuestion.question;
                questionTextElement.appendChild(questionTextDiv);
                console.log('ÈóÆÈ¢òÊñáÊú¨Â∑≤ÊâãÂä®Ê∑ªÂä†');
                
                // Ê∑ªÂä†‰∫§ÂèâÊµãËØïÊèêÁ§∫
                if (crossTestHint) {
                    const crossTestDiv = document.createElement('div');
                    crossTestDiv.innerHTML = crossTestHint;
                    questionTextElement.appendChild(crossTestDiv);
                    console.log('‰∫§ÂèâÊµãËØïÊèêÁ§∫Â∑≤ÊâãÂä®Ê∑ªÂä†');
                }
                
                // Ê∑ªÂä†Âú∫ÊôØÊèèËø∞
                if (firstQuestion.scenario) {
                    const scenarioDiv = document.createElement('div');
                    scenarioDiv.className = 'question-scenario';
                    scenarioDiv.innerHTML = `<span class="scenario-icon">üé≠</span> ${firstQuestion.scenario}`;
                    questionTextElement.appendChild(scenarioDiv);
                    console.log('Âú∫ÊôØÊèèËø∞Â∑≤ÊâãÂä®Ê∑ªÂä†');
                }
                
                showToast('ÈóÆÈ¢òÊòæÁ§∫ÊµãËØïÂÆåÊàêÔºåËØ∑Êü•ÁúãÈ°µÈù¢ÂíåÊéßÂà∂Âè∞', 'success');
            } else {
                console.error('ÈóÆÈ¢òÊñáÊú¨ÂÖÉÁ¥†Êú™ÊâæÂà∞');
                showToast('ÈóÆÈ¢òÊñáÊú¨ÂÖÉÁ¥†Êú™ÊâæÂà∞', 'error');
            }
        }

        // Ëé∑ÂèñÊµãËØïÈò∂ÊÆµÊèèËø∞
        function getTestStage(questionIndex) {
            if (questionIndex < 3) {
                return 'üå± ÊÄßÊ†ºÂü∫Á°ÄÊé¢Á¥¢';
            } else if (questionIndex < 6) {
                return 'üîç Ê∑±Â∫¶ÊÄßÊ†ºÂàÜÊûê';
            } else if (questionIndex < 9) {
                return 'üéØ Á≤æÂáÜÊÄßÊ†ºÂÆö‰Ωç';
            } else {
                return '‚ú® ÊúÄÁªàÊÄßÊ†ºÁ°ÆËÆ§';
            }
        }

        // Êõ¥Êñ∞ÊµãËØïÈò∂ÊÆµÊòæÁ§∫
        function updateTestStage() {
            const stageBadge = document.getElementById('currentStageBadge');
            if (stageBadge) {
                const stage = getTestStage(currentQuestion);
                stageBadge.textContent = stage;
            }
        }

        // Ë∑≥ËøáÂπøÂëä
        function skipAd() {
            if (confirm('Á°ÆÂÆöË¶ÅË∑≥ËøáÂπøÂëäÂêóÔºüË∑≥ËøáÂêéÂ∞ÜÊó†Ê≥ïÊü•ÁúãËØ¶ÁªÜÁªìÊûú„ÄÇ')) {
                // Ë∑≥ËøáÂπøÂëäÔºåÁªßÁª≠ÊµãËØï
                continueTest();
            }
        }

        // ÁªßÁª≠ÊµãËØï
        function continueTest() {
            console.log('ÂπøÂëäËßÇÁúãÂÆåÊàêÔºåÁªßÁª≠ÊµãËØï...');
            console.log('ÂΩìÂâçÈóÆÈ¢òÁ¥¢Âºï:', currentQuestion);
            console.log('Â∑≤ÂõûÁ≠îÈóÆÈ¢òÊï∞:', answers.length);
            console.log('ÊÄªÈóÆÈ¢òÊï∞:', questions.length);
            
            // Á°Æ‰øùÂõûÂà∞ÊµãËØïÈ°µÈù¢
            if (currentPage !== PAGE_STATES.TEST) {
                console.log('ÂΩìÂâç‰∏çÂú®ÊµãËØïÈ°µÈù¢ÔºåÂØºËà™Âà∞ÊµãËØïÈ°µÈù¢');
                navigateToPage(PAGE_STATES.TEST);
            }
            
            // Ê£ÄÊü•ÊòØÂê¶ËøòÊúâÊú™ÂõûÁ≠îÁöÑÈóÆÈ¢ò
            if (answers.length < questions.length) {
                console.log('ËøòÊúâÊú™ÂõûÁ≠îÁöÑÈóÆÈ¢òÔºåÁªßÁª≠‰∏ã‰∏ÄÈ¢ò');
                
                // Âª∂Ëøü‰∏Ä‰∏ãÁ°Æ‰øùÈ°µÈù¢ÂàáÊç¢ÂÆåÊàê
                setTimeout(() => {
                    // Âº∫Âà∂Âà∑Êñ∞ÈóÆÈ¢òÊòæÁ§∫
                    console.log('Âº∫Âà∂Âà∑Êñ∞ÈóÆÈ¢òÊòæÁ§∫');
                    showQuestion();
                }, 500);
            } else {
                console.log('ÊâÄÊúâÈóÆÈ¢òÂ∑≤ÂõûÁ≠îÔºåÊòæÁ§∫ÁªìÊûú');
                // ÊµãËØïÂÆåÊàêÔºåÊòæÁ§∫ÁªìÊûú
                showResults();
            }
        }

        // ÂèëÈÄÅÈáçÁΩÆÈÇÆ‰ª∂
        function sendResetEmail() {
            const email = document.getElementById('resetEmail').value;
            if (!email) {
                alert('ËØ∑ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄ');
                return;
            }
            
            // Ê®°ÊãüÂèëÈÄÅÈÇÆ‰ª∂
            alert(`ÈáçÁΩÆÈìæÊé•Â∑≤ÂèëÈÄÅÂà∞ ${email}ÔºåËØ∑Êü•Êî∂ÈÇÆ‰ª∂Âπ∂ËæìÂÖ•È™åËØÅÁ†Å`);
            
            // ÊòæÁ§∫Á¨¨‰∫åÊ≠•
            document.getElementById('forgotPasswordStep1').style.display = 'none';
            document.getElementById('forgotPasswordStep2').style.display = 'block';
            
            // ÁîüÊàêÈ™åËØÅÁ†Å
            const verificationCode = Math.floor(100000 + Math.random() * 900000);
            localStorage.setItem('verificationCode', verificationCode.toString());
            alert(`È™åËØÅÁ†ÅÔºö${verificationCode}ÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠‰ºöÈÄöËøáÈÇÆ‰ª∂ÂèëÈÄÅÔºâ`);
        }

        // ËøîÂõûÁ¨¨‰∏ÄÊ≠•
        function backToStep1() {
            document.getElementById('forgotPasswordStep2').style.display = 'none';
            document.getElementById('forgotPasswordStep1').style.display = 'block';
        }

        // ÈáçÁΩÆÂøòËÆ∞ÂØÜÁ†ÅÊ≠•È™§
        function resetForgotPasswordSteps() {
            document.getElementById('forgotPasswordStep1').style.display = 'block';
            document.getElementById('forgotPasswordStep2').style.display = 'none';
            document.getElementById('resetEmail').value = '';
            document.getElementById('resetCode').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
        }

        // ÈáçÁΩÆÂØÜÁ†Å
        function resetPassword() {
            const code = document.getElementById('resetCode').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;
            
            if (!code || !newPassword || !confirmPassword) {
                alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂ≠óÊÆµ');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥');
                return;
            }
            
            const storedCode = localStorage.getItem('verificationCode');
            if (code !== storedCode) {
                alert('È™åËØÅÁ†ÅÈîôËØØ');
                return;
            }
            
            // Ê®°ÊãüÂØÜÁ†ÅÈáçÁΩÆÊàêÂäü
            alert('ÂØÜÁ†ÅÈáçÁΩÆÊàêÂäüÔºÅ');
            localStorage.removeItem('verificationCode');
            
            // ÂÖ≥Èó≠ÂøòËÆ∞ÂØÜÁ†ÅÈ°µÈù¢ÔºåËøîÂõûÁôªÂΩïÈ°µÈù¢
            closeForgotPassword();
        }

        // È°µËÑöÁõ∏ÂÖ≥ÂäüËÉΩ

        // ËøîÂõûÈ°∂ÈÉ®
        function backToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // ÊòæÁ§∫ÁïôË®ÄÂèçÈ¶àÂºπÁ™ó
        function showFeedback() {
            showFeedbackModal();
        }

        // ÂÖ≥Èó≠ÁïôË®ÄÂèçÈ¶àÂºπÁ™ó
        function closeFeedbackModal() {
            document.getElementById('feedbackModal').classList.add('hidden');
            document.getElementById('feedbackModal').style.display = 'none';
        }

        // ÊòæÁ§∫ÈöêÁßÅÊîøÁ≠ñÂºπÁ™ó
        function showPrivacyPolicy() {
            document.getElementById('privacyPolicyModal').classList.remove('hidden');
            document.getElementById('privacyPolicyModal').style.display = 'flex';
        }

        // ÂÖ≥Èó≠ÈöêÁßÅÊîøÁ≠ñÂºπÁ™ó
        function closePolicyModal() {
            document.getElementById('privacyPolicyModal').classList.add('hidden');
            document.getElementById('privacyPolicyModal').style.display = 'none';
        }

        // Áü•ÊôìÈöêÁßÅÊîøÁ≠ñÂπ∂ËøîÂõûÈ¶ñÈ°µ
        function acknowledgePrivacyPolicy() {
            // ËÆ∞ÂΩïÁî®Êà∑Â∑≤ÈòÖËØªÈöêÁßÅÊîøÁ≠ñ
            localStorage.setItem('privacy_policy_read', 'true');
            localStorage.setItem('privacy_policy_read_date', new Date().toISOString());
            
            // ÊòæÁ§∫Á°ÆËÆ§Ê∂àÊÅØ
            showToast('ÊÑüË∞¢ÊÇ®ÈòÖËØªÈöêÁßÅÊîøÁ≠ñÔºÅ', 'success');
            
            // ÂÖ≥Èó≠ÈöêÁßÅÊîøÁ≠ñÂºπÁ™ó
            closePolicyModal();
            
            // ËøîÂõûÈ¶ñÈ°µ
            navigateToPage(PAGE_STATES.HOME, false);
            
            // ËÆ∞ÂΩïÊó•Âøó
            console.log('Áî®Êà∑Â∑≤ÈòÖËØªÈöêÁßÅÊîøÁ≠ñÂπ∂ËøîÂõûÈ¶ñÈ°µ');
        }

        // ÊòæÁ§∫ÊúçÂä°Êù°Ê¨æÂºπÁ™ó
        function showTermsOfService() {
            document.getElementById('termsModal').classList.remove('hidden');
            document.getElementById('termsModal').style.display = 'flex';
        }

        // ÂÖ≥Èó≠ÊúçÂä°Êù°Ê¨æÂºπÁ™ó
        function closeTermsModal() {
            document.getElementById('termsModal').classList.add('hidden');
            document.getElementById('termsModal').style.display = 'none';
        }

        // Áü•ÊôìÂπ∂ÂêåÊÑèÊúçÂä°Êù°Ê¨æ
        function acknowledgeTerms() {
            // ËÆ∞ÂΩïÁî®Êà∑Â∑≤ÂêåÊÑèÊúçÂä°Êù°Ê¨æ
            localStorage.setItem('terms_accepted', 'true');
            localStorage.setItem('terms_accepted_date', new Date().toISOString());
            
            // ÊòæÁ§∫Á°ÆËÆ§Ê∂àÊÅØ
            showToast('ÊÑüË∞¢ÊÇ®ÂêåÊÑèÊúçÂä°Êù°Ê¨æÔºÅ', 'success');
            
            // ÂÖ≥Èó≠ÂºπÁ™ó
            closeTermsModal();
            
            // ÂØºËà™Âà∞‰∏ªÈ°µ
            navigateToPage(PAGE_STATES.HOME);
            
            // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†ÂÖ∂‰ªñÈÄªËæëÔºåÊØîÂ¶ÇÂêØÁî®Êüê‰∫õÂäüËÉΩ
            console.log('Áî®Êà∑Â∑≤ÂêåÊÑèÊúçÂä°Êù°Ê¨æ');
        }

        // Ê∑ªÂä†ÊúçÂä°Êù°Ê¨æÊåâÈíÆÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function addTermsButtonListeners() {
            // Á≠âÂæÖDOMÂä†ËΩΩÂÆåÊàê
            setTimeout(() => {
                const agreeButton = document.getElementById('agreeTermsBtn');
                if (agreeButton) {
                    console.log('ÊâæÂà∞ÂêåÊÑèÊåâÈíÆÔºåÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®');
                    
                    // Ê∑ªÂä†Êñ∞ÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
                    agreeButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('ÂêåÊÑèÊåâÈíÆË¢´ÁÇπÂáª');
                        
                        // Ë∞ÉÁî®acknowledgeTermsÂáΩÊï∞
                        acknowledgeTerms();
                    });
                    
                    console.log('‰∫ã‰ª∂ÁõëÂê¨Âô®Â∑≤Ê∑ªÂä†');
                } else {
                    console.log('Êú™ÊâæÂà∞ÂêåÊÑèÊåâÈíÆ');
                }
            }, 1000);
        }
        // ÊòæÁ§∫ÈòÖËØªÊèêÈÜí
        function showReadReminder() {
            // ÂàõÂª∫ÊèêÈÜíÂºπÁ™ó
            const reminderModal = document.createElement('div');
            reminderModal.className = 'reminder-modal';
            reminderModal.innerHTML = `
                <div class="reminder-modal-content">
                    <div class="reminder-modal-header">
                        <h3>‚ö†Ô∏è ÈáçË¶ÅÊèêÈÜí</h3>
                    </div>
                    <div class="reminder-modal-body">
                        <div class="reminder-icon">üìñ</div>
                        <h4>ËØ∑‰ªîÁªÜÈòÖËØªÊúçÂä°Êù°Ê¨æ</h4>
                        <p>‰∏∫‰∫ÜÁ°Æ‰øùÊÇ®‰∫ÜËß£Êàë‰ª¨ÁöÑÊúçÂä°ËßÑÂàôÂíåÊÇ®ÁöÑÊùÉÂà©ÔºåËØ∑Âä°ÂøÖÂÆåÊï¥ÈòÖËØª‰ª•‰∏äÊúçÂä°Êù°Ê¨æÂÜÖÂÆπ„ÄÇ</p>
                        <p><strong>ÈáçË¶ÅÊèêÁ§∫Ôºö</strong></p>
                        <ul>
                            <li>ÊµãËØïÁªìÊûú‰ªÖ‰æõÂ®±‰πêÂíåÂèÇËÄÉ‰ΩøÁî®</li>
                            <li>‰∏çÊûÑÊàê‰∏ì‰∏öÂøÉÁêÜÂª∫ËÆÆ</li>
                            <li>ËØ∑ÈÅµÂÆàÁî®Êà∑Ë¥£‰ªªÊù°Ê¨æ</li>
                        </ul>
                        <div class="reminder-actions">
                            <button class="btn btn-secondary" onclick="this.parentElement.parentElement.parentElement.parentElement.remove()">ÊàëÁü•ÈÅì‰∫Ü</button>
                            <button class="btn" onclick="returnToTerms()">ËøîÂõûÁªßÁª≠ÈòÖËØª</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(reminderModal);
            
            // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠
            reminderModal.addEventListener('click', (e) => {
                if (e.target === reminderModal) {
                    reminderModal.remove();
                }
            });
        }

        // ËøîÂõûÊúçÂä°Êù°Ê¨æ
        function returnToTerms() {
            // ÁßªÈô§ÊèêÈÜíÂºπÁ™ó
            const reminderModal = document.querySelector('.reminder-modal');
            if (reminderModal) {
                reminderModal.remove();
            }
            
            // Á°Æ‰øùÊúçÂä°Êù°Ê¨æÂºπÁ™ó‰ªçÁÑ∂ÊòæÁ§∫
            const termsModal = document.getElementById('termsModal');
            if (termsModal) {
                termsModal.classList.remove('hidden');
                termsModal.style.display = 'flex';
            }
        }

        // ÊòæÁ§∫Â∏∏ËßÅÈóÆÈ¢ò
        function showFAQ() {
            alert('Â∏∏ËßÅÈóÆÈ¢òÂäüËÉΩÊ≠£Âú®ÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ');
        }

        // ÊòæÁ§∫Â∏ÆÂä©‰∏≠ÂøÉ
        function showHelp() {
            alert('Â∏ÆÂä©‰∏≠ÂøÉÂäüËÉΩÊ≠£Âú®ÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ');
        }

        // ÊòæÁ§∫ÂÖ≥‰∫éÊàë‰ª¨
        function showAbout() {
            alert('ÂÖ≥‰∫éÊàë‰ª¨ÂäüËÉΩÊ≠£Âú®ÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ');
        }

        // Â§ÑÁêÜÈ°µËÑöÁïôË®ÄË°®ÂçïÊèê‰∫§ÔºàÁßªÂà∞DOMÂä†ËΩΩÂÆåÊàêÂêéÊâßË°åÔºâ
        function initFeedbackForms() {
            const feedbackForm = document.getElementById('feedbackForm');
            if (feedbackForm) {
                feedbackForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const name = document.getElementById('feedbackName').value;
                    const email = document.getElementById('feedbackEmail').value;
                    const message = document.getElementById('feedbackMessage').value;
                    
                    if (name && email && message) {
                        // Ê®°ÊãüÊèê‰∫§ÊàêÂäü
                        alert('ÊÑüË∞¢ÊÇ®ÁöÑÁïôË®ÄÔºÅÊàë‰ª¨‰ºöËÆ§ÁúüËÄÉËôëÊÇ®ÁöÑÂª∫ËÆÆ„ÄÇ');
                        
                        // Ê∏ÖÁ©∫Ë°®Âçï
                        feedbackForm.reset();
                    } else {
                        alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ');
                    }
                });
            }

            const feedbackFormModal = document.getElementById('feedbackFormModal');
            if (feedbackFormModal) {
                feedbackFormModal.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const name = document.getElementById('modalFeedbackName').value;
                    const email = document.getElementById('modalFeedbackEmail').value;
                    const type = document.getElementById('modalFeedbackType').value;
                    const message = document.getElementById('modalFeedbackMessage').value;
                    const agreePrivacy = document.getElementById('agreePrivacy').checked;
                    
                    if (!agreePrivacy) {
                        alert('ËØ∑ÂêåÊÑèÈöêÁßÅÊîøÁ≠ñ');
                        return;
                    }
                    
                    if (name && email && type && message) {
                        // Ê®°ÊãüÊèê‰∫§ÊàêÂäü
                        alert('ÊÑüË∞¢ÊÇ®ÁöÑÂèçÈ¶àÔºÅÊàë‰ª¨‰ºöËÆ§ÁúüÂ§ÑÁêÜÊÇ®ÁöÑÈóÆÈ¢ò„ÄÇ');
                        
                        // Ê∏ÖÁ©∫Ë°®ÂçïÂπ∂ÂÖ≥Èó≠ÂºπÁ™ó
                        feedbackFormModal.reset();
                        closeFeedbackModal();
                    } else {
                        alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ');
                    }
                });
            }
        }

        // ÁÇπÂáªÂºπÁ™óÂ§ñÈÉ®ÂÖ≥Èó≠ÂºπÁ™ó
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('feedback-modal') || 
                e.target.classList.contains('policy-modal')) {
                e.target.classList.add('hidden');
                e.target.style.display = 'none';
            }
        });

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñÈ°µËÑöÂäüËÉΩ
        document.addEventListener('DOMContentLoaded', function() {
            // ÂàùÂßãÂåñÊï∞Â≠óËÆ°Êï∞Âô®Âä®Áîª
            initCounters();
            
            // Ê∑ªÂä†ÊªöÂä®ÁõëÂê¨ÔºåÊòæÁ§∫/ÈöêËóèËøîÂõûÈ°∂ÈÉ®ÊåâÈíÆ
            window.addEventListener('scroll', function() {
                const footerControls = document.querySelector('.footer-controls');
                if (footerControls) {
                    const backToTopBtn = footerControls.querySelector('button');
                    if (backToTopBtn && backToTopBtn.textContent.includes('ËøîÂõûÈ°∂ÈÉ®')) {
                        if (window.scrollY > 300) {
                            backToTopBtn.style.opacity = '1';
                        } else {
                            backToTopBtn.style.opacity = '0.7';
                        }
                    }
                }
            });
            
            // ÂàùÂßãÂåñÊòüÂ∫ß+MBTIÂºπÁ™óÁöÑÂÖ≥Èó≠ÊåâÈíÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
            initZodiacModalCloseButton();
            
            // Á°Æ‰øùzodiacTestAnswersÂèòÈáèË¢´Ê≠£Á°ÆÂàùÂßãÂåñ
            initZodiacTestVariables();
            
            // ÂèåÈáç‰øùÈô©ÔºöÁõ¥Êé•Âú®ÂÖ®Â±Ä‰ΩúÁî®ÂüüÂàùÂßãÂåñ
            if (typeof window.zodiacTestAnswers === 'undefined') {
                window.zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                console.log('Âú®ÂÖ®Â±Ä‰ΩúÁî®ÂüüÂàùÂßãÂåñzodiacTestAnswers');
            }
            
            // ÂàùÂßãÂåñÂèçÈ¶àË°®Âçï
            initFeedbackForms();

            // ÁªëÂÆö"Á´ãÂç≥‰ΩìÈ™å"Âç°ÁâáÁÇπÂáª‰∫ã‰ª∂ÔºàÂÜó‰ΩôÁªëÂÆöÔºåÈò≤Ê≠¢inlineÊó†ÊïàÔºâ
            const experienceCard = document.getElementById('zodiacMbtiExperienceCard');
            if (experienceCard) {
                experienceCard.addEventListener('click', function(e) {
                    try {
                        console.log('"Á´ãÂç≥‰ΩìÈ™å"Âç°ÁâáË¢´ÁÇπÂáªÔºàÁõëÂê¨Âô®Ôºâ');
                        // ‰∏çÈòªÊ≠¢ÈªòËÆ§ÔºåËÆ© inline ‰∏éÁõëÂê¨Âô®ÈÉΩËÉΩËß¶ÂèëÔºõÂ¶ÇÈúÄÂçïÈÄöÈÅìÔºåÂèØÂèñÊ∂à‰∏ã‰∏ÄË°åÊ≥®Èáä
                        // e.stopPropagation();
                        startZodiacMBTITest();
                    } catch (err) {
                        console.error('Ëß¶ÂèëstartZodiacMBTITestÂ§±Ë¥•:', err);
                        alert('ÂêØÂä®‰ΩìÈ™åÂ§±Ë¥•: ' + err.message);
                    }
                }, { passive: true });
                console.log('Â∑≤ÁªëÂÆö"Á´ãÂç≥‰ΩìÈ™å"Âç°ÁâáÁÇπÂáª‰∫ã‰ª∂');
            } else {
                console.warn('Êú™ÊâæÂà∞"Á´ãÂç≥‰ΩìÈ™å"Âç°ÁâáËøõË°å‰∫ã‰ª∂ÁªëÂÆö');
            }
            
            // Ê∑ªÂä†ÊúçÂä°Êù°Ê¨æÊåâÈíÆÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
            addTermsButtonListeners();
        });

        // ÂàùÂßãÂåñÊï∞Â≠óËÆ°Êï∞Âô®Âä®Áîª
        function initCounters() {
            const counters = document.querySelectorAll('.stat-counter');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const counter = entry.target.querySelector('.counter');
                        const target = parseInt(entry.target.dataset.target);
                        animateCounter(counter, target);
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });
            
            counters.forEach(counter => observer.observe(counter));
        }

        // Êï∞Â≠óÂä®ÁîªÊïàÊûú
        function animateCounter(element, target) {
            let current = 0;
            const increment = target / 50; // 50Ê≠•ÂÆåÊàêÂä®Áîª
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                
                // Â§ÑÁêÜÂ∞èÊï∞ÁÇπÊòæÁ§∫
                if (target % 1 !== 0) {
                    // Â¶ÇÊûúÊòØÂ∞èÊï∞Ôºå‰øùÁïô‰∏§‰ΩçÂ∞èÊï∞
                    element.textContent = current.toFixed(2);
                } else {
                    // Â¶ÇÊûúÊòØÊï¥Êï∞Ôºå‰∏çÊòæÁ§∫Â∞èÊï∞ÁÇπ
                    element.textContent = Math.floor(current);
                }
            }, 30);
        }

        // Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø
        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ', 'success');
                }).catch(() => {
                    fallbackCopyToClipboard(text);
                });
            } else {
                fallbackCopyToClipboard(text);
            }
        }

        // Â§áÁî®Â§çÂà∂ÊñπÊ≥ï
        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showToast('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ', 'success');
            } catch (err) {
                showToast('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂', 'error');
            }
            document.body.removeChild(textArea);
        }

        // ÊòæÁ§∫ÂæÆ‰ø°‰∫åÁª¥Á†Å
        function showQRCode() {
            const modal = document.createElement('div');
            modal.className = 'qr-modal';
            modal.innerHTML = `
                <div class="qr-modal-content">
                    <div class="qr-modal-header">
                        <h3>üí¨ ÂæÆ‰ø°‰∫åÁª¥Á†Å</h3>
                        <button class="close-btn" onclick="this.parentElement.parentElement.parentElement.remove()">&times;</button>
                    </div>
                    <div class="qr-modal-body">
                        <div class="qr-placeholder">
                            <div class="qr-icon">üì±</div>
                            <p>ÂæÆ‰ø°ÔºöMBTI_Official</p>
                            <p>Êâ´Êèè‰∫åÁª¥Á†ÅÊ∑ªÂä†Â•ΩÂèã</p>
                        </div>
                        <div class="qr-info">
                            <p><strong>ÂÆ¢ÊúçÊó∂Èó¥Ôºö</strong>9:00-18:00</p>
                            <p><strong>ÂìçÂ∫îÈÄüÂ∫¶Ôºö</strong>5ÂàÜÈíüÂÜÖÂõûÂ§ç</p>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // Âø´ÈÄüÂèçÈ¶àÂäüËÉΩ
        function quickFeedback(type) {
            // Ê∑ªÂä†ÊåâÈíÆÁÇπÂáªÊïàÊûú
            const btn = event.target.closest('.feedback-btn');
            if (btn) {
                btn.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    btn.style.transform = '';
                }, 150);
            }
            
            // ËÆ∞ÂΩïÂèçÈ¶àÁ±ªÂûã
            localStorage.setItem('feedback_type', type);
            
            // ÊòæÁ§∫ÂèçÈ¶àÂºπÁ™ó
            showFeedbackModal(type);
            
            // ËÆ∞ÂΩïÂèçÈ¶àÔºàÂÆûÈôÖÂ∫îÁî®‰∏≠ÂèØ‰ª•ÂèëÈÄÅÂà∞ÊúçÂä°Âô®Ôºâ
            console.log(`Áî®Êà∑ÂèçÈ¶à: ${type}`);
        }

        // ÊòæÁ§∫ÁÇπËµûÈÄâÊã©ÂºπÁ™ó
        function showPraiseOptions() {
            const modal = document.createElement('div');
            modal.className = 'praise-modal';
            modal.innerHTML = `
                <div class="praise-modal-content">
                    <div class="praise-modal-header">
                        <h3>üëç ‰∏∫Êàë‰ª¨ÁöÑÊúçÂä°ÁÇπËµû</h3>
                        <button class="close-btn" onclick="closePraiseModal()">&times;</button>
                    </div>
                    <div class="praise-modal-body">
                        <div class="praise-intro">
                            <p>ËØ∑ÈÄâÊã©ÊÇ®ÂØπÊàë‰ª¨ÁöÑMBTIÊµãËØïÊúçÂä°ÁöÑÊª°ÊÑèÁ®ãÂ∫¶Ôºö</p>
                        </div>
                        
                        <div class="praise-options">
                            <div class="praise-option" onclick="selectPraiseLevel('excellent')">
                                <div class="praise-icon">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                <div class="praise-text">
                                    <h4>ÈùûÂ∏∏Êª°ÊÑè</h4>
                                    <p>ÊµãËØïÂáÜÁ°ÆÔºå‰ΩìÈ™åÊµÅÁïÖÔºåÂÆåÂÖ®Ë∂ÖÂá∫È¢ÑÊúü</p>
                                </div>
                                <div class="praise-arrow">‚Üí</div>
                            </div>
                            
                            <div class="praise-option" onclick="selectPraiseLevel('good')">
                                <div class="praise-icon">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                                <div class="praise-text">
                                    <h4>ÊØîËæÉÊª°ÊÑè</h4>
                                    <p>ÊµãËØïÁªìÊûúÂêàÁêÜÔºåÊï¥‰Ωì‰ΩìÈ™åËâØÂ•Ω</p>
                                </div>
                                <div class="praise-arrow">‚Üí</div>
                            </div>
                            
                            <div class="praise-option" onclick="selectPraiseLevel('okay')">
                                <div class="praise-icon">‚≠ê‚≠ê‚≠ê</div>
                                <div class="praise-text">
                                    <h4>Âü∫Êú¨Êª°ÊÑè</h4>
                                    <p>ÊµãËØïÂäüËÉΩÊ≠£Â∏∏ÔºåÂü∫Êú¨Êª°Ë∂≥ÈúÄÊ±Ç</p>
                                </div>
                                <div class="praise-arrow">‚Üí</div>
                            </div>
                        </div>
                        
                        <div class="praise-actions">
                            <button class="btn btn-secondary" onclick="closePraiseModal()">ÂèñÊ∂à</button>
                            <button class="btn" onclick="quickFeedback('praise')">ÂÜôËØ¶ÁªÜËØÑ‰ª∑</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ÂºπÁ™ó
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // ÈÄâÊã©ÁÇπËµûÁ≠âÁ∫ß
        function selectPraiseLevel(level) {
            const levelNames = {
                'excellent': 'ÈùûÂ∏∏Êª°ÊÑè',
                'good': 'ÊØîËæÉÊª°ÊÑè',
                'okay': 'Âü∫Êú¨Êª°ÊÑè'
            };
            
            const levelText = levelNames[level];
            
            // ËÆ∞ÂΩïÁÇπËµûÁ≠âÁ∫ß
            localStorage.setItem('praise_level', level);
            localStorage.setItem('praise_level_name', levelText);
            
            // ÊòæÁ§∫ÊÑüË∞¢Ê∂àÊÅØ
            showToast(`ÊÑüË∞¢ÊÇ®ÁöÑ${levelText}ËØÑ‰ª∑ÔºÅÊàë‰ª¨‰ºöÁªßÁª≠Âä™ÂäõÊèê‰æõÊõ¥Â•ΩÁöÑÊúçÂä°„ÄÇ`, 'success');
            
            // ÂÖ≥Èó≠ÁÇπËµûÂºπÁ™ó
            closePraiseModal();
            
            // ËÆ∞ÂΩïÊó•Âøó
            console.log(`Áî®Êà∑ÁÇπËµûÁ≠âÁ∫ß: ${level} (${levelText})`);
            
            // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†ÂÖ∂‰ªñÈÄªËæëÔºåÊØîÂ¶ÇÂèëÈÄÅÂà∞ÊúçÂä°Âô®
        }

        // ÂÖ≥Èó≠ÁÇπËµûÂºπÁ™ó
        function closePraiseModal() {
            const modal = document.querySelector('.praise-modal');
            if (modal) {
                modal.remove();
            }
        }

        // ÊòæÁ§∫ÂèçÈ¶àÂºπÁ™ó
        function showFeedbackModal(type = '') {
            const modal = document.getElementById('feedbackModal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('show');
                
                // Â¶ÇÊûúÊåáÂÆö‰∫ÜÁ±ªÂûãÔºåÈ¢ÑÈÄâÂèçÈ¶àÁ±ªÂûã
                if (type && type !== '') {
                    const typeSelect = document.getElementById('modalFeedbackType');
                    if (typeSelect) {
                        typeSelect.value = type;
                    }
                    
                    // Ê†πÊçÆÁ±ªÂûãËÆæÁΩÆ‰∏çÂêåÁöÑÂç†‰ΩçÁ¨¶ÊñáÊú¨
                    const messageTextarea = document.getElementById('modalFeedbackMessage');
                    if (messageTextarea) {
                        const placeholders = {
                            'praise': 'ËØ∑ÂëäËØâÊàë‰ª¨ÊÇ®ÂñúÊ¨¢Ëøô‰∏™ÊµãËØïÁöÑÂì™‰∫õÊñπÈù¢ÔºåÊàñËÄÖÊúâ‰ªÄ‰πàÁâπÂà´Â•ΩÁöÑ‰ΩìÈ™å...',
                            'improvement': 'ËØ∑ËØ¶ÁªÜÊèèËø∞ÊÇ®Â∏åÊúõÊîπËøõÁöÑÂäüËÉΩÔºåÂåÖÊã¨ÂÖ∑‰ΩìÁöÑÊîπËøõÊÉ≥Ê≥ïÂíåÊúüÊúõÁöÑÊïàÊûú...',
                            'bug': 'ËØ∑ËØ¶ÁªÜÊèèËø∞ÊÇ®ÈÅáÂà∞ÁöÑÈóÆÈ¢òÔºåÂåÖÊã¨Êìç‰ΩúÊ≠•È™§„ÄÅÈîôËØØÁé∞Ë±°ÂíåÊúüÊúõÁöÑÊ≠£Á°ÆÁªìÊûú...',
                            'other': 'ËØ∑ËØ¶ÁªÜÊèèËø∞ÊÇ®ÁöÑÂÖ∂‰ªñÂèçÈ¶àÂÜÖÂÆπ...'
                        };
                        messageTextarea.placeholder = placeholders[type] || 'ËØ∑ËØ¶ÁªÜÊèèËø∞ÊÇ®ÁöÑÊÑèËßÅÊàñÂª∫ËÆÆ...';
                    }
                }
                
                // Ê∑ªÂä†ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ÂºπÁ™óÁöÑÂäüËÉΩ
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeFeedbackModal();
                    }
                });
            }
        }

        // ÂÖ≥Èó≠ÂèçÈ¶àÂºπÁ™ó
        function closeFeedbackModal() {
            const modal = document.getElementById('feedbackModal');
            if (modal) {
                modal.classList.remove('show');
                modal.classList.add('hidden');
            }
        }

        // ÊòæÁ§∫ÂäüËÉΩ‰ø°ÊÅØ
        function showFeatureInfo(featureType) {
            const featureInfo = {
                'mbti': {
                    title: 'üß† MBTI‰∫∫Ê†ºÊµãËØï',
                    description: 'Âü∫‰∫éËç£Ê†ºÁ±ªÂûãÂ≠¶ÁêÜËÆ∫ÁöÑ16Áßç‰∫∫Ê†ºÁ±ªÂûãÊµãËØïÔºåÂ∏ÆÂä©‰Ω†‰∫ÜËß£Ëá™Â∑±ÁöÑÊÄßÊ†ºÂÅèÂ•ΩÂíå‰ºòÂäø„ÄÇ',
                    status: 'ÂΩìÂâçÂèØÁî®',
                    action: () => startTest()
                },
                'zodiac': {
                    title: '‚ôà ÊòüÂ∫ßÊÄßÊ†ºÊµãËØï',
                    description: 'Êé¢Á¥¢‰Ω†ÁöÑÊòüÂ∫ßÁâπË¥®„ÄÅÊÄßÊ†ºÂÄæÂêëÂíåÊΩúÂú®Â§©ËµãÔºå‰∫ÜËß£ÊòüÂ∫ßÂ¶Ç‰ΩïÂΩ±Âìç‰Ω†ÁöÑ‰∏™ÊÄß„ÄÇ',
                    status: 'Âç≥Â∞ÜÊé®Âá∫',
                    action: () => showToast('ÊòüÂ∫ßÊµãËØïÂäüËÉΩÂç≥Â∞ÜÊé®Âá∫ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ', 'info')
                },
                'bazi': {
                    title: 'üìÖ ÂÖ´Â≠óÁÆóÂëΩ',
                    description: '‰º†ÁªüÂëΩÁêÜÂ≠¶ÊµãËØïÔºåÈÄöËøáÂá∫ÁîüÂπ¥ÊúàÊó•Êó∂Ëß£ËØª‰Ω†ÁöÑÂëΩËøêÂØÜÁ†ÅÂíå‰∫∫ÁîüËΩ®Ëøπ„ÄÇ',
                    status: 'Âç≥Â∞ÜÊé®Âá∫',
                    action: () => showToast('ÂÖ´Â≠óÁÆóÂëΩÂäüËÉΩÂç≥Â∞ÜÊé®Âá∫ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ', 'info')
                },
                'tarot': {
                    title: 'üîÆ Â°îÁΩóÁâåÊµãËØï',
                    description: 'Á•ûÁßòÁöÑÂ°îÁΩóÁâåÊµãËØïÔºåÊè≠Á§∫‰Ω†ÁöÑÂÜÖÂøÉ‰∏ñÁïå„ÄÅÊΩúÂú®ËÉΩÂäõÂíåÊú™Êù•ÂèëÂ±ïÊñπÂêë„ÄÇ',
                    status: 'ÂΩìÂâçÂèØÁî®',
                    action: () => window.location.href = 'tarot-test.html'
                },
                'numerology': {
                    title: 'üî¢ Êï∞Â≠óÂëΩÁêÜ',
                    description: 'ÈÄöËøáÊï∞Â≠óËß£ËØª‰Ω†ÁöÑÊÄßÊ†ºÁâπÂæÅ„ÄÅÂ§©ËµãÊâçËÉΩÂíå‰∫∫Áîü‰ΩøÂëΩ„ÄÇ',
                    status: 'ÂΩìÂâçÂèØÁî®',
                    action: () => window.location.href = 'test-numerology.html'
                },
                'chinese-zodiac': {
                    title: 'üêâ ÁîüËÇñÊµãËØï',
                    description: 'ÂçÅ‰∫åÁîüËÇñÊÄßÊ†ºÁâπÂæÅÊ∑±Â∫¶Ëß£ÊûêÔºå‰∫ÜËß£‰Ω†ÁöÑÁîüËÇñÁâπË¥®ÂíåÊΩúÂú®‰ºòÂäø„ÄÇ',
                    status: 'ÂΩìÂâçÂèØÁî®',
                    action: () => window.location.href = 'chinese-zodiac-test.html'
                }
            };
            
            const feature = featureInfo[featureType];
            if (feature) {
                // ÊòæÁ§∫ÂäüËÉΩËØ¶ÊÉÖÂºπÁ™ó
                const modal = document.createElement('div');
                modal.className = 'feature-modal';
                
                modal.innerHTML = `
                    <div class="feature-modal-content">
                        <div class="feature-modal-header">
                            <h3>${feature.title}</h3>
                            <button class="close-btn" onclick="this.closest('.feature-modal').remove()">&times;</button>
                        </div>
                        <div class="feature-modal-body">
                            <p>${feature.description}</p>
                            <div class="feature-status-badge ${feature.status === 'ÂΩìÂâçÂèØÁî®' ? 'active' : 'coming-soon'}">
                                ${feature.status}
                            </div>
                            <div class="feature-actions">
                                <button class="btn" onclick="this.closest('.feature-modal').remove(); ${feature.status === 'ÂΩìÂâçÂèØÁî®' ? 'executeFeatureAction()' : 'showToast(\'ÂäüËÉΩÂç≥Â∞ÜÊé®Âá∫ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ\', \'info\')'}">
                                    ${feature.status === 'ÂΩìÂâçÂèØÁî®' ? 'ÂºÄÂßãÊµãËØï' : 'ÊàëÁü•ÈÅì‰∫Ü'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                // Ê∑ªÂä†ÂÖ®Â±ÄÁöÑexecuteFeatureActionÂáΩÊï∞
                window.executeFeatureAction = () => {
                    if (typeof feature.action === 'function') {
                        feature.action();
                    }
                };
                
                document.body.appendChild(modal);
                
                // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ÂºπÁ™ó
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
            }
        }

        // Â§ÑÁêÜÂèçÈ¶àË°®ÂçïÊèê‰∫§
        function handleFeedbackSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const feedbackData = {
                name: formData.get('name'),
                email: formData.get('email'),
                type: formData.get('type'),
                message: formData.get('message'),
                agreePrivacy: formData.get('agreePrivacy')
            };
            
            // È™åËØÅÂøÖÂ°´Â≠óÊÆµ
            if (!feedbackData.name || !feedbackData.email || !feedbackData.type || !feedbackData.message || !feedbackData.agreePrivacy) {
                showToast('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ', 'error');
                return;
            }
            
            // È™åËØÅÈÇÆÁÆ±Ê†ºÂºè
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(feedbackData.email)) {
                showToast('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ', 'error');
                return;
            }
            
            // Ê®°ÊãüÊèê‰∫§ÊàêÂäü
            console.log('ÂèçÈ¶àÊï∞ÊçÆ:', feedbackData);
            showToast('ÊÑüË∞¢ÊÇ®ÁöÑÂèçÈ¶àÔºÅÊàë‰ª¨‰ºöËÆ§ÁúüÂ§ÑÁêÜÊÇ®ÁöÑÊÑèËßÅ„ÄÇ', 'success');
            
            // ÈáçÁΩÆË°®Âçï
            event.target.reset();
            
            // ÂÖ≥Èó≠ÂºπÁ™ó
            closeFeedbackModal();
        }

        // ÂàáÊç¢‰∏ªÈ¢ò
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            body.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const btn = event.target;
            if (newTheme === 'dark') {
                btn.innerHTML = '‚òÄÔ∏è ÊµÖËâ≤Ê®°Âºè';
                showToast('Â∑≤ÂàáÊç¢Âà∞Ê∑±Ëâ≤Ê®°Âºè', 'success');
            } else {
                btn.innerHTML = 'üåô Ê∑±Ëâ≤Ê®°Âºè';
                showToast('Â∑≤ÂàáÊç¢Âà∞ÊµÖËâ≤Ê®°Âºè', 'success');
            }
        }

        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
        window.addEventListener('load', () => {
            console.log('È°µÈù¢Âä†ËΩΩÂÆåÊàêÔºåÂºÄÂßãÂàùÂßãÂåñ...');
            

            

            
            console.log('È°µÈù¢ÂàùÂßãÂåñÂÆåÊàê');
        });
        

            
            // Êõ¥Êñ∞ËØ≠Ë®ÄÊåâÈíÆÁä∂ÊÄÅ

            
            // Â∫îÁî®ËØ≠Ë®Ä

            

            

        
        // ÊòæÁ§∫ÊèêÁ§∫Ê∂àÊÅØ
        function showToast(message, type = 'info') {
            // ÁßªÈô§Áé∞ÊúâÁöÑÊèêÁ§∫
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            
            // ËÆæÁΩÆÊ†∑Âºè
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#667eea'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-weight: 500;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            // ÊòæÁ§∫Âä®Áîª
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 100);
            
            // Ëá™Âä®ÈöêËóè
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.remove();
                    }
                }, 300);
            }, 3000);
        }

        // ===== ÊòüÂ∫ß+MBTIËûçÂêàÊµãËØïÁ≥ªÁªü =====

        // ÊòüÂ∫ßÊï∞ÊçÆÂ∫ì
        const zodiacDatabase = {
            aries: { name: 'ÁôΩÁæäÂ∫ß', element: 'fire', traits: ['ÂãáÊï¢', 'ÁÉ≠ÊÉÖ', 'ÂÜ≤Âä®', 'È¢ÜÂØºÂäõ'] },
            taurus: { name: 'ÈáëÁâõÂ∫ß', element: 'earth', traits: ['Á®≥Èáç', 'Âä°ÂÆû', 'Âõ∫Êâß', 'Âø†ËØö'] },
            gemini: { name: 'ÂèåÂ≠êÂ∫ß', element: 'air', traits: ['Â•ΩÂ•á', 'ÁÅµÊ¥ª', 'Ê≤üÈÄö', 'Â§öÂèò'] },
            cancer: { name: 'Â∑®ËüπÂ∫ß', element: 'water', traits: ['ÊïèÊÑü', '‰øùÊä§', 'ÂÆ∂Â∫≠', 'Áõ¥Ëßâ'] },
            leo: { name: 'ÁãÆÂ≠êÂ∫ß', element: 'fire', traits: ['Ëá™‰ø°', 'ÊÖ∑ÊÖ®', 'ÊàèÂâßÊÄß', 'È¢ÜÂØºÂäõ'] },
            virgo: { name: 'Â§ÑÂ•≥Â∫ß', element: 'earth', traits: ['ÂÆåÁæé‰∏ª‰πâ', 'ÂàÜÊûê', 'ÊúçÂä°', 'Ë∞¶Ëôö'] },
            libra: { name: 'Â§©Áß§Â∫ß', element: 'air', traits: ['Âπ≥Ë°°', 'ÂíåË∞ê', 'Â§ñ‰∫§', 'ÂÆ°Áæé'] },
            scorpio: { name: 'Â§©ËùéÂ∫ß', element: 'water', traits: ['Á•ûÁßò', 'Ê∑±Â∫¶', 'Ê¥ûÂØüÂäõ', 'ÊøÄÊÉÖ'] },
            sagittarius: { name: 'Â∞ÑÊâãÂ∫ß', element: 'fire', traits: ['‰πêËßÇ', 'ÂÜíÈô©', 'Âì≤Â≠¶', 'Ëá™Áî±'] },
            capricorn: { name: 'Êë©ÁæØÂ∫ß', element: 'earth', traits: ['ÈáéÂøÉ', 'Ë¥£‰ªª', 'ËÄêÂøÉ', 'ÂÆûÁî®'] },
            aquarius: { name: 'Ê∞¥Áì∂Â∫ß', element: 'air', traits: ['ÂàõÊñ∞', 'Áã¨Á´ã', '‰∫∫ÈÅì‰∏ª‰πâ', 'ÂèõÈÄÜ'] },
            pisces: { name: 'ÂèåÈ±ºÂ∫ß', element: 'water', traits: ['ÂêåÊÉÖÂøÉ', 'Áõ¥Ëßâ', 'Ëâ∫ÊúØ', 'Ê¢¶ÊÉ≥'] }
        };

        // ÂÖÉÁ¥†Á≥ªÁªü
        const elementSystem = {
            fire: { name: 'ÁÅ´Ë±°', traits: ['ÁÉ≠ÊÉÖ', 'Ê¥ªÂäõ', 'ÂàõÈÄ†Âäõ', 'È¢ÜÂØºÂäõ'] },
            earth: { name: 'ÂúüË±°', traits: ['Á®≥Èáç', 'Âä°ÂÆû', 'ÂèØÈù†', 'ËÄêÂøÉ'] },
            air: { name: 'È£éË±°', traits: ['Êô∫ÊÖß', 'Ê≤üÈÄö', 'ÁÅµÊ¥ª', 'ÂàõÊñ∞'] },
            water: { name: 'Ê∞¥Ë±°', traits: ['ÊÉÖÊÑü', 'Áõ¥Ëßâ', 'ÂêåÊÉÖÂøÉ', 'Ê∑±Â∫¶'] }
        };

        // ÊµãËØïÈ¢òÁõÆ
        const zodiacMBTIQuestions = {
            mbti: [
                {
                    question: "Âú®Á§æ‰∫§Âú∫Âêà‰∏≠Ôºå‰Ω†ÈÄöÂ∏∏Ôºö",
                    options: [
                        { text: "‰∏ªÂä®‰∏é‰ªñ‰∫∫‰∫§Ë∞àÔºå‰∫´ÂèóÊàê‰∏∫ÁÑ¶ÁÇπ", value: 'E', category: 'EI' },
                        { text: "ÂÄæÂêë‰∫éËßÇÂØü‰ªñ‰∫∫ÔºåÂú®ÁÜüÊÇâÁöÑÁéØÂ¢É‰∏≠ÊâçÊ¥ªË∑É", value: 'I', category: 'EI' }
                    ]
                },
                {
                    question: "‰Ω†Êõ¥ÂÄæÂêë‰∫éÔºö",
                    options: [
                        { text: "ÂÖ≥Ê≥®ÂÖ∑‰ΩìÁªÜËäÇÂíåÁé∞ÂÆûÊÉÖÂÜµ", value: 'S', category: 'SN' },
                        { text: "ÊÄùËÄÉÂèØËÉΩÊÄßÂíåÊú™Êù•Ë∂ãÂäø", value: 'N', category: 'SN' }
                    ]
                },
                {
                    question: "ÂΩì‰Ω†ÈúÄË¶ÅÂÅöÂÜ≥ÂÆöÊó∂Ôºå‰Ω†Êõ¥‰æùËµñÔºö",
                    options: [
                        { text: "ÈÄªËæëÂàÜÊûêÂíåÂÆ¢ËßÇ‰∫ãÂÆû", value: 'T', category: 'TF' },
                        { text: "‰∏™‰∫∫‰ª∑ÂÄºËßÇÂíåÊÑüÂèó", value: 'F', category: 'TF' }
                    ]
                },
                {
                    question: "‰Ω†Êõ¥ÂñúÊ¨¢ÁöÑÂ∑•‰ΩúÁéØÂ¢ÉÊòØÔºö",
                    options: [
                        { text: "ÊúâÊòéÁ°ÆÁöÑÁªìÊûÑÂíåËÆ°Âàí", value: 'J', category: 'JP' },
                        { text: "ÁÅµÊ¥ªÂ§öÂèòÔºåÂèØ‰ª•ÈöèÊú∫Â∫îÂèò", value: 'P', category: 'JP' }
                    ]
                }
            ],
            zodiac: [
                {
                    question: "Èù¢ÂØπÊåëÊàòÊó∂Ôºå‰Ω†ÈÄöÂ∏∏‰ºöÔºö",
                    options: [
                        { text: "ÂÉèÁÅ´‰∏ÄÊ†∑Áõ¥Êé•Èù¢ÂØπÔºåÂÖÖÊª°ÊøÄÊÉÖÂíåÂãáÊ∞î", element: 'fire' },
                        { text: "ÂÉèÂúü‰∏ÄÊ†∑Á®≥ÈáçÂàÜÊûêÔºåÂä°ÂÆûÂèØÈù†Âú∞Â§ÑÁêÜ", element: 'earth' },
                        { text: "ÂÉèÈ£é‰∏ÄÊ†∑ÁÅµÊ¥ªÊÄùËÄÉÔºåÂØªÊâæÂàõÊñ∞ÁöÑËß£ÂÜ≥ÊñπÊ°à", element: 'air' },
                        { text: "ÂÉèÊ∞¥‰∏ÄÊ†∑Ê∑±ÂÖ•ÊÑüÂèóÔºå‰æùÈù†Áõ¥ËßâÂíåÂêåÁêÜÂøÉ", element: 'water' }
                    ]
                },
                {
                    question: "Âú®Âõ¢Èòü‰∏≠Ôºå‰Ω†Êõ¥ÂÄæÂêë‰∫éÊâÆÊºîÔºö",
                    options: [
                        { text: "ÂºÄÂàõËÄÖÔºö‰∏ªÂä®ÂèëËµ∑Êñ∞È°πÁõÆÔºåÂ∏¶È¢ÜÂõ¢ÈòüÂâçËøõ", element: 'fire' },
                        { text: "Á®≥ÂÆöËÄÖÔºö‰øùÊåÅÈ°πÁõÆÁ®≥ÂÆöÔºåÁ°Æ‰øùË¥®ÈáèËææÊ†á", element: 'earth' },
                        { text: "ÂçèË∞ÉËÄÖÔºöÂπ≥Ë°°ÂêÑÊñπÈúÄÊ±ÇÔºå‰øÉËøõÂõ¢ÈòüÂíåË∞ê", element: 'air' },
                        { text: "ÊîØÊåÅËÄÖÔºöÂÖ≥ÂøÉÂõ¢ÈòüÊàêÂëòÔºåÊèê‰æõÊÉÖÊÑüÊîØÊåÅ", element: 'water' }
                    ]
                }
            ],
            fusion: [
                {
                    question: "ÂΩì‰Ω†Âú®Âõ¢Èòü‰∏≠ÈÅáÂà∞ÂÜ≤Á™ÅÊó∂Ôºå‰Ω†‰ºöÔºö",
                    options: [
                        { text: "ÂÉèÁÅ´Ë±°ÊòüÂ∫ß‰∏ÄÊ†∑Áõ¥Êé•Ë°®ËææÔºåÂÉèEÂûã‰∫∫‰∏ÄÊ†∑‰∏ªÂä®Ê≤üÈÄö", element: 'fire', mbti: 'E' },
                        { text: "ÂÉèÂúüË±°ÊòüÂ∫ß‰∏ÄÊ†∑ÂÜ∑ÈùôÂàÜÊûêÔºåÂÉèTÂûã‰∫∫‰∏ÄÊ†∑ÁêÜÊÄßÂ§ÑÁêÜ", element: 'earth', mbti: 'T' },
                        { text: "ÂÉèÈ£éË±°ÊòüÂ∫ß‰∏ÄÊ†∑ÂØªÊ±ÇÂπ≥Ë°°ÔºåÂÉèFÂûã‰∫∫‰∏ÄÊ†∑ËÄÉËôëÂêÑÊñπÊÑüÂèó", element: 'air', mbti: 'F' },
                        { text: "ÂÉèÊ∞¥Ë±°ÊòüÂ∫ß‰∏ÄÊ†∑Ê∑±ÂÖ•ÊÑüÂèóÔºåÂÉèIÂûã‰∫∫‰∏ÄÊ†∑ÂÜÖÁúÅÊÄùËÄÉ", element: 'water', mbti: 'I' }
                    ]
                }
            ]
        };

        // ÂÖ®Â±ÄÂèòÈáè - ‰ΩøÁî®varÁ°Æ‰øùÂèòÈáèÊèêÂçá
        var zodiacTestAnswers = {
            basic: {},
            mbti: {},
            zodiac: {},
            fusion: {}
        };

        // ÂÖ®Â±ÄÂèòÈáèÂ£∞Êòé - Á°Æ‰øùÂú®‰ªª‰ΩïÂáΩÊï∞Ë∞ÉÁî®ÂâçÂ∞±Â≠òÂú®
        var zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
        console.log('ÂÖ®Â±ÄzodiacTestAnswersÂèòÈáèÂ∑≤Â£∞Êòé');
        
        // ÊµãËØïÂºπÁ™óÂäüËÉΩ
        function testZodiacFunction() {
            console.log('=== ÊµãËØïÂºπÁ™óÂäüËÉΩ ===');
            alert('ÊµãËØïÊåâÈíÆË¢´ÁÇπÂáª‰∫ÜÔºÅ');
            
            // Ê£ÄÊü•ÂºπÁ™óÂÖÉÁ¥†
            const modal = document.getElementById('zodiacMBTIModal');
            if (modal) {
                console.log('ÂºπÁ™óÂÖÉÁ¥†Â≠òÂú®:', modal);
                console.log('ÂºπÁ™óÂΩìÂâçÁ±ªÂêç:', modal.className);
                console.log('ÂºπÁ™óÊòØÂê¶ÈöêËóè:', modal.classList.contains('hidden'));
                
                // Â∞ùËØïÊòæÁ§∫ÂºπÁ™ó
                modal.classList.remove('hidden');
                console.log('hiddenÁ±ªÂ∑≤ÁßªÈô§ÔºåÂºπÁ™óÂ∫îËØ•ÊòæÁ§∫');
                
                // Ê£ÄÊü•ÂºπÁ™óÊòØÂê¶ÁúüÁöÑÊòæÁ§∫
                setTimeout(() => {
                    console.log('ÂºπÁ™óÂΩìÂâçÁ±ªÂêç:', modal.className);
                    console.log('ÂºπÁ™óÊòØÂê¶ÈöêËóè:', modal.classList.contains('hidden'));
                    console.log('ÂºπÁ™óËÆ°ÁÆóÊ†∑Âºè:', window.getComputedStyle(modal).display);
                }, 100);
                
            } else {
                console.error('ÂºπÁ™óÂÖÉÁ¥†‰∏çÂ≠òÂú®ÔºÅ');
                alert('ÂºπÁ™óÂÖÉÁ¥†‰∏çÂ≠òÂú®ÔºÅ');
            }
        }
        // ÊµãËØïÂºÄÂßãÊµãËØïÊåâÈíÆÂäüËÉΩ
        function testStartZodiacTest() {
            console.log('=== ÊµãËØïÂºÄÂßãÊµãËØïÊåâÈíÆÂäüËÉΩ ===');
            
            // 1. Ê£ÄÊü•ÂºπÁ™óÊòØÂê¶ÊòæÁ§∫
            const modal = document.getElementById('zodiacMBTIModal');
            if (!modal) {
                alert('ÂºπÁ™óÂÖÉÁ¥†‰∏çÂ≠òÂú®ÔºÅ');
                return;
            }
            
            if (modal.classList.contains('hidden')) {
                alert('ÂºπÁ™óÊú™ÊòæÁ§∫ÔºåËØ∑ÂÖàÁÇπÂáªÊòüÂ∫ßÂç°ÁâáÔºÅ');
                return;
            }
            
            // 2. Ê£ÄÊü•ËæìÂÖ•ÂÖÉÁ¥†
            const birthDate = document.getElementById('birthDate');
            const birthTime = document.getElementById('birthTime');
            const birthPlace = document.getElementById('birthPlace');
            
            console.log('ËæìÂÖ•ÂÖÉÁ¥†Ê£ÄÊü•:', { birthDate, birthTime, birthPlace });
            
            if (!birthDate || !birthTime || !birthPlace) {
                alert('ËæìÂÖ•ÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºÅ');
                return;
            }
            
            // 3. Ê£ÄÊü•ËæìÂÖ•ÂÄº
            const birthDateValue = birthDate.value;
            const birthTimeValue = birthTime.value;
            const birthPlaceValue = birthPlace.value;
            
            console.log('ËæìÂÖ•ÂÄºÊ£ÄÊü•:', { birthDateValue, birthTimeValue, birthPlaceValue });
            
            // 4. Ê®°ÊãüÂ°´ÂÜô‰ø°ÊÅØ
            if (!birthDateValue) birthDate.value = '1990-01-01';
            if (!birthTimeValue) birthTime.value = '12:00';
            if (!birthPlaceValue) birthPlace.value = 'Âåó‰∫¨';
            
            // 5. Áõ¥Êé•Ë∞ÉÁî®ÂáΩÊï∞
            alert('ÂáÜÂ§áË∞ÉÁî®startZodiacTestÂáΩÊï∞...');
            startZodiacTest();
        }

        // ÊµãËØïÊ®°ÊÄÅÊ°ÜÂÖÉÁ¥†
        function testModalElements() {
            console.log('=== ÊµãËØïÊ®°ÊÄÅÊ°ÜÂÖÉÁ¥† ===');
            
            const modal = document.getElementById('zodiacMBTIModal');
            if (!modal) {
                alert('ÂºπÁ™óÂÖÉÁ¥†‰∏çÂ≠òÂú®ÔºÅ');
                return;
            }
            
            // Ê£ÄÊü•ÊâÄÊúâÁõ∏ÂÖ≥ÂÖÉÁ¥†
            const elements = {
                modal: modal,
                birthDate: document.getElementById('birthDate'),
                birthTime: document.getElementById('birthTime'),
                birthPlace: document.getElementById('birthPlace'),
                startTestBtn: document.getElementById('startTestBtn'),
                mbtiSection: document.getElementById('mbtiSection'),
                zodiacSection: document.getElementById('zodiacSection'),
                fusionSection: document.getElementById('fusionSection')
            };
            
            console.log('ÂÖÉÁ¥†Ê£ÄÊü•ÁªìÊûú:', elements);
            
            let result = 'Ê®°ÊÄÅÊ°ÜÂÖÉÁ¥†Ê£ÄÊü•ÁªìÊûúÔºö\n\n';
            for (const [name, element] of Object.entries(elements)) {
                if (element) {
                    result += `‚úÖ ${name}: Â≠òÂú®\n`;
                } else {
                    result += `‚ùå ${name}: ‰∏çÂ≠òÂú®\n`;
                }
            }
            
            alert(result);
        }

        // ÂºÄÂßãÊòüÂ∫ß+MBTIËûçÂêàÊµãËØï
        function startZodiacMBTITest() {
            console.log('=== startZodiacMBTITest ÂáΩÊï∞Ë¢´Ë∞ÉÁî®ÔºåÊ®°Âºè: Á´ãÂç≥‰ΩìÈ™å ===');
            
            try {
                // Êü•ÊâæÂºπÁ™óÂÖÉÁ¥†
                const modal = document.getElementById('zodiacMBTIModal');
                if (!modal) {
                    console.error('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞: zodiacMBTIModal');
                    alert('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºÅËØ∑Ê£ÄÊü•HTMLÁªìÊûÑ');
                    return;
                }
                console.log('ÂºπÁ™óÂÖÉÁ¥†ÊâæÂà∞:', modal);
                
                // ÊòæÁ§∫ÊµãËØïÂºπÁ™ó
                modal.classList.remove('hidden');
                console.log('ÂºπÁ™óÂ∑≤ÊòæÁ§∫ÔºåhiddenÁ±ªÂ∑≤ÁßªÈô§');
                
                // ÈöêËóèÈ¶ñÈ°µÂÖÉÁ¥†Ôºå‰∏ìÊ≥®‰∫éÊµãËØï
                document.getElementById('featuresSection').classList.add('hidden');
                document.getElementById('mainHeader').classList.add('hidden');
                
                // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫‰ªäÂ§©
                const today = new Date();
                const year = today.getFullYear();
                const month = String(today.getMonth() + 1).padStart(2, '0');
                const day = String(today.getDate()).padStart(2, '0');
                
                const birthDateInput = document.getElementById('birthDate');
                if (birthDateInput) {
                    birthDateInput.value = `${year}-${month}-${day}`;
                    console.log('Âá∫ÁîüÊó•ÊúüÂ∑≤ËÆæÁΩÆ:', birthDateInput.value);
                } else {
                    console.error('Âá∫ÁîüÊó•ÊúüËæìÂÖ•Ê°ÜÊú™ÊâæÂà∞');
                }
                
                // ËÆæÁΩÆÈªòËÆ§Êó∂Èó¥‰∏∫ÂΩìÂâçÊó∂Èó¥
                const hours = String(today.getHours()).padStart(2, '0');
                const minutes = String(today.getMinutes()).padStart(2, '0');
                
                const birthTimeInput = document.getElementById('birthTime');
                if (birthTimeInput) {
                    birthTimeInput.value = `${hours}:${minutes}`;
                    console.log('Âá∫ÁîüÊó∂Èó¥Â∑≤ËÆæÁΩÆ:', birthTimeInput.value);
                } else {
                    console.error('Âá∫ÁîüÊó∂Èó¥ËæìÂÖ•Ê°ÜÊú™ÊâæÂà∞');
                }
                
                // ÈáçÁΩÆÊµãËØïÁä∂ÊÄÅ
                restartZodiacTest();
                console.log('ÊµãËØïÁä∂ÊÄÅÂ∑≤ÈáçÁΩÆ');
                
                // ËÆæÁΩÆ‰∏∫Á´ãÂç≥‰ΩìÈ™åÊ®°ÂºèÔºöÊòæÁ§∫ÊµãËØïÈ¢òÁõÆ
                const startTestBtn = document.getElementById('startTestBtn');
                if (startTestBtn) {
                    startTestBtn.textContent = 'ÂºÄÂßãÊµãËØï';
                    startTestBtn.onclick = function() {
                        startZodiacTestExperience();
                    };
                    console.log('ËÆæÁΩÆ‰∏∫Á´ãÂç≥‰ΩìÈ™åÊ®°Âºè');
                }
                
            } catch (error) {
                console.error('startZodiacMBTITest ÂáΩÊï∞ÊâßË°åÂá∫Èîô:', error);
                alert('ÂáΩÊï∞ÊâßË°åÂá∫Èîô: ' + error.message);
            }
        }

        // ÂàùÂßãÂåñÊòüÂ∫ß+MBTIÊµãËØïÁõ∏ÂÖ≥ÂèòÈáè
        function initZodiacTestVariables() {
            console.log('ÂàùÂßãÂåñÊòüÂ∫ß+MBTIÊµãËØïÂèòÈáè...');
            
            try {
                // Á°Æ‰øùzodiacTestAnswersÂèòÈáèÂ≠òÂú®
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('zodiacTestAnswersÊú™ÂÆö‰πâÔºåÊ≠£Âú®ÂàõÂª∫...');
                    window.zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                } else {
                    console.log('zodiacTestAnswersÂ∑≤Â≠òÂú®ÔºåÈáçÁΩÆ‰∏∫ÂàùÂßãÁä∂ÊÄÅ');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                }
                
                console.log('zodiacTestAnswersÂàùÂßãÂåñÂÆåÊàê:', zodiacTestAnswers);
            } catch (error) {
                console.error('ÂàùÂßãÂåñzodiacTestAnswersÊó∂Âá∫Èîô:', error);
                // Â¶ÇÊûúÂá∫ÈîôÔºåÂ∞ùËØïÂú®ÂÖ®Â±Ä‰ΩúÁî®ÂüüÂàõÂª∫
                try {
                    window.zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                    console.log('Âú®ÂÖ®Â±Ä‰ΩúÁî®ÂüüÂàõÂª∫zodiacTestAnswersÊàêÂäü');
                } catch (e) {
                    console.error('Âú®ÂÖ®Â±Ä‰ΩúÁî®ÂüüÂàõÂª∫zodiacTestAnswersÂ§±Ë¥•:', e);
                }
            }
        }

        // ÊµãËØïÊï∞ÊçÆ‰øùÂ≠òÂäüËÉΩ
        function testDataSave() {
            console.log('=== ÊµãËØïÊï∞ÊçÆ‰øùÂ≠òÂäüËÉΩ ===');
            
            try {
                // Ê®°ÊãüÊï∞ÊçÆ
                const testData = {
                    birthDate: '1990-01-01',
                    birthTime: '12:00',
                    birthPlace: 'ÊµãËØïÂüéÂ∏Ç'
                };
                
                console.log('ÊµãËØïÊï∞ÊçÆ:', testData);
                
                // Á°Æ‰øùÂèòÈáèÂ≠òÂú® - Â§öÈáçÊ£ÄÊü•
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('zodiacTestAnswersÊú™ÂÆö‰πâÔºåÊ≠£Âú®ÂàõÂª∫...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                }
                
                // Â¶ÇÊûúËøòÊòØundefinedÔºåÂ∞ùËØï‰ªéÂÖ®Â±Ä‰ΩúÁî®ÂüüËé∑Âèñ
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('Â∞ùËØï‰ªéÂÖ®Â±Ä‰ΩúÁî®ÂüüËé∑ÂèñzodiacTestAnswers...');
                    zodiacTestAnswers = window.zodiacTestAnswers;
                }
                
                // Â¶ÇÊûúËøòÊòØundefinedÔºåÂº∫Âà∂ÂàõÂª∫
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('Âº∫Âà∂ÂàõÂª∫zodiacTestAnswers...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                    window.zodiacTestAnswers = zodiacTestAnswers;
                }
                
                console.log('zodiacTestAnswersÁä∂ÊÄÅ:', zodiacTestAnswers);
                
                // ‰øùÂ≠òÊµãËØïÊï∞ÊçÆ
                zodiacTestAnswers.basic = testData;
                console.log('ÊµãËØïÊï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞ÂÜÖÂ≠ò:', zodiacTestAnswers.basic);
                
                // Â∞ùËØï‰øùÂ≠òÂà∞localStorage
                try {
                    localStorage.setItem('zodiacTestData', JSON.stringify(testData));
                    console.log('ÊµãËØïÊï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞localStorage');
                    
                    // È™åËØÅ‰øùÂ≠ò
                    const savedData = localStorage.getItem('zodiacTestData');
                    console.log('‰ªélocalStorageËØªÂèñÁöÑÊï∞ÊçÆ:', savedData);
                    
                    if (savedData) {
                        alert('ÊµãËØïÊï∞ÊçÆ‰øùÂ≠òÊàêÂäüÔºÅ\n\n‰øùÂ≠òÁöÑÊï∞ÊçÆÔºö\n' + savedData);
                    } else {
                        alert('localStorage‰øùÂ≠òÂ§±Ë¥•');
                    }
                    
                } catch (localStorageError) {
                    console.error('localStorageÊµãËØïÂ§±Ë¥•:', localStorageError);
                    alert('localStorageÊµãËØïÂ§±Ë¥•: ' + localStorageError.message);
                }
                
            } catch (error) {
                console.error('ÊµãËØïÊï∞ÊçÆ‰øùÂ≠òÂ§±Ë¥•:', error);
                alert('ÊµãËØïÂ§±Ë¥•: ' + error.message);
            }
        }

        // ËøîÂõûÈ¶ñÈ°µ
        function returnToHomePage() {
            console.log('=== ËøîÂõûÈ¶ñÈ°µÂáΩÊï∞Ë¢´Ë∞ÉÁî® ===');
            
            try {
                // 1. Âº∫Âà∂ÂÖ≥Èó≠ÂºπÁ™ó
                const modal = document.getElementById('zodiacMBTIModal');
                if (modal) {
                    modal.classList.add('hidden');
                    modal.style.display = 'none';
                    modal.style.visibility = 'hidden';
                    modal.style.opacity = '0';
                    modal.style.zIndex = '-1';
                    console.log('ÂºπÁ™óÂ∑≤Âº∫Âà∂ÈöêËóè');
                }
                
                // 2. Âº∫Âà∂ÊòæÁ§∫È¶ñÈ°µÂÖÉÁ¥†
                const welcomeSection = document.getElementById('welcomeSection');
                const featuresSection = document.getElementById('featuresSection');
                const mainHeader = document.getElementById('mainHeader');
                
                if (welcomeSection) {
                    welcomeSection.classList.remove('hidden');
                    welcomeSection.style.display = 'block';
                    welcomeSection.style.visibility = 'visible';
                    welcomeSection.style.opacity = '1';
                    welcomeSection.style.zIndex = 'auto';
                    console.log('Ê¨¢ËøéÈÉ®ÂàÜÂ∑≤Âº∫Âà∂ÊòæÁ§∫');
                }
                
                if (featuresSection) {
                    featuresSection.classList.remove('hidden');
                    featuresSection.style.display = 'block';
                    featuresSection.style.visibility = 'visible';
                    featuresSection.style.opacity = '1';
                    featuresSection.style.zIndex = 'auto';
                    console.log('ÂäüËÉΩÊ†èÁõÆÂ∑≤Âº∫Âà∂ÊòæÁ§∫');
                }
                
                if (mainHeader) {
                    mainHeader.classList.remove('hidden');
                    mainHeader.style.display = 'block';
                    mainHeader.style.visibility = 'visible';
                    mainHeader.style.opacity = '1';
                    mainHeader.style.zIndex = 'auto';
                    console.log('‰∏ªÊ†áÈ¢òÂ∑≤Âº∫Âà∂ÊòæÁ§∫');
                }
                
                // 3. ÊªöÂä®Âà∞È°µÈù¢È°∂ÈÉ®
                window.scrollTo({ top: 0, behavior: 'smooth' });
                console.log('È°µÈù¢Â∑≤ÊªöÂä®Âà∞È°∂ÈÉ®');
                
                // 4. ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
                console.log('=== ËøîÂõûÈ¶ñÈ°µÂÆåÊàê ===');
                
            } catch (error) {
                console.error('ËøîÂõûÈ¶ñÈ°µÊó∂Âá∫Èîô:', error);
                
                // Âç≥‰ΩøÂá∫ÈîôÔºå‰πüË¶ÅÂº∫Âà∂Êìç‰Ωú
                try {
                    const modal = document.getElementById('zodiacMBTIModal');
                    if (modal) {
                        modal.style.display = 'none';
                        modal.style.visibility = 'hidden';
                    }
                    
                    const welcomeSection = document.getElementById('welcomeSection');
                    const featuresSection = document.getElementById('featuresSection');
                    const mainHeader = document.getElementById('mainHeader');
                    
                    if (welcomeSection) welcomeSection.style.display = 'block';
                    if (featuresSection) featuresSection.style.display = 'block';
                    if (mainHeader) mainHeader.style.display = 'block';
                    
                } catch (e) {
                    console.error('Âº∫Âà∂Êìç‰ΩúÂ§±Ë¥•:', e);
                }
            }
        }



        // ÂàùÂßãÂåñÊòüÂ∫ß+MBTIÂºπÁ™óÁöÑÂÖ≥Èó≠ÊåâÈíÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function initZodiacModalCloseButton() {
            console.log('ÂàùÂßãÂåñÊòüÂ∫ß+MBTIÂºπÁ™óÂÖ≥Èó≠ÊåâÈíÆ...');
            
            // Á≠âÂæÖÂºπÁ™óÂÖÉÁ¥†Âä†ËΩΩÂÆåÊàê
            setTimeout(() => {
                const closeBtn = document.querySelector('#zodiacMBTIModal .close-btn');
                if (closeBtn) {
                    console.log('ÊâæÂà∞ÂÖ≥Èó≠ÊåâÈíÆÔºåÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®');
                    
                    // ÁßªÈô§ÂèØËÉΩÂ≠òÂú®ÁöÑonclickÂ±ûÊÄß
                    closeBtn.removeAttribute('onclick');
                    
                    // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
                    closeBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('ÂÖ≥Èó≠ÊåâÈíÆË¢´ÁÇπÂáª');
                        closeZodiacMBTIModal();
                    });
                    
                    console.log('ÂÖ≥Èó≠ÊåâÈíÆ‰∫ã‰ª∂ÁõëÂê¨Âô®Â∑≤Ê∑ªÂä†');
                } else {
                    console.log('ÂÖ≥Èó≠ÊåâÈíÆÊú™ÊâæÂà∞ÔºåÂ∞ÜÂú®Á®çÂêéÈáçËØï');
                    // Â¶ÇÊûúËøòÊ≤°ÊâæÂà∞ÔºåÁ®çÂêéÈáçËØï
                    setTimeout(initZodiacModalCloseButton, 500);
                }
            }, 100);
        }

        // ÂÖ≥Èó≠ÊòüÂ∫ß+MBTIËûçÂêàÊµãËØïÂºπÁ™ó
        function closeZodiacMBTIModal() {
            console.log('=== closeZodiacMBTIModal ÂáΩÊï∞Ë¢´Ë∞ÉÁî® ===');
            
            try {
                // 1. Âº∫Âà∂ÂÖ≥Èó≠ÂºπÁ™ó - ‰ΩøÁî®Â§öÁßçÊñπÊ≥ïÁ°Æ‰øùÂºπÁ™óÂÖ≥Èó≠
                const modal = document.getElementById('zodiacMBTIModal');
                if (modal) {
                    // ÊñπÊ≥ï1: Ê∑ªÂä†hiddenÁ±ª
                    modal.classList.add('hidden');
                    // ÊñπÊ≥ï2: Áõ¥Êé•ËÆæÁΩÆdisplay‰∏∫none
                    modal.style.display = 'none';
                    // ÊñπÊ≥ï3: ËÆæÁΩÆvisibility‰∏∫hidden
                    modal.style.visibility = 'hidden';
                    // ÊñπÊ≥ï4: ËÆæÁΩÆopacity‰∏∫0
                    modal.style.opacity = '0';
                    // ÊñπÊ≥ï5: ËÆæÁΩÆz-index‰∏∫-1
                    modal.style.zIndex = '-1';
                    
                    console.log('ÂºπÁ™óÂ∑≤Âº∫Âà∂ÈöêËóè');
                } else {
                    console.error('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞');
                }
                
                // 2. Âº∫Âà∂ÊòæÁ§∫È¶ñÈ°µÂÖÉÁ¥† - ‰ΩøÁî®Â§öÁßçÊñπÊ≥ïÁ°Æ‰øùÂÖÉÁ¥†ÊòæÁ§∫
                const welcomeSection = document.getElementById('welcomeSection');
                const featuresSection = document.getElementById('featuresSection');
                const mainHeader = document.getElementById('mainHeader');
                
                if (welcomeSection) {
                    welcomeSection.classList.remove('hidden');
                    welcomeSection.style.display = 'block';
                    welcomeSection.style.visibility = 'visible';
                    welcomeSection.style.opacity = '1';
                    welcomeSection.style.zIndex = 'auto';
                    console.log('Ê¨¢ËøéÈÉ®ÂàÜÂ∑≤Âº∫Âà∂ÊòæÁ§∫');
                }
                
                if (featuresSection) {
                    featuresSection.classList.remove('hidden');
                    featuresSection.style.display = 'block';
                    featuresSection.style.visibility = 'visible';
                    featuresSection.style.opacity = '1';
                    featuresSection.style.zIndex = 'auto';
                    console.log('ÂäüËÉΩÊ†èÁõÆÂ∑≤Âº∫Âà∂ÊòæÁ§∫');
                }
                
                if (mainHeader) {
                    mainHeader.classList.remove('hidden');
                    mainHeader.style.display = 'block';
                    mainHeader.style.visibility = 'visible';
                    mainHeader.style.opacity = '1';
                    mainHeader.style.zIndex = 'auto';
                    console.log('‰∏ªÊ†áÈ¢òÂ∑≤Âº∫Âà∂ÊòæÁ§∫');
                }
                
                // 3. ÈáçÁΩÆÊµãËØïÁä∂ÊÄÅ
                try {
                    if (typeof zodiacTestAnswers === 'undefined') {
                        zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                    } else {
                        zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                    }
                    
                    const birthDate = document.getElementById('birthDate');
                    const birthTime = document.getElementById('birthTime');
                    const birthPlace = document.getElementById('birthPlace');
                    
                    if (birthDate) birthDate.value = '';
                    if (birthTime) birthTime.value = '';
                    if (birthPlace) birthPlace.value = '';
                    
                    console.log('ÊµãËØïÁä∂ÊÄÅÂ∑≤ÈáçÁΩÆ');
                } catch (resetError) {
                    console.error('ÈáçÁΩÆÊµãËØïÊó∂Âá∫Èîô:', resetError);
                }
                
                // 4. ÊªöÂä®Âà∞È°µÈù¢È°∂ÈÉ®
                window.scrollTo({ top: 0, behavior: 'smooth' });
                console.log('È°µÈù¢Â∑≤ÊªöÂä®Âà∞È°∂ÈÉ®');
                
                // 5. È™åËØÅÁªìÊûú
                setTimeout(() => {
                    console.log('=== È™åËØÅÂÖ≥Èó≠ÁªìÊûú ===');
                    console.log('ÂºπÁ™óÊòØÂê¶ÈöêËóè:', modal ? modal.classList.contains('hidden') : 'N/A');
                    console.log('Ê¨¢ËøéÈÉ®ÂàÜÊòØÂê¶ÊòæÁ§∫:', welcomeSection ? !welcomeSection.classList.contains('hidden') : 'N/A');
                    console.log('ÂäüËÉΩÊ†èÁõÆÊòØÂê¶ÊòæÁ§∫:', featuresSection ? !featuresSection.classList.contains('hidden') : 'N/A');
                    console.log('‰∏ªÊ†áÈ¢òÊòØÂê¶ÊòæÁ§∫:', mainHeader ? !mainHeader.classList.contains('hidden') : 'N/A');
                }, 100);
                
                console.log('=== ÂÖ≥Èó≠ÂºπÁ™óÂÆåÊàê ===');
                
            } catch (error) {
                console.error('ÂÖ≥Èó≠ÂºπÁ™óÊó∂Âá∫Èîô:', error);
                
                // Âç≥‰ΩøÂá∫ÈîôÔºå‰πüË¶ÅÂº∫Âà∂ÂÖ≥Èó≠ÂºπÁ™ó
                try {
                    const modal = document.getElementById('zodiacMBTIModal');
                    if (modal) {
                        modal.style.display = 'none';
                        modal.style.visibility = 'hidden';
                        modal.style.opacity = '0';
                        modal.style.zIndex = '-1';
                    }
                    
                    // Âº∫Âà∂ÊòæÁ§∫È¶ñÈ°µ
                    const welcomeSection = document.getElementById('welcomeSection');
                    const featuresSection = document.getElementById('featuresSection');
                    const mainHeader = document.getElementById('mainHeader');
                    
                    if (welcomeSection) welcomeSection.style.display = 'block';
                    if (featuresSection) featuresSection.style.display = 'block';
                    if (mainHeader) mainHeader.style.display = 'block';
                    
                } catch (e) {
                    console.error('Âº∫Âà∂Êìç‰ΩúÂ§±Ë¥•:', e);
                }
                
                alert('ÂÖ≥Èó≠ÂºπÁ™óÊó∂Âá∫Èîô: ' + error.message);
            }
        }

        // ÂºÄÂßãÊµãËØï‰ΩìÈ™åÔºàÊòæÁ§∫ÊµãËØïÈ¢òÁõÆÔºâ
        function startZodiacTestExperience() {
            console.log('=== ÂºÄÂßãÊµãËØï‰ΩìÈ™åÔºåÊòæÁ§∫ÊµãËØïÈ¢òÁõÆ ===');
            
            try {
                // Ê£ÄÊü•ÂºπÁ™óÊòØÂê¶Â≠òÂú®
                const modal = document.getElementById('zodiacMBTIModal');
                if (!modal) {
                    console.error('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞: zodiacMBTIModal');
                    alert('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºÅ');
                    return;
                }
                console.log('ÂºπÁ™óÂÖÉÁ¥†ÊâæÂà∞:', modal);
                
                // Ê£ÄÊü•ËæìÂÖ•ÂÖÉÁ¥†
                const birthDate = document.getElementById('birthDate');
                const birthTime = document.getElementById('birthTime');
                const birthPlace = document.getElementById('birthPlace');
                
                if (!birthDate || !birthTime || !birthPlace) {
                    console.error('ËæìÂÖ•ÂÖÉÁ¥†Êú™ÊâæÂà∞');
                    alert('ËæìÂÖ•ÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºÅ');
                    return;
                }
                
                const birthDateValue = birthDate.value;
                const birthTimeValue = birthTime.value;
                const birthPlaceValue = birthPlace.value;

                console.log('Ëé∑ÂèñÂà∞ÁöÑÂÄº:', { birthDateValue, birthTimeValue, birthPlaceValue });

                if (!birthDateValue || !birthTimeValue || !birthPlaceValue) {
                    console.log('‰ø°ÊÅØ‰∏çÂÆåÊï¥ÔºåÊòæÁ§∫ÈîôËØØÊèêÁ§∫');
                    alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´‰ø°ÊÅØ');
                    return;
                }

                // Â≠òÂÇ®Áî®Êà∑ËæìÂÖ•ÁöÑÊï∞ÊçÆ
                console.log('ÂáÜÂ§á‰øùÂ≠òÊï∞ÊçÆ...');
                
                // Á°Æ‰øùÂèòÈáèÂ≠òÂú® - Â§öÈáçÊ£ÄÊü•
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('zodiacTestAnswersÊú™ÂÆö‰πâÔºåÊ≠£Âú®ÂàõÂª∫...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                }
                
                // Â¶ÇÊûúËøòÊòØundefinedÔºåÂ∞ùËØï‰ªéÂÖ®Â±Ä‰ΩúÁî®ÂüüËé∑Âèñ
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('Â∞ùËØï‰ªéÂÖ®Â±Ä‰ΩúÁî®ÂüüËé∑ÂèñzodiacTestAnswers...');
                    zodiacTestAnswers = window.zodiacTestAnswers;
                }
                
                // Â¶ÇÊûúËøòÊòØundefinedÔºåÂº∫Âà∂ÂàõÂª∫
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('Âº∫Âà∂ÂàõÂª∫zodiacTestAnswers...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                    window.zodiacTestAnswers = zodiacTestAnswers;
                }
                
                console.log('zodiacTestAnswersÁä∂ÊÄÅ:', zodiacTestAnswers);
                
                // ‰øùÂ≠òÂü∫Á°ÄÊï∞ÊçÆ
                zodiacTestAnswers.basic = { 
                    birthDate: birthDateValue, 
                    birthTime: birthTimeValue, 
                    birthPlace: birthPlaceValue 
                };
                
                console.log('Êï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞ÂÜÖÂ≠ò:', zodiacTestAnswers.basic);
                
                // Â∞ùËØï‰øùÂ≠òÂà∞localStorage
                try {
                    localStorage.setItem('zodiacTestData', JSON.stringify(zodiacTestAnswers.basic));
                    console.log('Êï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞localStorage');
                } catch (localStorageError) {
                    console.warn('localStorage‰øùÂ≠òÂ§±Ë¥•:', localStorageError);
                    // localStorageÂ§±Ë¥•‰∏çÂΩ±Âìç‰∏ªË¶ÅÂäüËÉΩ
                }
                
                // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                alert('‰ø°ÊÅØÂ∑≤‰øùÂ≠òÔºÅÁé∞Âú®ÂºÄÂßãÊµãËØï...');
                
                // ÊòæÁ§∫MBTIÊµãËØïÈÉ®ÂàÜ
                console.log('ÂáÜÂ§áÊòæÁ§∫MBTIÈÉ®ÂàÜ...');
                showZodiacSection('mbtiSection');
                console.log('ÂáÜÂ§áÊ∏≤ÊüìMBTIÈóÆÈ¢ò...');
                renderZodiacMBTIQuestions();
                console.log('ÊµãËØïÊµÅÁ®ãÂêØÂä®ÂÆåÊàê');
                
            } catch (error) {
                console.error('startZodiacTestExperienceÂáΩÊï∞ÊâßË°åÂá∫Èîô:', error);
                alert('ÂºÄÂßãÊµãËØïÂ§±Ë¥•: ' + error.message);
            }
        }

        // ÂºÄÂßãÊµãËØïÔºà‰øùÂ≠òÊï∞ÊçÆÂπ∂ËøîÂõûÈ¶ñÈ°µÔºâ
        function startZodiacTest() {
            console.log('=== ÂºÄÂßãÊµãËØïÂáΩÊï∞Ë¢´Ë∞ÉÁî® ===');
            
            try {
                // Ê£ÄÊü•ÂºπÁ™óÊòØÂê¶Â≠òÂú®
                const modal = document.getElementById('zodiacMBTIModal');
                if (!modal) {
                    console.error('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞: zodiacMBTIModal');
                    alert('ÂºπÁ™óÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºÅ');
                    return;
                }
                console.log('ÂºπÁ™óÂÖÉÁ¥†ÊâæÂà∞:', modal);
                
                // Ê£ÄÊü•ËæìÂÖ•ÂÖÉÁ¥†
                const birthDate = document.getElementById('birthDate');
                const birthTime = document.getElementById('birthTime');
                const birthPlace = document.getElementById('birthPlace');
                
                if (!birthDate || !birthTime || !birthPlace) {
                    console.error('ËæìÂÖ•ÂÖÉÁ¥†Êú™ÊâæÂà∞');
                    alert('ËæìÂÖ•ÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºÅ');
                    return;
                }
                
                const birthDateValue = birthDate.value;
                const birthTimeValue = birthTime.value;
                const birthPlaceValue = birthPlace.value;

                console.log('Ëé∑ÂèñÂà∞ÁöÑÂÄº:', { birthDateValue, birthTimeValue, birthPlaceValue });

                if (!birthDateValue || !birthTimeValue || !birthPlaceValue) {
                    console.log('‰ø°ÊÅØ‰∏çÂÆåÊï¥ÔºåÊòæÁ§∫ÈîôËØØÊèêÁ§∫');
                    alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´‰ø°ÊÅØ');
                    return;
                }

                // Â≠òÂÇ®Áî®Êà∑ËæìÂÖ•ÁöÑÊï∞ÊçÆ
                console.log('ÂáÜÂ§á‰øùÂ≠òÊï∞ÊçÆ...');
                
                // Á°Æ‰øùÂèòÈáèÂ≠òÂú® - Â§öÈáçÊ£ÄÊü•
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('zodiacTestAnswersÊú™ÂÆö‰πâÔºåÊ≠£Âú®ÂàõÂª∫...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                }
                
                // Â¶ÇÊûúËøòÊòØundefinedÔºåÂ∞ùËØï‰ªéÂÖ®Â±Ä‰ΩúÁî®ÂüüËé∑Âèñ
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('Â∞ùËØï‰ªéÂÖ®Â±Ä‰ΩúÁî®ÂüüËé∑ÂèñzodiacTestAnswers...');
                    zodiacTestAnswers = window.zodiacTestAnswers;
                }
                
                // Â¶ÇÊûúËøòÊòØundefinedÔºåÂº∫Âà∂ÂàõÂª∫
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('Âº∫Âà∂ÂàõÂª∫zodiacTestAnswers...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                    window.zodiacTestAnswers = zodiacTestAnswers;
                }
                
                console.log('zodiacTestAnswersÁä∂ÊÄÅ:', zodiacTestAnswers);
                
                // ‰øùÂ≠òÂü∫Á°ÄÊï∞ÊçÆ
                zodiacTestAnswers.basic = { 
                    birthDate: birthDateValue, 
                    birthTime: birthTimeValue, 
                    birthPlace: birthPlaceValue 
                };
                
                console.log('Êï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞ÂÜÖÂ≠ò:', zodiacTestAnswers.basic);
                
                // Â∞ùËØï‰øùÂ≠òÂà∞localStorage
                try {
                    localStorage.setItem('zodiacTestData', JSON.stringify(zodiacTestAnswers.basic));
                    console.log('Êï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞localStorage');
                } catch (localStorageError) {
                    console.warn('localStorage‰øùÂ≠òÂ§±Ë¥•:', localStorageError);
                    // localStorageÂ§±Ë¥•‰∏çÂΩ±Âìç‰∏ªË¶ÅÂäüËÉΩ
                }
                
                // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                alert('Êï∞ÊçÆ‰øùÂ≠òÊàêÂäüÔºÅÊ≠£Âú®ËøîÂõûÈ¶ñÈ°µ...');
                
                // Âª∂Ëøü‰∏Ä‰∏ãËÆ©Áî®Êà∑ÁúãÂà∞ÊèêÁ§∫ÔºåÁÑ∂ÂêéËøîÂõûÈ¶ñÈ°µ
                setTimeout(() => {
                    console.log('ÂáÜÂ§áËøîÂõûÈ¶ñÈ°µ...');
                    returnToHomePage();
                }, 1000);
                
            } catch (error) {
                console.error('startZodiacTestÂáΩÊï∞ÊâßË°åÂá∫Èîô:', error);
                alert('‰øùÂ≠òÊï∞ÊçÆÂ§±Ë¥•: ' + error.message);
            }
        }

        // ÊòæÁ§∫ÊåáÂÆöÈÉ®ÂàÜ
        function showZodiacSection(sectionId) {
            console.log('ÊòæÁ§∫ÈÉ®ÂàÜ:', sectionId);
            
            document.querySelectorAll('#zodiacMBTIModal .test-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                console.log('ÈÉ®ÂàÜÂ∑≤ÊòæÁ§∫:', sectionId);
            } else {
                console.error('Êâæ‰∏çÂà∞ÈÉ®ÂàÜ:', sectionId);
            }
        }

        // ËøîÂõû‰∏ä‰∏ÄÈÉ®ÂàÜ
        function previousZodiacSection(sectionId) {
            showZodiacSection(sectionId);
        }

        // ‰∏ã‰∏ÄÊ≠•
        function nextZodiacSection(sectionId) {
            if (window.i18n && typeof i18n.setLanguage === 'function') {
                i18n.setLanguage('en');
            }
            showZodiacSection(sectionId);
            if (sectionId === 'zodiacSection') {
                renderZodiacZodiacQuestions();
            } else if (sectionId === 'fusionSection') {
                renderZodiacFusionQuestions();
            }
        }

        // Ê∏≤ÊüìMBTIÈóÆÈ¢ò
        function renderZodiacMBTIQuestions() {
            const container = document.getElementById('mbtiQuestions');
            container.innerHTML = '';

            zodiacMBTIQuestions.mbti.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card';
                questionDiv.innerHTML = `
                    <h3>ÈóÆÈ¢ò ${index + 1}</h3>
                    <p>${q.question}</p>
                    <ul class="options-list">
                        ${q.options.map((opt, optIndex) => `
                            <li class="option-item">
                                <input type="radio" name="mbti_${index}" value="${opt.value}" 
                                       class="option-radio" onchange="updateZodiacMBTIProgress()">
                                <label class="option-label">${opt.text}</label>
                            </li>
                        `).join('')}
                    </ul>
                `;
                container.appendChild(questionDiv);
            });
            // enforce EN after dynamic insert
            if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
        }

        // Ê∏≤ÊüìÊòüÂ∫ßÈóÆÈ¢ò
        function renderZodiacZodiacQuestions() {
            const container = document.getElementById('zodiacQuestions');
            container.innerHTML = '';

            zodiacMBTIQuestions.zodiac.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card';
                questionDiv.innerHTML = `
                    <h3>ÈóÆÈ¢ò ${index + 1}</h3>
                    <p>${q.question}</p>
                    <ul class="options-list">
                        ${q.options.map((opt, optIndex) => `
                            <li class="option-item">
                                <input type="radio" name="zodiac_${index}" value="${opt.element}" 
                                       class="option-radio" onchange="updateZodiacZodiacProgress()">
                                <label class="option-label">${opt.text}</label>
                            </li>
                        `).join('')}
                    </ul>
                `;
                container.appendChild(questionDiv);
            });
            // enforce EN after dynamic insert
            if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
        }

        // Ê∏≤ÊüìËûçÂêàÈóÆÈ¢ò
        function renderZodiacFusionQuestions() {
            const container = document.getElementById('fusionQuestions');
            container.innerHTML = '';

            zodiacMBTIQuestions.fusion.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-card';
                questionDiv.innerHTML = `
                    <h3>ÈóÆÈ¢ò ${index + 1}</h3>
                    <p>${q.question}</p>
                    <ul class="options-list">
                        ${q.options.map((opt, optIndex) => `
                            <li class="option-item">
                                <input type="radio" name="fusion_${index}" value="${opt.element}_${opt.mbti}" 
                                       class="option-radio" onchange="updateZodiacFusionProgress()">
                                <label class="option-label">${opt.text}</label>
                            </li>
                        `).join('')}
                    </ul>
                `;
                container.appendChild(questionDiv);
            });
            // enforce EN after dynamic insert
            if (window.i18n && typeof i18n.setLanguage === 'function') { i18n.setLanguage('en'); if (typeof i18n.apply==='function') i18n.apply(); }
        }

        // Êõ¥Êñ∞ËøõÂ∫¶
        function updateZodiacMBTIProgress() {
            const answered = document.querySelectorAll('#mbtiQuestions input[type="radio"]:checked').length;
            const total = zodiacMBTIQuestions.mbti.length;
            const progress = (answered / total) * 100;
            
            document.getElementById('mbtiProgress').style.width = progress + '%';
            document.getElementById('mbtiNextBtn').disabled = answered < total;
        }

        function updateZodiacZodiacProgress() {
            const answered = document.querySelectorAll('#zodiacQuestions input[type="radio"]:checked').length;
            const total = zodiacMBTIQuestions.zodiac.length;
            const progress = (answered / total) * 100;
            
            document.getElementById('zodiacProgress').style.width = progress + '%';
            document.getElementById('zodiacNextBtn').disabled = answered < total;
        }

        function updateZodiacFusionProgress() {
            const answered = document.querySelectorAll('#fusionQuestions input[type="radio"]:checked').length;
            const total = zodiacMBTIQuestions.fusion.length;
            const progress = (answered / total) * 100;
            
            document.getElementById('fusionProgress').style.width = progress + '%';
            document.getElementById('fusionNextBtn').disabled = answered < total;
        }
        // ÁîüÊàêÁªìÊûú
        function generateZodiacResults() {
            collectZodiacAnswers();
            showZodiacSection('zodiacLoadingSection');
            
            setTimeout(() => {
                const results = calculateZodiacResults();
                displayZodiacResults(results);
                showZodiacSection('zodiacResultSection');
            }, 2000);
        }

        // Êî∂ÈõÜÁ≠îÊ°à
        function collectZodiacAnswers() {
            // Êî∂ÈõÜMBTIÁ≠îÊ°à
            zodiacMBTIQuestions.mbti.forEach((q, index) => {
                const selected = document.querySelector(`input[name="mbti_${index}"]:checked`);
                if (selected) {
                    zodiacTestAnswers.mbti[q.options[0].category] = selected.value;
                }
            });

            // Êî∂ÈõÜÊòüÂ∫ßÁ≠îÊ°à
            zodiacMBTIQuestions.zodiac.forEach((q, index) => {
                const selected = document.querySelector(`input[name="zodiac_${index}"]:checked`);
                if (selected) {
                    zodiacTestAnswers.zodiac[`question_${index}`] = selected.value;
                }
            });

            // Êî∂ÈõÜËûçÂêàÁ≠îÊ°à
            zodiacMBTIQuestions.fusion.forEach((q, index) => {
                const selected = document.querySelector(`input[name="fusion_${index}"]:checked`);
                if (selected) {
                    const [element, mbti] = selected.value.split('_');
                    zodiacTestAnswers.fusion[`question_${index}`] = { element, mbti };
                }
            });
        }

        // ËÆ°ÁÆóÁªìÊûú
        function calculateZodiacResults() {
            const birthDate = new Date(zodiacTestAnswers.basic.birthDate);
            const month = birthDate.getMonth() + 1;
            const day = birthDate.getDate();
            
            let sunSign = '';
            if ((month === 3 && day >= 21) || (month === 4 && day <= 19)) sunSign = 'aries';
            else if ((month === 4 && day >= 20) || (month === 5 && day <= 20)) sunSign = 'taurus';
            else if ((month === 5 && day >= 21) || (month === 6 && day <= 21)) sunSign = 'gemini';
            else if ((month === 6 && day >= 22) || (month === 7 && day <= 22)) sunSign = 'cancer';
            else if ((month === 7 && day >= 23) || (month === 8 && day <= 22)) sunSign = 'leo';
            else if ((month === 8 && day >= 23) || (month === 9 && day <= 22)) sunSign = 'virgo';
            else if ((month === 9 && day >= 23) || (month === 10 && day <= 23)) sunSign = 'libra';
            else if ((month === 10 && day >= 24) || (month === 11 && day <= 22)) sunSign = 'scorpio';
            else if ((month === 11 && day >= 23) || (month === 12 && day <= 21)) sunSign = 'sagittarius';
            else if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) sunSign = 'capricorn';
            else if ((month === 1 && day >= 20) || (month === 2 && day <= 18)) sunSign = 'aquarius';
            else if ((month === 2 && day >= 19) || (month === 3 && day <= 20)) sunSign = 'pisces';

            const mbtiType = Object.values(zodiacTestAnswers.mbti).join('');
            
            const elementCounts = {};
            Object.values(zodiacTestAnswers.zodiac).forEach(element => {
                elementCounts[element] = (elementCounts[element] || 0) + 1;
            });
            const primaryElement = Object.keys(elementCounts).reduce((a, b) => 
                elementCounts[a] > elementCounts[b] ? a : b
            );

            const fusionType = generateZodiacFusionType(primaryElement, zodiacTestAnswers.mbti, sunSign);
            
            return {
                sunSign,
                mbtiType,
                primaryElement,
                fusionType
            };
        }

        // ÁîüÊàêËûçÂêàÁ±ªÂûã
        function generateZodiacFusionType(element, mbtiProfile, sunSign) {
            const elementNames = {
                fire: 'ÁÅ´Ë±°',
                earth: 'ÂúüË±°',
                air: 'È£éË±°',
                water: 'Ê∞¥Ë±°'
            };

            const mbtiNames = {
                EI: mbtiProfile.EI === 'E' ? 'Â§ñÂêë' : 'ÂÜÖÂêë',
                SN: mbtiProfile.SN === 'S' ? 'ÊÑüËßâ' : 'Áõ¥Ëßâ',
                TF: mbtiProfile.TF === 'T' ? 'ÊÄùËÄÉ' : 'ÊÉÖÊÑü',
                JP: mbtiProfile.JP === 'J' ? 'Âà§Êñ≠' : 'ÊÑüÁü•'
            };

            const dominantDimension = Object.keys(mbtiNames)[0];
            
            return {
                name: `${elementNames[element]}${mbtiNames[dominantDimension]}Âûã`,
                element: element,
                dominantDimension: dominantDimension,
                mbtiValue: mbtiProfile[dominantDimension]
            };
        }

        // ÊòæÁ§∫ÁªìÊûú
        function displayZodiacResults(results) {
            const fusionResult = document.getElementById('zodiacFusionResult');
            const detailedReport = document.getElementById('zodiacDetailedReport');

            fusionResult.innerHTML = `
                <div class="fusion-type">
                    <h2>${results.fusionType.name}</h2>
                    <p>‰Ω†ÁöÑÊòüÂ∫ßÁâπË¥®‰∏éMBTIÂÅèÂ•ΩÁöÑÂÆåÁæéÁªìÂêà</p>
                </div>
            `;

            detailedReport.innerHTML = `
                <div class="report-grid">
                    <div class="report-card">
                        <h3>üåü Âü∫Êú¨‰ø°ÊÅØ</h3>
                        <ul>
                            <li><strong>Â§™Èò≥ÊòüÂ∫ßÔºö</strong>${zodiacDatabase[results.sunSign].name}</li>
                            <li><strong>MBTIÁ±ªÂûãÔºö</strong>${results.mbtiType}</li>
                            <li><strong>‰∏ªË¶ÅÂÖÉÁ¥†Ôºö</strong>${elementSystem[results.primaryElement].name}</li>
                            <li><strong>ËûçÂêàÁ±ªÂûãÔºö</strong>${results.fusionType.name}</li>
                        </ul>
                    </div>
                    
                    <div class="report-card">
                        <h3>üî• ÊòüÂ∫ßÁâπË¥®</h3>
                        <ul>
                            ${zodiacDatabase[results.sunSign].traits.map(trait => 
                                `<li>${trait}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    
                    <div class="report-card">
                        <h3>üå™Ô∏è ÂÖÉÁ¥†ÁâπË¥®</h3>
                        <ul>
                            ${elementSystem[results.primaryElement].traits.map(trait => 
                                `<li>${trait}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    
                    <div class="report-card">
                        <h3>üí° ÂèëÂ±ïÂª∫ËÆÆ</h3>
                        <ul>
                            <li>ÂèëÊå•${elementSystem[results.primaryElement].name}ÂÖÉÁ¥†ÁöÑ‰ºòÂäø</li>
                            <li>Âπ≥Ë°°${elementSystem[results.primaryElement].name}‰∏éÂÖ∂‰ªñÂÖÉÁ¥†ÁâπË¥®</li>
                            <li>ÁªìÂêàMBTIÂÅèÂ•ΩÂèëÂ±ï‰∏™‰∫∫ËÉΩÂäõ</li>
                            <li>Âà©Áî®ÊòüÂ∫ßÁâπË¥®ÊèêÂçá‰∫∫ÈôÖÂÖ≥Á≥ª</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // ÈáçÊñ∞ÂºÄÂßãÊµãËØï
        function restartZodiacTest() {
            try {
                // Á°Æ‰øùÂèòÈáèÂ∑≤ÂàùÂßãÂåñ
                if (typeof zodiacTestAnswers === 'undefined') {
                    console.log('zodiacTestAnswersÊú™ÂÆö‰πâÔºåÊ≠£Âú®ÂàùÂßãÂåñ...');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                } else {
                    console.log('ÈáçÁΩÆzodiacTestAnswers');
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                }
                
                // ÈáçÁΩÆË°®ÂçïËæìÂÖ•
                const birthDate = document.getElementById('birthDate');
                const birthTime = document.getElementById('birthTime');
                const birthPlace = document.getElementById('birthPlace');
                
                if (birthDate) birthDate.value = '';
                if (birthTime) birthTime.value = '';
                if (birthPlace) birthPlace.value = '';
                
                // ÊòæÁ§∫Âü∫Á°Ä‰ø°ÊÅØÈÉ®ÂàÜ
                showZodiacSection('basicInfoSection');
                
                console.log('ÊµãËØïÈáçÁΩÆÂÆåÊàê');
            } catch (error) {
                console.error('ÈáçÁΩÆÊµãËØïÊó∂Âá∫Èîô:', error);
                // Â¶ÇÊûúÂá∫ÈîôÔºåËá≥Â∞ëÂ∞ùËØïÂàùÂßãÂåñÂèòÈáè
                try {
                    zodiacTestAnswers = { basic: {}, mbti: {}, zodiac: {}, fusion: {} };
                } catch (e) {
                    console.error('Êó†Ê≥ïÂàùÂßãÂåñzodiacTestAnswers:', e);
                }
            }
        }

        // ÂàÜ‰∫´ÁªìÊûú
        function shareZodiacResults() {
            const fusionType = document.querySelector('.fusion-type h2').textContent;
            const shareText = `ÊàëÂú®ÊòüÂ∫ß+MBTIËûçÂêàÊµãËØï‰∏≠ÁöÑÁªìÊûúÊòØÔºö${fusionType}ÔºÅÂø´Êù•ÊµãËØï‰Ω†ÁöÑËûçÂêàÁ±ªÂûãÂêßÔºÅ`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ÊòüÂ∫ß+MBTIËûçÂêàÊµãËØïÁªìÊûú',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    showToast('ÁªìÊûúÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ', 'success');
                });
            }
        }
    </script>
<script>
  // Minimal i18n runtime (EN default)
  (function(){
    const dict = {
      en: {
        home: { title: 'üß† MBTI Personality Test', subtitle: 'Discover your personality type and understand yourself better' },
        features: {
          mbtitest: { title: 'Professional MBTI Test', desc: "Professional test based on Jung's theory of 16 personality types, fast and accurate" },
        },
        common: { start_test: 'Start Test' }
      },
      zh: {
        home: { title: 'üß† MBTI‰∫∫Ê†ºÊµãËØï', subtitle: 'Êé¢Á¥¢‰Ω†ÁöÑÊÄßÊ†ºÁ±ªÂûãÔºå‰∫ÜËß£ÁúüÂÆûÁöÑËá™Â∑±' },
        features: {
          mbtitest: { title: '‰∏ì‰∏öMBTIÊµãËØï', desc: 'Âü∫‰∫éËç£Ê†ºÁêÜËÆ∫ÁöÑ16Áßç‰∫∫Ê†ºÁ±ªÂûã‰∏ì‰∏öÊµãËØïÔºåÂø´ÈÄüÂáÜÁ°Æ' },
        },
        common: { start_test: 'ÂºÄÂßãÊµãËØï' }
      }
    };
    let lang = 'en';
    function t(key){
      return key.split('.').reduce((o,k)=>o&&o[k], dict[lang]) || key;
    }
    function apply(){
      document.querySelectorAll('[data-i18n]').forEach(el=>{ el.textContent = t(el.getAttribute('data-i18n')); });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el=>{ el.placeholder = t(el.getAttribute('data-i18n-placeholder')); });
      document.documentElement.setAttribute('lang', lang);
    }
    window.i18n = { setLanguage:l=>{ if(dict[l]){ lang=l; apply(); } }, t, apply };
    document.addEventListener('DOMContentLoaded', apply);
  })();
  // Sample fill for index modal
  function setIndexSample(type){
    const d = document.getElementById('birthDate');
    if (!d) return;
    if (type === 'gregorian') d.value = '2020-01-01';
    else if (type === 'lunar') d.value = 'ÂÜúÂéÜ2020Âπ¥ÂçÅÊúàÂàù‰∏â';
    else if (type === 'leap') d.value = 'ÂÜúÂéÜ2020Âπ¥Èó∞ÂõõÊúàÂàù‰∏Ä';
    if (typeof showToast === 'function') showToast('Á§∫‰æãÂ∑≤Â°´ÂÖÖÔºåÂèØÁõ¥Êé•ÂºÄÂßãÊµãËØï', 'success');
  }

  // ‚Äî‚Äî Shared date parsing and lunar conversion (from bazi-test.html) ‚Äî‚Äî
  const CN_DIGIT = { 'Èõ∂':0,'„Äá':0,'‰∏Ä':1,'‰∫å':2,'‰∏§':2,'‰∏â':3,'Âõõ':4,'‰∫î':5,'ÂÖ≠':6,'‰∏É':7,'ÂÖ´':8,'‰πù':9,'Ê≠£':1 };
  function cnNumToInt(token){
    if (!token) return NaN;
    if (token.startsWith('Âàù')) { const d = CN_DIGIT[token.slice(1)] || (token === 'ÂàùÂçÅ' ? 10 : undefined); return typeof d === 'number' ? d : NaN; }
    if (token.startsWith('Âªø')) { const val = CN_DIGIT[token.slice(1)] || 0; return 20 + val; }
    if (token.startsWith('ÂçÖ')) { const val = CN_DIGIT[token.slice(1)] || 0; return 30 + val; }
    if (token === 'ÂçÅ') return 10;
    const tenIdx = token.indexOf('ÂçÅ');
    if (tenIdx >= 0) { const left = token.slice(0, tenIdx); const right = token.slice(tenIdx + 1); const tens = left ? (CN_DIGIT[left] || 0) : 1; const ones = right ? (CN_DIGIT[right] || 0) : 0; return tens * 10 + ones; }
    if (token.length === 1 && token in CN_DIGIT) return CN_DIGIT[token];
    return NaN;
  }
  function hasLunarKeywords(input){ return /(ÂÜúÂéÜ|Èô∞ÊõÜ|Èò¥ÂéÜ|Èó∞|Èñè)/.test(String(input||'')); }
  function convertToISOFormat(dateString){
    if (!dateString) return '';
    let s = String(dateString).trim();
    s = s.replace(/,/g, ' ').replace(/\b(\d{1,2})(st|nd|rd|th)\b/gi, '$1');
    const MONTHS_EN = { january:'01', jan:'01', february:'02', feb:'02', march:'03', mar:'03', april:'04', apr:'04', may:'05', june:'06', jun:'06', july:'07', jul:'07', august:'08', aug:'08', september:'09', sept:'09', sep:'09', october:'10', oct:'10', november:'11', nov:'11', december:'12', dec:'12' };
    Object.keys(MONTHS_EN).forEach(k => { s = s.replace(new RegExp(`\\b${k}\\.?\\b`, 'gi'), MONTHS_EN[k]); });
    const MONTHS_ZH = { '‰∏ÄÊúà':'01','‰∫åÊúà':'02','‰∏âÊúà':'03','ÂõõÊúà':'04','‰∫îÊúà':'05','ÂÖ≠Êúà':'06','‰∏ÉÊúà':'07','ÂÖ´Êúà':'08','‰πùÊúà':'09','ÂçÅÊúà':'10','ÂçÅ‰∏ÄÊúà':'11','ÂçÅ‰∫åÊúà':'12' };
    Object.keys(MONTHS_ZH).forEach(k => { s = s.replace(new RegExp(k, 'g'), MONTHS_ZH[k]); });
    if (/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}$/.test(s)) { const [y,m,d] = s.replaceAll('/', '-').split('-'); return `${y.padStart(4,'0')}-${m.padStart(2,'0')}-${d.padStart(2,'0')}`; }
    if (/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(s)) { const [mm,dd,yy] = s.split('/'); return `${yy}-${mm.padStart(2,'0')}-${dd.padStart(2,'0')}`; }
    if (/^\d{8}$/.test(s)) { return `${s.slice(0,4)}-${s.slice(4,6)}-${s.slice(6,8)}`; }
    const zh = s.match(/(\d{4})Âπ¥([Ê≠£‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ]{1,3})Êúà([ÂàùÂªøÂçÖ‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ]{1,3})Êó•?/);
    if (zh) { const y=zh[1]; const mVal=cnNumToInt(zh[2]); const dVal=cnNumToInt(zh[3]); if (!isNaN(mVal)&&!isNaN(dVal)) return `${y}-${String(mVal).padStart(2,'0')}-${String(dVal).padStart(2,'0')}`; }
    const normalized = s.replace(/Âπ¥/g,'-').replace(/Êúà/g,'-').replace(/Êó•/g,'').replace(/[Ôºé„ÄÇ¬∑¬∑]/g,'-').replace(/[Ôºå„ÄÅ]/g,'-').replace(/[\s]+/g,'-').replace(/‚Äî/g,'-').replace(/\\/g,'-').replace(/\uFF0F/g,'/').replace(/-{2,}/g,'-');
    const nums = normalized.match(/\d{1,4}/g) || [];
    if (nums.length >= 3) { let y='',m='',d=''; if (nums[0].length===4) [y,m,d]=[nums[0],nums[1],nums[2]]; else if (nums[2] && nums[2].length===4) [y,m,d]=[nums[2],nums[0],nums[1]]; else if (parseInt(nums[0],10)>1900 && parseInt(nums[0],10)<=2100) [y,m,d]=[nums[0],nums[1],nums[2]]; else return s; return `${String(y).padStart(4,'0')}-${String(m).padStart(2,'0')}-${String(d).padStart(2,'0')}`; }
    return s;
  }
  function validateDateFormat(dateString){ if (!dateString) return false; const iso = convertToISOFormat(dateString); if (!/^\d{4}-\d{2}-\d{2}$/.test(iso)) return false; const [yStr,mStr,dStr] = iso.split('-'); const y=+yStr,m=+mStr,d=+dStr; if (y<1900||y>2100||m<1||m>12||d<1||d>31) return false; const dt = new Date(`${yStr}-${mStr}-${dStr}T00:00:00Z`); return dt.getUTCFullYear()===y && (dt.getUTCMonth()+1)===m && dt.getUTCDate()===d; }
  const LUNAR_SOURCES_IDX = [ './libs/lunar.min.js','https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.min.js','https://cdn.jsdelivr.net/npm/lunar-javascript/dist/lunar.min.js','https://cdn.jsdelivr.net/npm/lunar-javascript/umd/lunar.js','https://unpkg.com/lunar-javascript/lunar.min.js','https://unpkg.com/lunar-javascript/dist/lunar.min.js','https://unpkg.com/lunar-javascript/umd/lunar.js' ];
  function loadScriptOnceIdx(src, timeoutMs=6000){ return new Promise((resolve,reject)=>{ const s=document.createElement('script'); const bust=(src.startsWith('./')||src.startsWith('/'))?(`${src}?v=${Date.now()}`):src; s.src=bust; s.async=true; s.crossOrigin='anonymous'; let done=false; const timer=setTimeout(()=>{ if(!done){ done=true; s.remove(); reject(new Error('timeout')); } }, timeoutMs); s.onload=()=>{ if(!done){ done=true; clearTimeout(timer); resolve(true); } }; s.onerror=()=>{ if(!done){ done=true; clearTimeout(timer); reject(new Error('load error')); } }; document.head.appendChild(s); }); }
  async function waitForLunarIdx(tries=40, intervalMs=150){ for (let i=0;i<tries;i++){ if ((window.Solar && (window.Solar.fromYmdHms || window.Solar.fromDate)) || (window.Lunar && window.Lunar.Solar && (window.Lunar.Solar.fromYmdHms || window.Lunar.Solar.fromDate)) || (window.Lunar && (window.Lunar.fromYmd || (window.Lunar.Lunar && window.Lunar.Lunar.fromYmd)))) return true; await new Promise(r=>setTimeout(r, intervalMs)); } return false; }
  async function loadLunarFromFallbacksIdx(){ for (const url of LUNAR_SOURCES_IDX){ try { await loadScriptOnceIdx(url); const ok = await waitForLunarIdx(20,100); if (ok) return true; } catch(e){} } return false; }
  async function tryConvertLunarToSolarISOIdx(input){ const s=String(input).trim(); const zh=s.match(/(\d{4})Âπ¥\s*(Èó∞|Èñè)?\s*([Ê≠£‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ\d]{1,3})Êúà\s*([ÂàùÂªøÂçÖ‰∏Ä‰∫å‰∏âÂõõ‰∫îÂÖ≠‰∏ÉÂÖ´‰πùÂçÅ\d]{1,3})Êó•?/); if (!zh) return ''; const year=+zh[1]; const isLeap=!!zh[2]; const mToken=zh[3]; const dToken=zh[4]; const month=/^\d+$/.test(mToken)?+mToken:cnNumToInt(mToken); const day=/^\d+$/.test(dToken)?+dToken:cnNumToInt(dToken); if (!month||!day) return ''; try { if (!(window.Lunar && (window.Lunar.fromYmd || (window.Lunar.Lunar && window.Lunar.Lunar.fromYmd)))){ const ok = await loadLunarFromFallbacksIdx(); if (!ok) return ''; } const L=(window.Lunar && window.Lunar.Lunar)?window.Lunar.Lunar:window.Lunar; const lunar=(typeof L.fromYmdHms==='function')?L.fromYmdHms(year,month,day,12,0,0,isLeap):(typeof L.fromYmd==='function'?L.fromYmd(year,month,day,isLeap):null); if (!lunar||!lunar.getSolar) return ''; const solar=lunar.getSolar(); if (!solar) return ''; if (typeof solar.toYmd==='function') return solar.toYmd(); const y=solar.getYear?solar.getYear():year; const m=solar.getMonth?solar.getMonth():month; const d=solar.getDay?solar.getDay():day; return `${String(y).padStart(4,'0')}-${String(m).padStart(2,'0')}-${String(d).padStart(2,'0')}`; } catch(e){ return ''; } }
  async function validateAndNormalizeDateAsyncIdx(input){ if (!input) return ''; if (hasLunarKeywords(input)){ const isoL = await tryConvertLunarToSolarISOIdx(input); if (isoL && /^\d{4}-\d{2}-\d{2}$/.test(isoL)) return isoL; }
    const iso = convertToISOFormat(input); if (!/^\d{4}-\d{2}-\d{2}$/.test(iso)) return ''; return validateDateFormat(iso) ? iso : '';
  }

  // Attach async normalization to index birthDate
  document.addEventListener('DOMContentLoaded', ()=>{
    const d = document.getElementById('birthDate');
    if (!d) return;
    d.addEventListener('blur', async function(){
      if (!this.value) return;
      const before = this.value;
      const iso = await validateAndNormalizeDateAsyncIdx(before);
      if (!iso) { if (typeof showToast==='function') showToast('Invalid dateÔºàÊîØÊåÅÂÖ¨ÂéÜ/ÂÜúÂéÜÔºåÂê´Èó∞ÊúàÔºâ', 'error'); this.focus(); return; }
      if (typeof showToast==='function' && hasLunarKeywords(before)) showToast(`Â∑≤ËΩ¨Êç¢‰∏∫Èò≥ÂéÜÔºö${iso}`, 'success');
      this.dataset.iso = iso;
    });
  });
</script>
</body>
</html>