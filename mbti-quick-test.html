<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“ä¸šMBTIæµ‹è¯• - åŸºäºè£æ ¼ç†è®ºçš„16ç§äººæ ¼ç±»å‹</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #1f2937;
        }
        .container { max-width: 900px; margin: 0 auto; padding: 24px; }
        .card {
            background: rgba(255,255,255,0.98);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(0,0,0,0.05);
        }
        .header { text-align: center; color: #fff; margin: 24px 0; }
        .header h1 { margin: 0 0 8px; font-size: 32px; }
        .header p { margin: 0; opacity: 0.9; }
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            padding: 12px 24px;
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 8px 20px rgba(102,126,234,0.35);
            transition: transform 0.15s ease, box-shadow 0.2s ease;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(102,126,234,0.5); }
        .btn:disabled { opacity: .6; cursor: not-allowed; box-shadow: none; }
        .btn-secondary { background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%); box-shadow: 0 8px 20px rgba(100,116,139,0.35); }
        .center { text-align: center; }
        .hidden { display: none; }
        .progress { height: 8px; background: #e5e7eb; border-radius: 999px; overflow: hidden; margin: 12px 0 20px; }
        .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, #34d399, #10b981); transition: width .25s ease; }
        .q-text { font-size: 20px; color: #111827; margin: 8px 0 12px; }
        .opt { border: 2px solid #e5e7eb; border-radius: 12px; padding: 14px; margin: 10px 0; cursor: pointer; transition: all .15s ease; background: #fff; }
        .opt:hover { border-color: #667eea; box-shadow: 0 6px 18px rgba(102,126,234,0.15); transform: translateY(-1px); }
        .opt.selected { border-color: #667eea; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; box-shadow: 0 10px 24px rgba(102,126,234,0.4); }
        .nav { display: flex; justify-content: space-between; gap: 12px; margin-top: 16px; }
        .result-type { font-size: 40px; font-weight: 800; color: #4f46e5; margin: 8px 0 16px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; }
        .pill { display:inline-block; padding:6px 12px; border-radius:999px; background:#eef2ff; color:#3730a3; font-weight:600; font-size:12px; }
        .muted { color: #6b7280; font-size: 14px; }
        a.link { color: #4f46e5; text-decoration: none; font-weight: 600; }
        a.link:hover { text-decoration: underline; }
        /* æ™ºèƒ½è§£æ */
        .insight { margin-top: 10px; padding: 12px 14px; border-left: 4px solid #10b981; background: #ecfdf5; color: #065f46; border-radius: 10px; box-shadow: 0 6px 16px rgba(16,185,129,0.15); transition: all .2s ease; }
        .insight.fade { opacity: 0; transform: translateY(6px); }
    </style>
    <script>
        // åŸºç¡€é¢˜åº“ï¼ˆ12é¢˜ï¼Œå‡ç­‰è¦†ç›–å››ä¸ªç»´åº¦ï¼‰
        const QUESTIONS = [
            { d: 'EI', t: 'é‡åˆ°æ–°åŒäº‹æ—¶ï¼Œä½ ä¼šï¼š', a: { text: 'ä¸»åŠ¨æ‰“æ‹›å‘¼ï¼Œè¿…é€Ÿç†Ÿç»œ', v: 'E' }, b: { text: 'å…ˆè§‚å¯Ÿä¸€é˜µï¼Œæ…¢æ…¢ç†Ÿæ‚‰', v: 'I' } },
            { d: 'SN', t: 'åšå†³ç­–æ—¶ä½ æ›´çœ‹é‡ï¼š', a: { text: 'ç°å®ç»†èŠ‚ä¸å¯è¡Œæ€§', v: 'S' }, b: { text: 'å¯èƒ½æ€§ä¸é•¿è¿œæ„¿æ™¯', v: 'N' } },
            { d: 'TF', t: 'è®¨è®ºåˆ†æ­§æ—¶ä½ æ›´å…³æ³¨ï¼š', a: { text: 'é€»è¾‘ä¸€è‡´ä¸å®¢è§‚å¯¹é”™', v: 'T' }, b: { text: 'ä»–äººæ„Ÿå—ä¸å…³ç³»å’Œè°', v: 'F' } },
            { d: 'JP', t: 'å¤„ç†äº‹åŠ¡æ—¶ä½ å€¾å‘ï¼š', a: { text: 'æœ‰è®¡åˆ’æœ‰æ¡ç†åœ°æ¨è¿›', v: 'J' }, b: { text: 'å¼¹æ€§å®‰æ’éšæ—¶è°ƒæ•´', v: 'P' } },
            { d: 'EI', t: 'å‘¨æœ«èšä¼šå¯¹ä½ æ¥è¯´ï¼š', a: { text: 'è®©æˆ‘å……ç”µï¼Œè¶Šçƒ­é—¹è¶Šå¥½', v: 'E' }, b: { text: 'éœ€è¦æ¢å¤ï¼Œå®é™æ›´èˆ’æœ', v: 'I' } },
            { d: 'SN', t: 'å­¦ä¹ æ–°æŠ€èƒ½æ—¶ä½ ï¼š', a: { text: 'å…ˆä»æ­¥éª¤/æ•™ç¨‹å¼€å§‹', v: 'S' }, b: { text: 'å…ˆç†è§£åŸç†å†ä¸Šæ‰‹', v: 'N' } },
            { d: 'TF', t: 'è¯„ä¼°æ–¹æ¡ˆä¼˜åŠ£æ—¶ä½ ï¼š', a: { text: 'åˆ—æ ‡å‡†ç®—åˆ©å¼Š', v: 'T' }, b: { text: 'ä½“ä¼šå½±å“ä¸ä»·å€¼è§‚', v: 'F' } },
            { d: 'JP', t: 'æ—…è¡Œå‰çš„å‡†å¤‡ï¼š', a: { text: 'å®Œæ•´è¡Œç¨‹æ¸…å•', v: 'J' }, b: { text: 'æœºåŠ¨éšèµ°éšçœ‹', v: 'P' } },
            { d: 'EI', t: 'å¼€ä¼šæ—¶ä½ æ›´å¸¸ï¼š', a: { text: 'å‘è¨€æ¨åŠ¨æ°”æ°›', v: 'E' }, b: { text: 'å€¾å¬å‡ç»ƒè§‚ç‚¹', v: 'I' } },
            { d: 'SN', t: 'é‡åˆ°é—®é¢˜ä½ å…ˆï¼š', a: { text: 'æŸ¥è¯äº‹å®é€é¡¹æ’æŸ¥', v: 'S' }, b: { text: 'ç›´è§‰åˆ¤æ–­å®šä½å…³é”®', v: 'N' } },
            { d: 'TF', t: 'æ”¶åˆ°åé¦ˆä½ å¸Œæœ›ï¼š', a: { text: 'ç›´æ¥å…·ä½“ã€å¯æ‰§è¡Œ', v: 'T' }, b: { text: 'å§”å©‰é¼“åŠ±ã€é¡¾æƒ…ç»ª', v: 'F' } },
            { d: 'JP', t: 'é¢å¯¹æˆªæ­¢æœŸä½ é€šå¸¸ï¼š', a: { text: 'æå‰å®Œæˆç•™ä½™åœ°', v: 'J' }, b: { text: 'ä¸´è¿‘æˆªç‚¹æ•ˆç‡æ›´é«˜', v: 'P' } }
        ];

        let currentIndex = -1;
        let selections = Array(QUESTIONS.length).fill(null);

        const scores = { E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0 };
        let autoAdvanceTimer = null;

        // ç»´åº¦æ™ºèƒ½è§£æ
        const INSIGHT = {
            EI: {
                E: 'ä½ åå‘å¤–å‘(E)ï¼šä»äº’åŠ¨ä¸­è·å¾—èƒ½é‡ï¼Œä¸»åŠ¨è¡¨è¾¾æœ‰åŠ©äºæ¨åŠ¨åä½œã€‚',
                I: 'ä½ åå‘å†…å‘(I)ï¼šç‹¬ç«‹æ€è€ƒæ›´é«˜æ•ˆï¼Œæ²‰æ·€åè¡¨è¾¾å¸¸æ›´æœ‰è´¨é‡ã€‚'
            },
            SN: {
                S: 'ä½ åå‘æ„Ÿè§‰(S)ï¼šé‡è§†äº‹å®ä¸ç»†èŠ‚ï¼Œæ‰§è¡Œä¸è½åœ°ä¼˜åŠ¿æ˜æ˜¾ã€‚',
                N: 'ä½ åå‘ç›´è§‰(N)ï¼šå–„äºæŠ½è±¡ä¸è”æƒ³ï¼Œæ“…é•¿æ´å¯Ÿè¶‹åŠ¿ä¸å¯èƒ½æ€§ã€‚'
            },
            TF: {
                T: 'ä½ åå‘æ€è€ƒ(T)ï¼šè®²æ±‚é€»è¾‘ä¸æ ‡å‡†ï¼Œå†³ç­–æ¸…æ™°è€Œä¸€è‡´ã€‚',
                F: 'ä½ åå‘æƒ…æ„Ÿ(F)ï¼šå…³æ³¨äººå’Œå…³ç³»ï¼Œæ“…é•¿è¥é€ ä¿¡ä»»ä¸å‡èšåŠ›ã€‚'
            },
            JP: {
                J: 'ä½ åå‘åˆ¤æ–­(J)ï¼šè®¡åˆ’æ˜ç¡®ã€æ¡ç†åˆ†æ˜ï¼Œè¿›åº¦å¯æ§ã€‚',
                P: 'ä½ åå‘æ„ŸçŸ¥(P)ï¼šçµæ´»æœºåŠ¨ã€é€‚åº”å˜åŒ–ï¼Œä¿ç•™æ¢ç´¢ç©ºé—´ã€‚'
            }
        };

        // æ˜Ÿåº§çŸ¥è¯†åº“ï¼ˆåŸºäºå¸¸è§æ€§æ ¼ç”»åƒï¼Œä½œä¸ºå¾®å¼±åç½®å‚ä¸è®¡ç®—ï¼‰
        const ZODIAC_KB = {
            aries: { key: 'aries', cn: 'ç™½ç¾Šåº§', weights: { E: 0.8, I: 0.0, S: 0.0, N: 0.6, T: 0.4, F: 0.0, J: 0.0, P: 0.6 }, traits: 'è¡ŒåŠ¨åŠ›å¼ºã€ç›´æ¥ç›´å¾€ã€åå‘ç›´è§‰ä¸æ¢ç´¢ã€‚' },
            taurus: { key: 'taurus', cn: 'é‡‘ç‰›åº§', weights: { E: 0.0, I: 0.4, S: 0.8, N: 0.0, T: 0.4, F: 0.2, J: 0.8, P: 0.0 }, traits: 'åŠ¡å®ç¨³å®šã€é‡è§†ç»†èŠ‚ä¸ç§©åºï¼Œè¡ŒåŠ¨ç¨³å¥ã€‚' },
            gemini: { key: 'gemini', cn: 'åŒå­åº§', weights: { E: 0.6, I: 0.0, S: 0.0, N: 0.8, T: 0.3, F: 0.0, J: 0.0, P: 0.8 }, traits: 'å¥½å¥‡å¤šå˜ã€æ²Ÿé€šæ¬²å¼ºã€åå‘å¼€æ”¾å’Œçµæ´»ã€‚' },
            cancer: { key: 'cancer', cn: 'å·¨èŸ¹åº§', weights: { E: 0.0, I: 0.6, S: 0.4, N: 0.0, T: 0.0, F: 0.9, J: 0.5, P: 0.0 }, traits: 'å…±æƒ…ç»†è…»ã€é‡è§†å®‰å…¨ä¸å…³ç³»ï¼Œåæƒ…æ„Ÿä¸å†…æ•›ã€‚' },
            leo: { key: 'leo', cn: 'ç‹®å­åº§', weights: { E: 0.9, I: 0.0, S: 0.0, N: 0.6, T: 0.2, F: 0.4, J: 0.5, P: 0.0 }, traits: 'è‡ªä¿¡å¤–æ”¾ã€æ„¿æ„æ‹…å½“ï¼Œé‡è§†æ„¿æ™¯ä¸å½±å“åŠ›ã€‚' },
            virgo: { key: 'virgo', cn: 'å¤„å¥³åº§', weights: { E: 0.0, I: 0.5, S: 0.8, N: 0.0, T: 0.7, F: 0.0, J: 0.9, P: 0.0 }, traits: 'ä¸¥è°¨æŒ‘å‰”ã€æ³¨é‡æ ‡å‡†ä¸ç»†èŠ‚ï¼Œè¿½æ±‚ç§©åºã€‚' },
            libra: { key: 'libra', cn: 'å¤©ç§¤åº§', weights: { E: 0.4, I: 0.0, S: 0.0, N: 0.5, T: 0.0, F: 0.7, J: 0.0, P: 0.4 }, traits: 'æ“…é•¿åè°ƒã€è¿½æ±‚å¹³è¡¡ï¼Œåäººé™…ä¸ç¾æ„Ÿã€‚' },
            scorpio: { key: 'scorpio', cn: 'å¤©èåº§', weights: { E: 0.0, I: 0.7, S: 0.0, N: 0.8, T: 0.7, F: 0.0, J: 0.6, P: 0.0 }, traits: 'æ´å¯Ÿæ·±å…¥ã€ç›®æ ‡ä¸“æ³¨ï¼Œé‡é€»è¾‘ä¸æŒæ§æ„Ÿã€‚' },
            sagittarius: { key: 'sagittarius', cn: 'å°„æ‰‹åº§', weights: { E: 0.7, I: 0.0, S: 0.0, N: 0.9, T: 0.4, F: 0.0, J: 0.0, P: 0.9 }, traits: 'çƒ­çˆ±è‡ªç”±ã€è¿œè§ä¹è§‚ï¼Œåæ¢ç´¢ä¸å¼€æ”¾ã€‚' },
            capricorn: { key: 'capricorn', cn: 'æ‘©ç¾¯åº§', weights: { E: 0.0, I: 0.6, S: 0.7, N: 0.0, T: 0.8, F: 0.0, J: 0.9, P: 0.0 }, traits: 'åŠ¡å®è‡ªå¾‹ã€ç»“æœå¯¼å‘ï¼Œåç†æ€§ä¸ç»“æ„ã€‚' },
            aquarius: { key: 'aquarius', cn: 'æ°´ç“¶åº§', weights: { E: 0.0, I: 0.5, S: 0.0, N: 0.9, T: 0.8, F: 0.0, J: 0.0, P: 0.6 }, traits: 'ç‹¬ç«‹åˆ›æ–°ã€å‰ç»åå›ï¼Œåç†å¿µä¸è‡ªç”±ã€‚' },
            pisces: { key: 'pisces', cn: 'åŒé±¼åº§', weights: { E: 0.0, I: 0.6, S: 0.0, N: 0.7, T: 0.0, F: 0.9, J: 0.0, P: 0.7 }, traits: 'æµªæ¼«å…±æƒ…ã€æƒ³è±¡ä¸°å¯Œï¼Œåç›´è§‰ä¸æ„Ÿå—ã€‚' }
        };

        // å æ˜Ÿæ‰©å±•çŸ¥è¯†åº“ï¼ˆå…ƒç´ ã€æ¨¡å¼ã€å®ˆæŠ¤æ˜Ÿã€åŸå‹ï¼‰ï¼Œç”¨äºæ˜Ÿåº§Ã—MBTIè§£è¯»
        const ZODIAC_META = {
            aries:      { element:'ç«', modality:'æœ¬ä½', rulers:['ç«æ˜Ÿ'], archetype:'æˆ˜å£«/å¼€æ‹“è€…', keywords:['å†²åŠ²','ç›´ç‡','é¢†å¯¼','å†’é™©'] },
            taurus:     { element:'åœŸ', modality:'å›ºå®š', rulers:['é‡‘æ˜Ÿ'], archetype:'å»ºé€ è€…/æ„Ÿå®˜äº«å—', keywords:['ç¨³å®š','åŠ¡å®','ä»·å€¼','è€å¿ƒ'] },
            gemini:     { element:'é£', modality:'å˜åŠ¨', rulers:['æ°´æ˜Ÿ'], archetype:'ä¿¡ä½¿/å­¦ä¹ è€…', keywords:['ä¿¡æ¯','è¿æ¥','æœºæ™º','å¤šå˜'] },
            cancer:     { element:'æ°´', modality:'æœ¬ä½', rulers:['æœˆäº®'], archetype:'å®ˆæŠ¤è€…/æ»‹å…»è€…', keywords:['æƒ…æ„Ÿ','å®‰å…¨','å®¶åº­','è®°å¿†'] },
            leo:        { element:'ç«', modality:'å›ºå®š', rulers:['å¤ªé˜³'], archetype:'åˆ›é€ è€…/ç‹è€…', keywords:['è‡ªæˆ‘è¡¨è¾¾','è£èª‰','èˆå°','æ…·æ…¨'] },
            virgo:      { element:'åœŸ', modality:'å˜åŠ¨', rulers:['æ°´æ˜Ÿ'], archetype:'åŒ äºº/åˆ†æè€…', keywords:['ç»†èŠ‚','ä¿®æ­£','æœåŠ¡','æ•ˆç‡'] },
            libra:      { element:'é£', modality:'æœ¬ä½', rulers:['é‡‘æ˜Ÿ'], archetype:'è°ƒå’Œè€…/å®¡ç¾è€…', keywords:['å…³ç³»','å¹³è¡¡','å…¬æ­£','å®¡ç¾'] },
            scorpio:    { element:'æ°´', modality:'å›ºå®š', rulers:['ç«æ˜Ÿ','å†¥ç‹æ˜Ÿ'], archetype:'è½¬åŒ–è€…/ä¾¦æ¢', keywords:['æ·±åº¦','æ§åˆ¶','æ²‰æ½œ','é‡ç”Ÿ'] },
            sagittarius:{ element:'ç«', modality:'å˜åŠ¨', rulers:['æœ¨æ˜Ÿ'], archetype:'æ¢æ±‚è€…/å“²äºº', keywords:['è¿œè§','è‡ªç”±','çœŸç†','æ—…è¡Œ'] },
            capricorn:  { element:'åœŸ', modality:'æœ¬ä½', rulers:['åœŸæ˜Ÿ'], archetype:'æ”€ç™»è€…/ç®¡ç†è€…', keywords:['ç»“æ„','è´£ä»»','é•¿æœŸ','æƒå¨'] },
            aquarius:   { element:'é£', modality:'å›ºå®š', rulers:['åœŸæ˜Ÿ','å¤©ç‹æ˜Ÿ'], archetype:'é©æ–°è€…/å¼‚ç±»', keywords:['ç†å¿µ','å¹³ç­‰','æœªæ¥','ç‹¬ç«‹'] },
            pisces:     { element:'æ°´', modality:'å˜åŠ¨', rulers:['æœ¨æ˜Ÿ','æµ·ç‹æ˜Ÿ'], archetype:'è¯—äºº/ç¥ç§˜è€…', keywords:['æƒ³è±¡','å…±æƒ…','çµæ€§','èåˆ'] }
        };

        function getTemperament(mbti){
            const s = mbti || '';
            const hasS = s[1] === 'S';
            const hasN = s[1] === 'N';
            const hasT = s[2] === 'T';
            const hasF = s[2] === 'F';
            if (hasS && s[3] === 'J') return 'SJ';
            if (hasS && s[3] === 'P') return 'SP';
            if (hasN && hasF) return 'NF';
            if (hasN && hasT) return 'NT';
            return 'Mixed';
        }

        function buildZodiacMbtiInsight(mbtiType, signKey){
            const meta = ZODIAC_META[signKey];
            if (!meta) return '';
            const temper = getTemperament(mbtiType);
            const e = meta.element; // ç«åœŸé£æ°´
            const m = meta.modality; // æœ¬ä½å›ºå®šå˜åŠ¨

            // å…ƒç´ Ã—æ°”è´¨ç®€è¯„
            const elementFitMap = {
                'ç«': { fit: ['E','N','P'], tip: 'è¡ŒåŠ¨/æ„¿æ™¯/å°æ–°' },
                'åœŸ': { fit: ['S','J','T'], tip: 'ç»“æ„/åŠ¡å®/å¯æŒç»­' },
                'é£': { fit: ['E','N','T','P'], tip: 'äº¤æµ/ç†å¿µ/çµæ´»' },
                'æ°´': { fit: ['I','N','F'], tip: 'æƒ…æ„Ÿ/å…±é¸£/æƒ³è±¡' }
            };
            const modalityFitMap = {
                'æœ¬ä½': { fit: ['J','E'], tip: 'å¯åŠ¨/å¸¦å¤´/å®šç›®æ ‡' },
                'å›ºå®š': { fit: ['J','T','I'], tip: 'ä¸“æ³¨/ç¨³å›º/æŠ—å¹²æ‰°' },
                'å˜åŠ¨': { fit: ['P','N'], tip: 'é€‚åº”/å¤šå˜/æ¢ç´¢' }
            };
            const ef = elementFitMap[e] || { fit: [], tip: '' };
            const mf = modalityFitMap[m] || { fit: [], tip: '' };

            const matches = (need) => need.filter(ch => mbtiType.includes(ch));
            const eMatch = matches(ef.fit);
            const mMatch = matches(mf.fit);

            // æ°”è´¨æè¿°
            const temperDesc = {
                SJ: 'ç§©åºä¸è´£ä»»ï¼ˆå®ˆæŠ¤è€…ï¼‰',
                SP: 'ä½“éªŒä¸å®æ“ï¼ˆå·¥åŒ /ç©å®¶ï¼‰',
                NF: 'æ„ä¹‰ä¸å…³ç³»ï¼ˆç†æƒ³ä¸»ä¹‰è€…ï¼‰',
                NT: 'é€»è¾‘ä¸ç³»ç»Ÿï¼ˆç†æ€§ä¸»ä¹‰è€…ï¼‰',
                Mixed: 'å¤šå…ƒå–å‘ï¼ˆæ··åˆå€¾å‘ï¼‰'
            }[temper];

            const ruler = (ZODIAC_META[signKey].rulers || []).join('ã€');
            const keywords = (ZODIAC_META[signKey].keywords || []).join('ã€');

            return `
                <div class="card">
                    <div class="pill">æ˜Ÿåº§Ã—MBTI äº¤å‰æ´å¯Ÿ</div>
                    <p class="muted" style="margin-top:6px">å…ƒç´ ï¼š${e}ï½œæ¨¡å¼ï¼š${m}ï½œå®ˆæŠ¤æ˜Ÿï¼š${ruler}</p>
                    <div class="grid">
                        <div class="card">
                            <div class="pill">å…ƒç´ ååŒ</div>
                            <p class="muted">ä¸ä½ çš„ç±»å‹(${mbtiType})çš„åŒ¹é…ç‚¹ï¼š${eMatch.join('ã€') || 'â€”'}ã€‚å€¾å‘ï¼š${ef.tip}</p>
                        </div>
                        <div class="card">
                            <div class="pill">æ¨¡å¼ååŒ</div>
                            <p class="muted">ä¸ä½ çš„ç±»å‹(${mbtiType})çš„åŒ¹é…ç‚¹ï¼š${mMatch.join('ã€') || 'â€”'}ã€‚å€¾å‘ï¼š${mf.tip}</p>
                        </div>
                        <div class="card">
                            <div class="pill">æ°”è´¨æ˜ å°„</div>
                            <p class="muted">ä½ çš„MBTIæ°”è´¨ï¼š${temperDesc}ï¼›æ˜Ÿåº§å…³é”®è¯ï¼š${keywords || 'â€”'}</p>
                        </div>
                    </div>
                    <p class="muted" style="margin-top:6px">æç¤ºï¼šè¯¥è§£è¯»åŸºäºå æ˜Ÿï¼ˆå…ƒç´ /æ¨¡å¼/å®ˆæŠ¤æ˜Ÿï¼‰ä¸MBTIæ°”è´¨çš„å¯å‘å¼æ˜ å°„ï¼Œä¾›è‡ªæˆ‘æ¢ç´¢å‚è€ƒã€‚</p>
                </div>
            `;
        }

        let selectedSign = null;

        // MBTI ç±»å‹çŸ¥è¯†åº“ï¼ˆæ‘˜è¦/åŠŸèƒ½å †æ ˆ/ä¼˜åŠ¿/é£é™©/å·¥ä½œé£æ ¼/èŒä¸š/ä»£è¡¨äººç‰©ï¼‰
        const TYPE_KB = {
            INTJ: { summary:'æˆ˜ç•¥å‹è§„åˆ’è€…ï¼Œé•¿æœŸæ„¿æ™¯ä¸ç³»ç»ŸåŒ–æ¨è¿›å¹¶é‡ã€‚', funcs:['Ni','Te','Fi','Se'], strengths:['å‰ç»è§„åˆ’','ç»“æ„åŒ–æ€ç»´','ç‹¬ç«‹è‡ªé©±','é«˜æ ‡å‡†'], risks:['æ²Ÿé€šç”Ÿç¡¬','å¿½è§†æƒ…ç»ª','å®Œç¾ä¸»ä¹‰','å›ºæ‰§è·¯çº¿'], work:['åå¥½ç›®æ ‡æ¸…æ™°ã€å¯è¡¡é‡äº§å‡º','å–œæ¬¢æ·±åº¦ç‹¬å¤„ä¸é•¿å‘¨æœŸç ”ç©¶','é‡è§†æ•ˆç‡ä¸å¯å¤ç”¨ä½“ç³»'], careers:['æˆ˜ç•¥/å’¨è¯¢','äº§å“/æ¶æ„','ç§‘ç ”/æ•°æ®','æŠ•ç ”/è¿è¥ä¼˜åŒ–'], figures:['Elon Musk(æ¨æµ‹)','J.K.ç½—ç³(æ¨æµ‹)'] },
            INTP: { summary:'æ¦‚å¿µå‹é—®é¢˜æ±‚è§£è€…ï¼Œçƒ­è¡·åŸç†å»ºæ¨¡ä¸æŠ½è±¡ä¼˜åŒ–ã€‚', funcs:['Ti','Ne','Si','Fe'], strengths:['é€»è¾‘å‰–æ','æ¨¡å‹æ­å»º','åˆ›æ–°ç‚¹å­','å­¦ä¹ é€Ÿåº¦å¿«'], risks:['æ‹–å»¶å€¾å‘','äº¤ä»˜ä¸ç¨³','å¿½è§†ç»†èŠ‚','ç¤¾äº¤èƒ½é‡ä½'], work:['å–œæ¬¢è‡ªç”±æ¢ç´¢ä¸æŠ€æœ¯éš¾é¢˜','éœ€è¦ä½å¹²æ‰°ã€å¯è¯•é”™ç©ºé—´','åŒæ¶é‡å¤æµç¨‹ä¸å®˜åƒš'], careers:['ç®—æ³•/ç ”ç©¶','ç³»ç»Ÿè®¾è®¡','Dev/DevRel','æ•°æ®åˆ†æ'], figures:['çˆ±å› æ–¯å¦(æ¨æµ‹)','æ‹‰é‡ŒÂ·ä½©å¥‡(æ¨æµ‹)'] },
            ENTJ: { summary:'æ‰§è¡Œå‹é¢†å¯¼è€…ï¼Œç›®æ ‡å¯¼å‘ä¸èµ„æºç»Ÿç­¹å…¼å¤‡ã€‚', funcs:['Te','Ni','Se','Fi'], strengths:['å†³ç­–æœæ–­','ç»„ç»‡è°ƒåº¦','ç»“æœå¯¼å‘','æŠ—å‹æ¨è¿›'], risks:['å¼ºåŠ¿æ§åˆ¶','åŒç†ä¸è¶³','æ€¥äºæ±‚æˆ','å¿½è§†é£é™©è¾¹ç•Œ'], work:['åå¥½å¤šå›¢é˜Ÿåä½œå’Œè§„æ¨¡åŒ–','çœ‹é‡KPIä¸æ˜ç¡®è´£æƒ','é€‚åˆå¤æ‚é¡¹ç›®ä¸å˜é©'], careers:['ç®¡ç†/è¿è¥','æˆ˜ç•¥/é”€å”®','æŠ•è¡Œ/å’¨è¯¢','å¢é•¿/ToB'], figures:['å¼ ç‘æ•(æ¨æµ‹)','Jeff Bezos(æ¨æµ‹)'] },
            ENTP: { summary:'è¾©æ€å‹åˆ›å˜è€…ï¼Œç‚¹å­å¯†é›†ä¸è·¨åŸŸè¿æ¥èƒ½åŠ›å¼ºã€‚', funcs:['Ne','Ti','Fe','Si'], strengths:['åˆ›æ„çˆ†å‘','è·¨ç•Œè”æƒ³','åº”å˜å¿«','è¯´æœåŠ›å¼º'], risks:['åç»§ä¹åŠ›','æ³¨æ„åŠ›è·³è·ƒ','ä¸çˆ±æ”¶å°¾','æŒ‘æˆ˜æƒå¨'], work:['å–œæ¬¢0â†’1ä¸è¯•éªŒç”°','éœ€è¦å¼¹æ€§ä¸èˆå°','å¯¹æ–°å¥‡/ç«äº‰æ•æ„Ÿ'], careers:['åˆ›æ–°/äº§å“','åˆ›ä¸š/å¸‚åœº','å’¨è¯¢/åª’ä½“','å¢é•¿/BD'], figures:['å²è’‚å¤«Â·ä¹”å¸ƒæ–¯(æ¨æµ‹)','é©¬æ–¯å…‹(æ¨æµ‹)'] },
            INFJ: { summary:'æ´å¯Ÿå‹è¾…å¯¼è€…ï¼Œä»·å€¼é©±åŠ¨ä¸ä½“ç³»åŒ–å…³æ€€ã€‚', funcs:['Ni','Fe','Ti','Se'], strengths:['æ´å¯Ÿäººå¿ƒ','ä»·å€¼å¼•å¯¼','é•¿æœŸé™ªä¼´','æ•´åˆè§†è§’'], risks:['ç†æƒ³ä¸»ä¹‰æŒ«è´¥','è¿‡åº¦å…±æƒ…','è¡¨è¾¾å«è“„','èƒ½é‡æ˜“è€—'], work:['åå¥½æ·±åº¦ä¸€å¯¹ä¸€æˆ–å°å›¢ä½“','éœ€è¦æ„ä¹‰æ„Ÿä¸ä¸€è‡´ä»·å€¼','é€‚åˆé•¿æœŸå½±å“å·¥ä½œ'], careers:['å¿ƒç†/æ•™è‚²','å“ç‰Œ/å†…å®¹','éè¥åˆ©/äººåŠ›','å’¨è¯¢/æ•™ç»ƒ'], figures:['å¡å°”Â·è£æ ¼(æ¨æµ‹)','ç”˜åœ°(æ¨æµ‹)'] },
            INFP: { summary:'ç†æƒ³å‹åˆ›ä½œè€…ï¼Œå†…åœ¨ä»·å€¼ä¸çœŸå®è¡¨è¾¾ä¼˜å…ˆã€‚', funcs:['Fi','Ne','Si','Te'], strengths:['çœŸè¯šå…±æƒ…','åˆ›ä½œè¡¨è¾¾','ä»·å€¼æ•æ„Ÿ','åšæŒåˆå¿ƒ'], risks:['æ‰§è¡Œæ¾æ•£','å›é¿å†²çª','æŠ—å‹è¾ƒå¼±','ç°å®å¦¥åéš¾'], work:['éœ€è¦ä»·å€¼ä¸€è‡´ä¸åˆ›ä½œç©ºé—´','åæ„Ÿé«˜å‹æµç¨‹åŒ–','é€‚åˆå†…å®¹ä¸ç”¨æˆ·ä½“éªŒ'], careers:['å†™ä½œ/è®¾è®¡','å†…å®¹/ç”¨æˆ·ç ”ç©¶','å…¬ç›Š/æ•™è‚²','äº§å“ä½“éªŒ'], figures:['æ‘ä¸Šæ˜¥æ ‘(æ¨æµ‹)','æ‰˜å°”é‡‘(æ¨æµ‹)'] },
            ENFJ: { summary:'å‡èšå‹æ¨åŠ¨è€…ï¼Œäººç¾¤åŠ¨å‘˜ä¸æˆé•¿èµ‹èƒ½ã€‚', funcs:['Fe','Ni','Se','Ti'], strengths:['æ¿€å‘æ½œèƒ½','ç»„ç»‡æ°›å›´','æ²Ÿé€šå…±è¯†','é•¿æœŸåŸ¹å…»'], risks:['å¿½è§†è‡ªæˆ‘','è¿‡åº¦æ‰¿æ‹…','è®¨å¥½å‹åŠ›','ç†æ€§ä¸è¶³'], work:['æ“…é•¿æ­å»ºåä½œæœºåˆ¶','é‡è§†æ–‡åŒ–ä¸èŠ‚å¥','é€‚åˆæ•™ç»ƒå’Œç®¡ç†'], careers:['HR/ç»„ç»‡å‘å±•','æ•™è‚²/åŸ¹è®­','å¸‚åœº/ç¤¾åŒº','å…¬ç›Š/è¿è¥'], figures:['å¥¥æ™®æ‹‰(æ¨æµ‹)','é©¬ä¸Â·è·¯å¾·Â·é‡‘(æ¨æµ‹)'] },
            ENFP: { summary:'å¯å‘å‹ä¼ æ’­è€…ï¼Œçµæ„Ÿã€è¿æ¥ä¸æ¢ç´¢é©±åŠ¨ã€‚', funcs:['Ne','Fi','Te','Si'], strengths:['åˆ›æ„è¿æ¥','åŒç†é¼“èˆ','å­¦ä¹ å¿«','æœºåŠ¨é€‚åº”'], risks:['éš¾ä»¥èšç„¦','æ‰§è¡Œåˆ†æ•£','æŠ—æ‹’çº¦æŸ','æƒ…ç»ªèµ·ä¼'], work:['å–œæ¬¢å¤šæ ·ä¸äººé™…äº’åŠ¨','éœ€è¦è‡ªç”±ä¸è®¤å¯','é€‚åˆå“ç‰Œä¸å¢é•¿'], careers:['å†…å®¹/å“ç‰Œ','å¢é•¿/åª’ä½“','äº§å“/ç”¨æˆ·','å…¬å…³/BD'], figures:['ç½—å®¾Â·å¨å»‰å§†æ–¯(æ¨æµ‹)','å¥¥å·´é©¬(æ¨æµ‹)'] },
            ISTJ: { summary:'ç§©åºå‹æ‰§è¡Œè€…ï¼Œå¯é ã€ä¸¥è°¨ã€ç¨³å®šæ¨è¿›ã€‚', funcs:['Si','Te','Fi','Ne'], strengths:['æµç¨‹åŒ–','é£é™©æ§åˆ¶','ç¨³å¥äº¤ä»˜','è´£ä»»å¿ƒå¼º'], risks:['ä¿å®ˆåƒµåŒ–','åˆ›æ–°ä¸è¶³','æ²Ÿé€šç›´æ¥','é€‚åº”æ…¢'], work:['åå¥½æ ‡å‡†ä¸è§„èŒƒ','æ“…é•¿é•¿æœŸç»´æŠ¤ä¸è´¨é‡','é€‚åˆå¤æ‚åå‹¤ä½“ç³»'], careers:['è´¨æ§/æ³•åŠ¡','è´¢åŠ¡/å®¡è®¡','è¿ç»´/é¡¹ç›®','å…¬åŠ¡/è¡Œæ”¿'], figures:['æ²ƒä¼¦Â·å·´è²ç‰¹(æ¨æµ‹)','æµ·å†›å†›å®˜å…¸å‹'] },
            ISFJ: { summary:'å®ˆæŠ¤å‹æœåŠ¡è€…ï¼Œç»†è‡´ä½“è´´ä¸ç¨³å®šæ”¯æ’‘ã€‚', funcs:['Si','Fe','Ti','Ne'], strengths:['ç¨³å®šå¯é ','ä½“å¯Ÿéœ€æ±‚','è®°å¿†ç»†èŠ‚','è€å¿ƒå‹¤å‹‰'], risks:['å›é¿å†²çª','éš¾æ‹’ç»','åˆ›æ–°åå¼±','è‡ªæˆ‘è¡¨è¾¾å°‘'], work:['åå¥½æ˜ç¡®èŒè´£ä¸åä½œ','æ“…é•¿å®¢æˆ·ä¸å†…éƒ¨æ”¯æŒ','é€‚åˆæœåŠ¡å¯†é›†å²—ä½'], careers:['æŠ¤ç†/æ•™è‚²','å®¢æˆ·æˆåŠŸ','è¡Œæ”¿/å†…å‹¤','è¿è¥/ç¤¾æœ'], figures:['å‡¯ç‰¹Â·ç±³å¾·å°”é¡¿(æ¨æµ‹)'] },
            ESTJ: { summary:'æŒ‡æŒ¥å‹è½å®è€…ï¼Œç»“æ„ä¸æ•ˆç‡çš„ä»£è¨€äººã€‚', funcs:['Te','Si','Ne','Fi'], strengths:['å¼ºæ‰§è¡ŒåŠ›','æµç¨‹ä¼˜åŒ–','å…¬å¹³å®¢è§‚','æŠ—å‹ç¨³'], risks:['å¼ºç¡¬/æ§åˆ¶','å¯¹äººæƒ…æ„ŸçŸ¥å¼±','ä¸è€ä½æ•ˆ','ä¿å®ˆè·¯å¾„ä¾èµ–'], work:['åå¥½æ¸…æ™°KPIä¸èŒè´£','æ“…é•¿è§„æ¨¡åŒ–ä¸ç®¡ç†','é€‚åˆæµç¨‹æ”¹é€ ä¸äº¤ä»˜'], careers:['è¿è¥/ç®¡ç†','ä¾›åº”é“¾/åˆ¶é€ ','é¡¹ç›®/PMO','æ”¿åŠ¡/å†›è­¦'], figures:['Indra Nooyi(æ¨æµ‹)','Tim Cook(æ¨æµ‹)'] },
            ESFJ: { summary:'ååŒå‹ç…§æŠ¤è€…ï¼Œå…³ç³»ç»´æŠ¤ä¸ç§©åºå®ˆæŠ¤ã€‚', funcs:['Fe','Si','Ne','Ti'], strengths:['äººé™…å’Œè°','æœåŠ¡æ„è¯†','ç»„ç»‡ç»†èŠ‚','æ‰§è¡Œç¨³å®š'], risks:['è¿‡åº¦åœ¨æ„è¯„ä»·','ä¿å®ˆä»ä¼—','éš¾æ‹’ç»','é€ƒé¿å†²çª'], work:['åå¥½å›¢é˜Ÿä¸æ˜ç¡®æµç¨‹','é‡è§†æ°›å›´ä¸å…¬å¹³','é€‚åˆå¤§å›¢é˜Ÿè¿è¥'], careers:['äººäº‹/è¡Œæ”¿','å®¢æˆ·/ç¤¾åŒº','æ•™è‚²/æŠ¤ç†','æ´»åŠ¨/è¿è¥'], figures:['æ³°å‹’Â·æ–¯å¨å¤«ç‰¹(æ¨æµ‹)'] },
            ISTP: { summary:'å†·é™å‹å·¥åŒ ï¼ŒåŠ¨æ‰‹è§£å†³ç°å®é—®é¢˜ã€‚', funcs:['Ti','Se','Ni','Fe'], strengths:['å¿«é€Ÿå®šä½æ•…éšœ','å®æ“èƒ½åŠ›å¼º','ä¸´åœºååº”å¥½','å®¢è§‚å†·é™'], risks:['æ²Ÿé€šç®€çŸ­','è§„åˆ™æ·¡è–„','é•¿æœŸè§„åˆ’å¼±','æƒ…æ„Ÿè¡¨è¾¾å°‘'], work:['åå¥½å®é™…é—®é¢˜ä¸å·¥å…·','å–œæ¬¢ç‹¬ç«‹ä¸å³æ—¶åé¦ˆ','é€‚åˆå±æœºå¤„ç†åœºæ™¯'], careers:['å·¥ç¨‹/å®‰é˜²','è¿ç»´/åº”æ€¥','å¤–ç§‘/æœºæ¢°','äº¤æ˜“/ç«æŠ€'], figures:['æå°é¾™(æ¨æµ‹)','F1è½¦æ‰‹å…¸å‹'] },
            ISFP: { summary:'æ¸©æŸ”å‹ä½“éªŒè€…ï¼Œå®¡ç¾ã€æ‰‹ä½œä¸çœŸå®æ„Ÿå—ã€‚', funcs:['Fi','Se','Ni','Te'], strengths:['å®¡ç¾æ•é”','çœŸè¯šæ¸©å’Œ','ä½“éªŒå¯¼å‘','ä¸“æ³¨å½“ä¸‹'], risks:['è®¡åˆ’æ€§å¼±','å›é¿ç¡¬ç¢°','æŠ—å‹è¾ƒå·®','è¡¨è¾¾å«è“„'], work:['åå¥½å°å›¢é˜Ÿä¸ä½œå“å‘ˆç°','éœ€è¦ç©ºé—´ä¸å°Šé‡','é€‚åˆè®¾è®¡ä¸æ‰‹ä½œ'], careers:['è§†è§‰/UI','æ‘„å½±/æ‰‹ä½œ','å†…å®¹/ä½“éªŒ','æŠ¤å·¥/åº·å¤'], figures:['å®«å´éª(æ¨æµ‹)'] },
            ESTP: { summary:'è¡ŒåŠ¨å‹å®å¹²å®¶ï¼Œç°åœºååº”ä¸å½±å“åŠ›å¼ºã€‚', funcs:['Se','Ti','Fe','Ni'], strengths:['å¿«é€Ÿå†³æ–­','èµ„æºæ•´åˆ','è°ˆåˆ¤è¯´æœ','ç»“æœå¯¼å‘'], risks:['çŸ­è§†å†’é™©','åç»­ç»´æŠ¤å¼±','æƒå¨å†²çª','è€å¿ƒä¸è¶³'], work:['å–œæ¬¢é«˜èŠ‚å¥ä¸åšå¼ˆ','åœ¨ç°åœºæ›´å‡ºå½©','é€‚åˆé”€å”®ä¸çªå‡»ä»»åŠ¡'], careers:['é”€å”®/äº¤æ˜“','å…¬å…³/è°ˆåˆ¤','åº”æ€¥/æ•‘æ´','è¿è¥/è¿åŠ¨'], figures:['ä¹”ä¸¹(æ¨æµ‹)','æ ¼å…°ç‰¹Â·å¡å°”ç™»(æ¨æµ‹)'] },
            ESFP: { summary:'æ´»åŠ›å‹è¡¨æ¼”è€…ï¼Œæ„ŸæŸ“åŠ›ä¸äººæ°”ä¸­å¿ƒã€‚', funcs:['Se','Fi','Te','Ni'], strengths:['ç¤¾äº¤é©±åŠ¨','æ°›å›´æ‰“é€ ','å½“ä¸‹æ´å¯Ÿ','é€‚åº”åŠ›å¼º'], risks:['éš¾ä»¥é•¿æœŸåšæŒ','ç®¡ç†å¼±','æƒ…ç»ªæ³¢åŠ¨','æŠ—å‹ä¸è¶³'], work:['å–œæ¬¢äº’åŠ¨ä¸èˆå°','éœ€è¦å³æ—¶åé¦ˆ','é€‚åˆå“ç‰Œä¸æ´»åŠ¨'], careers:['æ¼”è‰º/ä¸»æ’­','å¸‚åœº/æ´»åŠ¨','å®¢æœ/è¿è¥','æ—…æ¸¸/ä½“è‚²'], figures:['éº¦å½“å¨œ(æ¨æµ‹)','ç»¼è‰ºä¸»æŒå…¸å‹'] }
        };

        function buildTypeDetail(mbti){
            const info = TYPE_KB[mbti];
            if (!info) return '';
            const funcs = info.funcs.join(' â†’ ');
            const renderList = (arr) => arr.map(x=>`<li>${x}</li>`).join('');
            return `
                <div class="card">
                    <div class="pill">ç±»å‹ç»¼è¿°</div>
                    <p class="muted" style="margin-top:6px">${info.summary}</p>
                    <div class="grid" style="margin-top:8px">
                        <div class="card"><div class="pill">åŠŸèƒ½å †æ ˆ</div><p class="muted">${funcs}</p></div>
                        <div class="card"><div class="pill">ä¼˜åŠ¿</div><ul class="muted" style="margin:6px 0 0 18px">${renderList(info.strengths)}</ul></div>
                        <div class="card"><div class="pill">æ½œåœ¨é£é™©</div><ul class="muted" style="margin:6px 0 0 18px">${renderList(info.risks)}</ul></div>
                        <div class="card"><div class="pill">å·¥ä½œé£æ ¼</div><ul class="muted" style="margin:6px 0 0 18px">${renderList(info.work)}</ul></div>
                    </div>
                    <div class="grid" style="margin-top:8px">
                        <div class="card"><div class="pill">é€‚åˆèŒä¸š</div><p class="muted">${info.careers.join('ã€')}</p></div>
                        <div class="card"><div class="pill">ä»£è¡¨äººç‰©ï¼ˆæ¨æµ‹ï¼‰</div><p class="muted">${info.figures.join('ã€')}</p></div>
                    </div>
                </div>
            `;
        }

        function $(sel){ return document.querySelector(sel); }

        function show(section){
            ['#welcome','#testing','#result'].forEach(id=>$(id).classList.add('hidden'));
            $(section).classList.remove('hidden');
        }

        function startTest(){
            console.log('å¼€å§‹ä¸“ä¸šMBTIæµ‹è¯•');
            currentIndex = 0;
            selections.fill(null);
            Object.keys(scores).forEach(k => scores[k] = 0);
            renderQuestion();
            show('#testing');
        }

        function renderQuestion(){
            // æ¸…ç†è‡ªåŠ¨å‰è¿›
            if (autoAdvanceTimer) { clearTimeout(autoAdvanceTimer); autoAdvanceTimer = null; }
            const q = QUESTIONS[currentIndex];
            $('#qText').textContent = `${currentIndex+1}. ${q.t}`;
            const opts = $('#opts');
            opts.innerHTML = '';
            [q.a, q.b].forEach((opt, idx) => {
                const div = document.createElement('div');
                div.className = 'opt' + (selections[currentIndex] === opt.v ? ' selected' : '');
                div.setAttribute('role','button');
                div.tabIndex = 0;
                div.innerHTML = `${opt.text}`;
                div.onclick = () => selectOption(opt.v, q.d);
                div.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); selectOption(opt.v); } };
                opts.appendChild(div);
            });
            $('#prevBtn').disabled = currentIndex === 0;
            $('#nextBtn').textContent = currentIndex === QUESTIONS.length - 1 ? 'æäº¤' : 'ä¸‹ä¸€é¢˜';
            $('#nextBtn').disabled = selections[currentIndex] == null;
            const pct = Math.round(((currentIndex) / QUESTIONS.length) * 100);
            $('#pbar').style.width = `${pct}%`;
            $('#ptext').textContent = `${currentIndex}/${QUESTIONS.length}`;
            // éšè—è§£æ
            const ins = $('#insight');
            if (ins) { ins.classList.add('hidden'); ins.textContent=''; }
        }

        function selectOption(val, dim){
            selections[currentIndex] = val;
            // é«˜äº®é€‰é¡¹
            const opts = $('#opts').children;
            Array.from(opts).forEach(el => el.classList.remove('selected'));
            const chosen = Array.from(opts).find(el => el.textContent.trim());
            // å±•ç¤ºæ™ºèƒ½è§£æ
            showInsight(dim || QUESTIONS[currentIndex].d, val);
            // å¯ç”¨ä¸‹ä¸€é¢˜æŒ‰é’®
            $('#nextBtn').disabled = false;
            // è‡ªåŠ¨å‰è¿›ï¼ˆå»¶è¿Ÿ 600msï¼‰
            if (autoAdvanceTimer) clearTimeout(autoAdvanceTimer);
            autoAdvanceTimer = setTimeout(() => { next(); }, 600);
        }

        function showInsight(dim, v){
            const ins = $('#insight');
            if (!ins) return;
            const explain = INSIGHT[dim]?.[v] || '';
            // å½“å‰ç»´åº¦å®æ—¶å¯¹æ¯”
            const mapDim = { EI:['E','I'], SN:['S','N'], TF:['T','F'], JP:['J','P'] };
            const [a,b] = mapDim[dim] || [];
            let aCnt = 0, bCnt = 0, aTot=0;
            QUESTIONS.forEach((q, i) => {
                if (q.d !== dim) return;
                aTot++;
                const sel = selections[i];
                if (sel === a) aCnt++;
                else if (sel === b) bCnt++;
            });
            const aPct = aTot? Math.round(100*aCnt/aTot):0;
            const bPct = aTot? Math.round(100*bCnt/aTot):0;
            const label = {
                EI: ['å¤–å‘ E','å†…å‘ I'],
                SN: ['æ„Ÿè§‰ S','ç›´è§‰ N'],
                TF: ['æ€è€ƒ T','æƒ…æ„Ÿ F'],
                JP: ['åˆ¤æ–­ J','æ„ŸçŸ¥ P']
            }[dim] || [a,b];

            ins.innerHTML = `${explain}<br><span class="muted">å½“å‰ç»´åº¦å€¾å‘ï¼š${label[0]} ${aPct}% Â· ${label[1]} ${bPct}%</span>`;
            ins.classList.remove('hidden','fade');
            // æ¸éšæ•ˆæœï¼ˆä¸é˜»ç¢å‰è¿›ï¼‰
            setTimeout(()=> ins.classList.add('fade'), 1200);
            setTimeout(()=> { ins.classList.add('hidden'); ins.classList.remove('fade'); }, 1700);
        }

        function next(){
            if (selections[currentIndex] == null) return;
            if (currentIndex === QUESTIONS.length - 1) { submit(); return; }
            if (autoAdvanceTimer) { clearTimeout(autoAdvanceTimer); autoAdvanceTimer = null; }
            currentIndex += 1;
            renderQuestion();
        }

        function prev(){
            if (currentIndex === 0) return;
            if (autoAdvanceTimer) { clearTimeout(autoAdvanceTimer); autoAdvanceTimer = null; }
            currentIndex -= 1;
            renderQuestion();
        }

        function submit(){
            console.log('æäº¤MBTIæµ‹è¯•ç»“æœ');
            
            // ç´¯è®¡åˆ†æ•°
            Object.keys(scores).forEach(k => scores[k] = 0);
            selections.forEach((val, i) => { if (val) scores[val] += 1; });
            const getPair = (a,b) => scores[a] >= scores[b] ? a : b;
            const type = [ getPair('E','I'), getPair('S','N'), getPair('T','F'), getPair('J','P') ].join('');

            // ç™¾åˆ†æ¯”ï¼ˆç›¸å¯¹äºè¯¥ç»´åº¦é¢˜ç›®æ•°é‡ï¼‰
            const countByDim = { EI:0, SN:0, TF:0, JP:0 };
            QUESTIONS.forEach(q => countByDim[q.d] += 1);
            const pct = {
                E: Math.round(100 * scores.E / countByDim.EI),
                I: Math.round(100 * scores.I / countByDim.EI),
                S: Math.round(100 * scores.S / countByDim.SN),
                N: Math.round(100 * scores.N / countByDim.SN),
                T: Math.round(100 * scores.T / countByDim.TF),
                F: Math.round(100 * scores.F / countByDim.TF),
                J: Math.round(100 * scores.J / countByDim.JP),
                P: Math.round(100 * scores.P / countByDim.JP)
            };

            // æ¸²æŸ“ç»“æœ
            $('#type').textContent = type;
            $('#ztype').textContent = type; // ä½¿ç”¨ç›¸åŒçš„ç±»å‹ï¼Œå› ä¸ºè¿™æ˜¯çº¯MBTIæµ‹è¯•
            $('#zsummary').innerHTML = 'ä¸“ä¸šMBTIåˆ†æç»“æœ';
            
            $('#breakdown').innerHTML = `
                <div class="grid">
                    <div class="card"><div class="pill">å¤–å‘ E / å†…å‘ I</div><p class="muted">E ${pct.E}% Â· I ${pct.I}%</p></div>
                    <div class="card"><div class="pill">æ„Ÿè§‰ S / ç›´è§‰ N</div><p class="muted">S ${pct.S}% Â· N ${pct.N}%</p></div>
                    <div class="card"><div class="pill">æ€è€ƒ T / æƒ…æ„Ÿ F</div><p class="muted">T ${pct.T}% Â· F ${pct.F}%</p></div>
                    <div class="card"><div class="pill">åˆ¤æ–­ J / æ„ŸçŸ¥ P</div><p class="muted">J ${pct.J}% Â· P ${pct.P}%</p></div>
                </div>
            `;
            
            // MBTIç±»å‹è¯¦è§£
            const detailHtml = buildTypeDetail(type);
            const detail = document.getElementById('typeDetail');
            if (detail) detail.innerHTML = detailHtml;

            show('#result');
        }

        function restart(){
            currentIndex = -1;
            selections.fill(null);
            Object.keys(scores).forEach(k => scores[k] = 0);
            show('#welcome');
        }
    </script>
    <link rel="icon" href="data:,">
    <meta name="color-scheme" content="light dark">
</head>
<body>
            <div class="header">
            <div class="container">
                <h1>ğŸ§  ä¸“ä¸šMBTIæµ‹è¯•</h1>
                <p>åŸºäºè£æ ¼ç†è®ºçš„16ç§äººæ ¼ç±»å‹ä¸“ä¸šæµ‹è¯•ï¼Œå¿«é€Ÿå‡†ç¡® Â· çº¦ 3-5 åˆ†é’Ÿ Â· 12 é¢˜ Â· æœ¬åœ°è®¡ç®—</p>
            </div>
        </div>

    <div class="container">
        <!-- æ¬¢è¿é¡µ -->
        <div id="welcome" class="card">
            <h2 class="center" style="margin-top:0">å¼€å§‹ä¹‹å‰</h2>
            <p class="muted">
                æ ¹æ®ä½ çš„åå¥½åœ¨ä¸¤é¡¹ä¸­æ‹©ä¸€ã€‚è¯·å‡­ç¬¬ä¸€ååº”ä½œç­”ï¼Œæ²¡æœ‰æ­£ç¡®æˆ–é”™è¯¯çš„é€‰é¡¹ã€‚
            </p>
            
            <div class="card" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 1px solid #f59e0b; margin: 16px 0;">
                <h3 style="margin: 0 0 8px; color: #92400e;">ğŸŒŸ ä¸“ä¸šMBTIæµ‹è¯•ç‰¹è‰²</h3>
                <p style="margin: 0; color: #92400e; font-size: 14px;">
                    æœ¬æµ‹è¯•åŸºäºè£æ ¼ç†è®ºï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„12é“é¢˜ç›®ï¼Œå¿«é€Ÿå‡†ç¡®åœ°åˆ†æä½ çš„MBTIäººæ ¼ç±»å‹ã€‚æµ‹è¯•å®Œæˆåï¼Œä½ å°†è·å¾—ï¼š
                </p>
                <ul style="margin: 8px 0 0 18px; color: #92400e; font-size: 14px;">
                    <li>æ ‡å‡†MBTIå››ç»´åº¦åˆ†æ</li>
                    <li>ä¸“ä¸šçš„äººæ ¼ç±»å‹è§£è¯»</li>
                    <li>ä¸ªæ€§åŒ–çš„å‘å±•å»ºè®®</li>
                    <li>èŒä¸šé€‚é…æ€§åˆ†æ</li>
                </ul>
                
                <div style="margin-top: 12px;">
                    <p style="color: #92400e; font-size: 14px; margin: 0;">
                        ğŸ’¡ æœ¬æµ‹è¯•åŸºäºå¿ƒç†å­¦ç†è®ºï¼Œé€šè¿‡ç§‘å­¦æ–¹æ³•åˆ†æä½ çš„æ€§æ ¼ç‰¹å¾
                    </p>
                </div>
            </div>
            
            <div class="center" style="margin-top:16px">
                <button class="btn" type="button" onclick="startTest()">å¼€å§‹æµ‹è¯•</button>
                <a class="link" href="index.html" style="margin-left:12px">è¿”å›é¦–é¡µ</a>
            </div>
        </div>

        <!-- æµ‹è¯•é¡µ -->
        <div id="testing" class="card hidden">
            <div class="progress"><div id="pbar" class="progress-bar"></div></div>
            <div class="muted" id="ptext">0/12</div>
            <div id="qText" class="q-text">é¢˜å¹²</div>
            <div id="insight" class="insight hidden"></div>
            <div id="opts"></div>
            <div class="nav">
                <button id="prevBtn" class="btn btn-secondary" type="button" onclick="prev()">ä¸Šä¸€é¢˜</button>
                <button id="nextBtn" class="btn" type="button" onclick="next()">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- ç»“æœé¡µ -->
        <div id="result" class="card hidden">
            <div class="center">
                <div class="pill">ä½ çš„ MBTI ç±»å‹</div>
                <div id="type" class="result-type">XXXX</div>
                <p class="muted">ä¸‹é¢æ˜¯å››ä¸ªç»´åº¦çš„åˆ†å¸ƒæƒ…å†µï¼š</p>
                <div style="margin-top:8px"></div>
                <div class="pill">ä¸“ä¸šåˆ†æç»“æœ</div>
                <div id="ztype" class="result-type" style="font-size:28px; color:#10b981">XXXX</div>
                <div id="zsummary" class="muted" style="margin-top:6px"></div>
            </div>
            <div id="breakdown" style="margin-top:12px"></div>
            <div id="typeDetail" style="margin-top:12px"></div>
            <div class="center" style="margin-top:16px">
                <button class="btn" type="button" onclick="restart()">é‡æ–°æµ‹è¯•</button>
                <a class="link" href="index.html" style="margin-left:12px">è¿”å›é¦–é¡µ</a>
            </div>
        </div>
    </div>
</body>
</html>


