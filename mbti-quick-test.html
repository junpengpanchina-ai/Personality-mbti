<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional MBTI Test - 16 Personality Types (Jungian-based)</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #1f2937;
        }
        .container { max-width: 900px; margin: 0 auto; padding: 24px; }
        .card {
            background: rgba(255,255,255,0.98);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(0,0,0,0.05);
        }
        .header { text-align: center; color: #fff; margin: 24px 0; }
        .header h1 { margin: 0 0 8px; font-size: 32px; }
        .header p { margin: 0; opacity: 0.9; }
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            padding: 12px 24px;
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 8px 20px rgba(102,126,234,0.35);
            transition: transform 0.15s ease, box-shadow 0.2s ease;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(102,126,234,0.5); }
        .btn:disabled { opacity: .6; cursor: not-allowed; box-shadow: none; }
        .btn-secondary { background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%); box-shadow: 0 8px 20px rgba(100,116,139,0.35); }
        .center { text-align: center; }
        .hidden { display: none; }
        .progress { height: 8px; background: #e5e7eb; border-radius: 999px; overflow: hidden; margin: 12px 0 20px; }
        .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, #34d399, #10b981); transition: width .25s ease; }
        .q-text { font-size: 20px; color: #111827; margin: 8px 0 12px; }
        .opt { border: 2px solid #e5e7eb; border-radius: 12px; padding: 14px; margin: 10px 0; cursor: pointer; transition: all .15s ease; background: #fff; }
        .opt:hover { border-color: #667eea; box-shadow: 0 6px 18px rgba(102,126,234,0.15); transform: translateY(-1px); }
        .opt.selected { border-color: #667eea; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; box-shadow: 0 10px 24px rgba(102,126,234,0.4); }
        .nav { display: flex; justify-content: space-between; gap: 12px; margin-top: 16px; }
        .result-type { font-size: 40px; font-weight: 800; color: #4f46e5; margin: 8px 0 16px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; }
        .pill { display:inline-block; padding:6px 12px; border-radius:999px; background:#eef2ff; color:#3730a3; font-weight:600; font-size:12px; }
        .muted { color: #6b7280; font-size: 14px; }
        a.link { color: #4f46e5; text-decoration: none; font-weight: 600; }
        a.link:hover { text-decoration: underline; }
        /* 智能解析 */
        .insight { margin-top: 10px; padding: 12px 14px; border-left: 4px solid #10b981; background: #ecfdf5; color: #065f46; border-radius: 10px; box-shadow: 0 6px 16px rgba(16,185,129,0.15); transition: all .2s ease; }
        .insight.fade { opacity: 0; transform: translateY(6px); }
    </style>
    <script>
        // Base question set (12 items, evenly covering four dimensions)
        const QUESTIONS = [
            { d: 'EI', t: 'When meeting a new colleague, you tend to:', a: { text: 'Greet proactively and warm up quickly', v: 'E' }, b: { text: 'Observe first and warm up gradually', v: 'I' } },
            { d: 'SN', t: 'When making decisions, you value more:', a: { text: 'Practical details and feasibility', v: 'S' }, b: { text: 'Possibilities and long-term vision', v: 'N' } },
            { d: 'TF', t: 'In disagreements, you focus more on:', a: { text: 'Logical consistency and objective right/wrong', v: 'T' }, b: { text: 'Others’ feelings and relationship harmony', v: 'F' } },
            { d: 'JP', t: 'When handling tasks, you prefer:', a: { text: 'Planned and orderly progress', v: 'J' }, b: { text: 'Flexible arrangements and adjustments', v: 'P' } },
            { d: 'EI', t: 'Weekend social events for you are:', a: { text: 'Energizing — the livelier the better', v: 'E' }, b: { text: 'Draining — quiet time is better', v: 'I' } },
            { d: 'SN', t: 'When learning a new skill, you:', a: { text: 'Start with steps/tutorials', v: 'S' }, b: { text: 'Grasp principles first then practice', v: 'N' } },
            { d: 'TF', t: 'When evaluating options, you:', a: { text: 'List criteria and weigh pros/cons', v: 'T' }, b: { text: 'Consider impact and values', v: 'F' } },
            { d: 'JP', t: 'Before traveling, your prep is:', a: { text: 'A complete itinerary checklist', v: 'J' }, b: { text: 'Go with the flow and explore', v: 'P' } },
            { d: 'EI', t: 'In meetings you more often:', a: { text: 'Speak up and drive the vibe', v: 'E' }, b: { text: 'Listen and refine viewpoints', v: 'I' } },
            { d: 'SN', t: 'When a problem appears, you first:', a: { text: 'Verify facts and troubleshoot step by step', v: 'S' }, b: { text: 'Use intuition to locate the key', v: 'N' } },
            { d: 'TF', t: 'Receiving feedback, you prefer:', a: { text: 'Direct, specific, actionable', v: 'T' }, b: { text: 'Tactful, encouraging, emotion-aware', v: 'F' } },
            { d: 'JP', t: 'Facing a deadline, you usually:', a: { text: 'Finish early to leave buffer', v: 'J' }, b: { text: 'Perform better close to the deadline', v: 'P' } }
        ];

        let currentIndex = -1;
        let selections = Array(QUESTIONS.length).fill(null);

        const scores = { E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0 };
        let autoAdvanceTimer = null;

        // Dimension insights
        const INSIGHT = {
            EI: {
                E: 'You lean Extraversion (E): you gain energy from interaction; proactive expression helps collaboration.',
                I: 'You lean Introversion (I): independent thinking is efficient; expressing after reflection has higher quality.'
            },
            SN: {
                S: 'You lean Sensing (S): you value facts and details; strong at execution and grounding.',
                N: 'You lean Intuition (N): skilled at abstraction and association; good at spotting trends and possibilities.'
            },
            TF: {
                T: 'You lean Thinking (T): logic and standards matter; decisions are clear and consistent.',
                F: 'You lean Feeling (F): you care about people and relationships; good at building trust and cohesion.'
            },
            JP: {
                J: 'You lean Judging (J): clear plans and structure; progress is controllable.',
                P: 'You lean Perceiving (P): flexible and adaptive; you keep room for exploration.'
            }
        };

        // 星座知识库（基于常见性格画像，作为微弱偏置参与计算）
        const ZODIAC_KB = {
            aries: { key: 'aries', cn: '白羊座', weights: { E: 0.8, I: 0.0, S: 0.0, N: 0.6, T: 0.4, F: 0.0, J: 0.0, P: 0.6 }, traits: '行动力强、直来直往、偏向直觉与探索。' },
            taurus: { key: 'taurus', cn: '金牛座', weights: { E: 0.0, I: 0.4, S: 0.8, N: 0.0, T: 0.4, F: 0.2, J: 0.8, P: 0.0 }, traits: '务实稳定、重视细节与秩序，行动稳健。' },
            gemini: { key: 'gemini', cn: '双子座', weights: { E: 0.6, I: 0.0, S: 0.0, N: 0.8, T: 0.3, F: 0.0, J: 0.0, P: 0.8 }, traits: '好奇多变、沟通欲强、偏向开放和灵活。' },
            cancer: { key: 'cancer', cn: '巨蟹座', weights: { E: 0.0, I: 0.6, S: 0.4, N: 0.0, T: 0.0, F: 0.9, J: 0.5, P: 0.0 }, traits: '共情细腻、重视安全与关系，偏情感与内敛。' },
            leo: { key: 'leo', cn: '狮子座', weights: { E: 0.9, I: 0.0, S: 0.0, N: 0.6, T: 0.2, F: 0.4, J: 0.5, P: 0.0 }, traits: '自信外放、愿意担当，重视愿景与影响力。' },
            virgo: { key: 'virgo', cn: '处女座', weights: { E: 0.0, I: 0.5, S: 0.8, N: 0.0, T: 0.7, F: 0.0, J: 0.9, P: 0.0 }, traits: '严谨挑剔、注重标准与细节，追求秩序。' },
            libra: { key: 'libra', cn: '天秤座', weights: { E: 0.4, I: 0.0, S: 0.0, N: 0.5, T: 0.0, F: 0.7, J: 0.0, P: 0.4 }, traits: '擅长协调、追求平衡，偏人际与美感。' },
            scorpio: { key: 'scorpio', cn: '天蝎座', weights: { E: 0.0, I: 0.7, S: 0.0, N: 0.8, T: 0.7, F: 0.0, J: 0.6, P: 0.0 }, traits: '洞察深入、目标专注，重逻辑与掌控感。' },
            sagittarius: { key: 'sagittarius', cn: '射手座', weights: { E: 0.7, I: 0.0, S: 0.0, N: 0.9, T: 0.4, F: 0.0, J: 0.0, P: 0.9 }, traits: '热爱自由、远见乐观，偏探索与开放。' },
            capricorn: { key: 'capricorn', cn: '摩羯座', weights: { E: 0.0, I: 0.6, S: 0.7, N: 0.0, T: 0.8, F: 0.0, J: 0.9, P: 0.0 }, traits: '务实自律、结果导向，偏理性与结构。' },
            aquarius: { key: 'aquarius', cn: '水瓶座', weights: { E: 0.0, I: 0.5, S: 0.0, N: 0.9, T: 0.8, F: 0.0, J: 0.0, P: 0.6 }, traits: '独立创新、前瞻反叛，偏理念与自由。' },
            pisces: { key: 'pisces', cn: '双鱼座', weights: { E: 0.0, I: 0.6, S: 0.0, N: 0.7, T: 0.0, F: 0.9, J: 0.0, P: 0.7 }, traits: '浪漫共情、想象丰富，偏直觉与感受。' }
        };

        // 占星扩展知识库（元素、模式、守护星、原型），用于星座×MBTI解读
        const ZODIAC_META = {
            aries:      { element:'火', modality:'本位', rulers:['火星'], archetype:'战士/开拓者', keywords:['冲劲','直率','领导','冒险'] },
            taurus:     { element:'土', modality:'固定', rulers:['金星'], archetype:'建造者/感官享受', keywords:['稳定','务实','价值','耐心'] },
            gemini:     { element:'风', modality:'变动', rulers:['水星'], archetype:'信使/学习者', keywords:['信息','连接','机智','多变'] },
            cancer:     { element:'水', modality:'本位', rulers:['月亮'], archetype:'守护者/滋养者', keywords:['情感','安全','家庭','记忆'] },
            leo:        { element:'火', modality:'固定', rulers:['太阳'], archetype:'创造者/王者', keywords:['自我表达','荣誉','舞台','慷慨'] },
            virgo:      { element:'土', modality:'变动', rulers:['水星'], archetype:'匠人/分析者', keywords:['细节','修正','服务','效率'] },
            libra:      { element:'风', modality:'本位', rulers:['金星'], archetype:'调和者/审美者', keywords:['关系','平衡','公正','审美'] },
            scorpio:    { element:'水', modality:'固定', rulers:['火星','冥王星'], archetype:'转化者/侦探', keywords:['深度','控制','沉潜','重生'] },
            sagittarius:{ element:'火', modality:'变动', rulers:['木星'], archetype:'探求者/哲人', keywords:['远见','自由','真理','旅行'] },
            capricorn:  { element:'土', modality:'本位', rulers:['土星'], archetype:'攀登者/管理者', keywords:['结构','责任','长期','权威'] },
            aquarius:   { element:'风', modality:'固定', rulers:['土星','天王星'], archetype:'革新者/异类', keywords:['理念','平等','未来','独立'] },
            pisces:     { element:'水', modality:'变动', rulers:['木星','海王星'], archetype:'诗人/神秘者', keywords:['想象','共情','灵性','融合'] }
        };

        function getTemperament(mbti){
            const s = mbti || '';
            const hasS = s[1] === 'S';
            const hasN = s[1] === 'N';
            const hasT = s[2] === 'T';
            const hasF = s[2] === 'F';
            if (hasS && s[3] === 'J') return 'SJ';
            if (hasS && s[3] === 'P') return 'SP';
            if (hasN && hasF) return 'NF';
            if (hasN && hasT) return 'NT';
            return 'Mixed';
        }

        function buildZodiacMbtiInsight(mbtiType, signKey){
            const meta = ZODIAC_META[signKey];
            if (!meta) return '';
            const temper = getTemperament(mbtiType);
            const e = meta.element; // 火土风水
            const m = meta.modality; // 本位固定变动

            // 元素×气质简评
            const elementFitMap = {
                '火': { fit: ['E','N','P'], tip: '行动/愿景/尝新' },
                '土': { fit: ['S','J','T'], tip: '结构/务实/可持续' },
                '风': { fit: ['E','N','T','P'], tip: '交流/理念/灵活' },
                '水': { fit: ['I','N','F'], tip: '情感/共鸣/想象' }
            };
            const modalityFitMap = {
                '本位': { fit: ['J','E'], tip: '启动/带头/定目标' },
                '固定': { fit: ['J','T','I'], tip: '专注/稳固/抗干扰' },
                '变动': { fit: ['P','N'], tip: '适应/多变/探索' }
            };
            const ef = elementFitMap[e] || { fit: [], tip: '' };
            const mf = modalityFitMap[m] || { fit: [], tip: '' };

            const matches = (need) => need.filter(ch => mbtiType.includes(ch));
            const eMatch = matches(ef.fit);
            const mMatch = matches(mf.fit);

            // 气质描述
            const temperDesc = {
                SJ: '秩序与责任（守护者）',
                SP: '体验与实操（工匠/玩家）',
                NF: '意义与关系（理想主义者）',
                NT: '逻辑与系统（理性主义者）',
                Mixed: '多元取向（混合倾向）'
            }[temper];

            const ruler = (ZODIAC_META[signKey].rulers || []).join('、');
            const keywords = (ZODIAC_META[signKey].keywords || []).join('、');

            return `
                <div class="card">
                    <div class="pill">星座×MBTI 交叉洞察</div>
                    <p class="muted" style="margin-top:6px">元素：${e}｜模式：${m}｜守护星：${ruler}</p>
                    <div class="grid">
                        <div class="card">
                            <div class="pill">元素协同</div>
                            <p class="muted">与你的类型(${mbtiType})的匹配点：${eMatch.join('、') || '—'}。倾向：${ef.tip}</p>
                        </div>
                        <div class="card">
                            <div class="pill">模式协同</div>
                            <p class="muted">与你的类型(${mbtiType})的匹配点：${mMatch.join('、') || '—'}。倾向：${mf.tip}</p>
                        </div>
                        <div class="card">
                            <div class="pill">气质映射</div>
                            <p class="muted">你的MBTI气质：${temperDesc}；星座关键词：${keywords || '—'}</p>
                        </div>
                    </div>
                    <p class="muted" style="margin-top:6px">提示：该解读基于占星（元素/模式/守护星）与MBTI气质的启发式映射，供自我探索参考。</p>
                </div>
            `;
        }

        let selectedSign = null;

        // MBTI 类型知识库（摘要/功能堆栈/优势/风险/工作风格/职业/代表人物）
        const TYPE_KB = {
            INTJ: { summary:'战略型规划者，长期愿景与系统化推进并重。', funcs:['Ni','Te','Fi','Se'], strengths:['前瞻规划','结构化思维','独立自驱','高标准'], risks:['沟通生硬','忽视情绪','完美主义','固执路线'], work:['偏好目标清晰、可衡量产出','喜欢深度独处与长周期研究','重视效率与可复用体系'], careers:['战略/咨询','产品/架构','科研/数据','投研/运营优化'], figures:['Elon Musk(推测)','J.K.罗琳(推测)'] },
            INTP: { summary:'概念型问题求解者，热衷原理建模与抽象优化。', funcs:['Ti','Ne','Si','Fe'], strengths:['逻辑剖析','模型搭建','创新点子','学习速度快'], risks:['拖延倾向','交付不稳','忽视细节','社交能量低'], work:['喜欢自由探索与技术难题','需要低干扰、可试错空间','厌恶重复流程与官僚'], careers:['算法/研究','系统设计','Dev/DevRel','数据分析'], figures:['爱因斯坦(推测)','拉里·佩奇(推测)'] },
            ENTJ: { summary:'执行型领导者，目标导向与资源统筹兼备。', funcs:['Te','Ni','Se','Fi'], strengths:['决策果断','组织调度','结果导向','抗压推进'], risks:['强势控制','同理不足','急于求成','忽视风险边界'], work:['偏好多团队协作和规模化','看重KPI与明确责权','适合复杂项目与变革'], careers:['管理/运营','战略/销售','投行/咨询','增长/ToB'], figures:['张瑞敏(推测)','Jeff Bezos(推测)'] },
            ENTP: { summary:'辩思型创变者，点子密集与跨域连接能力强。', funcs:['Ne','Ti','Fe','Si'], strengths:['创意爆发','跨界联想','应变快','说服力强'], risks:['后继乏力','注意力跳跃','不爱收尾','挑战权威'], work:['喜欢0→1与试验田','需要弹性与舞台','对新奇/竞争敏感'], careers:['创新/产品','创业/市场','咨询/媒体','增长/BD'], figures:['史蒂夫·乔布斯(推测)','马斯克(推测)'] },
            INFJ: { summary:'洞察型辅导者，价值驱动与体系化关怀。', funcs:['Ni','Fe','Ti','Se'], strengths:['洞察人心','价值引导','长期陪伴','整合视角'], risks:['理想主义挫败','过度共情','表达含蓄','能量易耗'], work:['偏好深度一对一或小团体','需要意义感与一致价值','适合长期影响工作'], careers:['心理/教育','品牌/内容','非营利/人力','咨询/教练'], figures:['卡尔·荣格(推测)','甘地(推测)'] },
            INFP: { summary:'理想型创作者，内在价值与真实表达优先。', funcs:['Fi','Ne','Si','Te'], strengths:['真诚共情','创作表达','价值敏感','坚持初心'], risks:['执行松散','回避冲突','抗压较弱','现实妥协难'], work:['需要价值一致与创作空间','反感高压流程化','适合内容与用户体验'], careers:['写作/设计','内容/用户研究','公益/教育','产品体验'], figures:['村上春树(推测)','托尔金(推测)'] },
            ENFJ: { summary:'凝聚型推动者，人群动员与成长赋能。', funcs:['Fe','Ni','Se','Ti'], strengths:['激发潜能','组织氛围','沟通共识','长期培养'], risks:['忽视自我','过度承担','讨好压力','理性不足'], work:['擅长搭建协作机制','重视文化与节奏','适合教练和管理'], careers:['HR/组织发展','教育/培训','市场/社区','公益/运营'], figures:['奥普拉(推测)','马丁·路德·金(推测)'] },
            ENFP: { summary:'启发型传播者，灵感、连接与探索驱动。', funcs:['Ne','Fi','Te','Si'], strengths:['创意连接','同理鼓舞','学习快','机动适应'], risks:['难以聚焦','执行分散','抗拒约束','情绪起伏'], work:['喜欢多样与人际互动','需要自由与认可','适合品牌与增长'], careers:['内容/品牌','增长/媒体','产品/用户','公关/BD'], figures:['罗宾·威廉姆斯(推测)','奥巴马(推测)'] },
            ISTJ: { summary:'秩序型执行者，可靠、严谨、稳定推进。', funcs:['Si','Te','Fi','Ne'], strengths:['流程化','风险控制','稳健交付','责任心强'], risks:['保守僵化','创新不足','沟通直接','适应慢'], work:['偏好标准与规范','擅长长期维护与质量','适合复杂后勤体系'], careers:['质控/法务','财务/审计','运维/项目','公务/行政'], figures:['沃伦·巴菲特(推测)','海军军官典型'] },
            ISFJ: { summary:'守护型服务者，细致体贴与稳定支撑。', funcs:['Si','Fe','Ti','Ne'], strengths:['稳定可靠','体察需求','记忆细节','耐心勤勉'], risks:['回避冲突','难拒绝','创新偏弱','自我表达少'], work:['偏好明确职责与协作','擅长客户与内部支持','适合服务密集岗位'], careers:['护理/教育','客户成功','行政/内勤','运营/社服'], figures:['凯特·米德尔顿(推测)'] },
            ESTJ: { summary:'指挥型落实者，结构与效率的代言人。', funcs:['Te','Si','Ne','Fi'], strengths:['强执行力','流程优化','公平客观','抗压稳'], risks:['强硬/控制','对人情感知弱','不耐低效','保守路径依赖'], work:['偏好清晰KPI与职责','擅长规模化与管理','适合流程改造与交付'], careers:['运营/管理','供应链/制造','项目/PMO','政务/军警'], figures:['Indra Nooyi(推测)','Tim Cook(推测)'] },
            ESFJ: { summary:'协同型照护者，关系维护与秩序守护。', funcs:['Fe','Si','Ne','Ti'], strengths:['人际和谐','服务意识','组织细节','执行稳定'], risks:['过度在意评价','保守从众','难拒绝','逃避冲突'], work:['偏好团队与明确流程','重视氛围与公平','适合大团队运营'], careers:['人事/行政','客户/社区','教育/护理','活动/运营'], figures:['泰勒·斯威夫特(推测)'] },
            ISTP: { summary:'冷静型工匠，动手解决现实问题。', funcs:['Ti','Se','Ni','Fe'], strengths:['快速定位故障','实操能力强','临场反应好','客观冷静'], risks:['沟通简短','规则淡薄','长期规划弱','情感表达少'], work:['偏好实际问题与工具','喜欢独立与即时反馈','适合危机处理场景'], careers:['工程/安防','运维/应急','外科/机械','交易/竞技'], figures:['李小龙(推测)','F1车手典型'] },
            ISFP: { summary:'温柔型体验者，审美、手作与真实感受。', funcs:['Fi','Se','Ni','Te'], strengths:['审美敏锐','真诚温和','体验导向','专注当下'], risks:['计划性弱','回避硬碰','抗压较差','表达含蓄'], work:['偏好小团队与作品呈现','需要空间与尊重','适合设计与手作'], careers:['视觉/UI','摄影/手作','内容/体验','护工/康复'], figures:['宫崎骏(推测)'] },
            ESTP: { summary:'行动型实干家，现场反应与影响力强。', funcs:['Se','Ti','Fe','Ni'], strengths:['快速决断','资源整合','谈判说服','结果导向'], risks:['短视冒险','后续维护弱','权威冲突','耐心不足'], work:['喜欢高节奏与博弈','在现场更出彩','适合销售与突击任务'], careers:['销售/交易','公关/谈判','应急/救援','运营/运动'], figures:['乔丹(推测)','格兰特·卡尔登(推测)'] },
            ESFP: { summary:'活力型表演者，感染力与人气中心。', funcs:['Se','Fi','Te','Ni'], strengths:['社交驱动','氛围打造','当下洞察','适应力强'], risks:['难以长期坚持','管理弱','情绪波动','抗压不足'], work:['喜欢互动与舞台','需要即时反馈','适合品牌与活动'], careers:['演艺/主播','市场/活动','客服/运营','旅游/体育'], figures:['麦当娜(推测)','综艺主持典型'] }
        };

        function buildTypeDetail(mbti){
            const info = TYPE_KB[mbti];
            if (!info) return '';
            const funcs = info.funcs.join(' → ');
            const renderList = (arr) => arr.map(x=>`<li>${x}</li>`).join('');
            return `
                <div class="card">
                    <div class="pill">类型综述</div>
                    <p class="muted" style="margin-top:6px">${info.summary}</p>
                    <div class="grid" style="margin-top:8px">
                        <div class="card"><div class="pill">功能堆栈</div><p class="muted">${funcs}</p></div>
                        <div class="card"><div class="pill">优势</div><ul class="muted" style="margin:6px 0 0 18px">${renderList(info.strengths)}</ul></div>
                        <div class="card"><div class="pill">潜在风险</div><ul class="muted" style="margin:6px 0 0 18px">${renderList(info.risks)}</ul></div>
                        <div class="card"><div class="pill">工作风格</div><ul class="muted" style="margin:6px 0 0 18px">${renderList(info.work)}</ul></div>
                    </div>
                    <div class="grid" style="margin-top:8px">
                        <div class="card"><div class="pill">适合职业</div><p class="muted">${info.careers.join('、')}</p></div>
                        <div class="card"><div class="pill">代表人物（推测）</div><p class="muted">${info.figures.join('、')}</p></div>
                    </div>
                </div>
            `;
        }

        function $(sel){ return document.querySelector(sel); }

        function show(section){
            ['#welcome','#testing','#result'].forEach(id=>$(id).classList.add('hidden'));
            $(section).classList.remove('hidden');
        }

        function startTest(){
            console.log('Start professional MBTI test');
            currentIndex = 0;
            selections.fill(null);
            Object.keys(scores).forEach(k => scores[k] = 0);
            renderQuestion();
            show('#testing');
        }

        function renderQuestion(){
            // 清理自动前进
            if (autoAdvanceTimer) { clearTimeout(autoAdvanceTimer); autoAdvanceTimer = null; }
            const q = QUESTIONS[currentIndex];
            $('#qText').textContent = `${currentIndex+1}. ${q.t}`;
            const opts = $('#opts');
            opts.innerHTML = '';
            [q.a, q.b].forEach((opt, idx) => {
                const div = document.createElement('div');
                div.className = 'opt' + (selections[currentIndex] === opt.v ? ' selected' : '');
                div.setAttribute('role','button');
                div.tabIndex = 0;
                div.innerHTML = `${opt.text}`;
                div.onclick = () => selectOption(opt.v, q.d);
                div.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); selectOption(opt.v); } };
                opts.appendChild(div);
            });
            $('#prevBtn').disabled = currentIndex === 0;
            $('#nextBtn').textContent = currentIndex === QUESTIONS.length - 1 ? 'Submit' : 'Next';
            $('#nextBtn').disabled = selections[currentIndex] == null;
            const pct = Math.round(((currentIndex) / QUESTIONS.length) * 100);
            $('#pbar').style.width = `${pct}%`;
            $('#ptext').textContent = `${currentIndex}/${QUESTIONS.length}`;
            // 隐藏解析
            const ins = $('#insight');
            if (ins) { ins.classList.add('hidden'); ins.textContent=''; }
        }

        function selectOption(val, dim){
            selections[currentIndex] = val;
            // 高亮选项
            const opts = $('#opts').children;
            Array.from(opts).forEach(el => el.classList.remove('selected'));
            const chosen = Array.from(opts).find(el => el.textContent.trim());
            // 展示智能解析
            showInsight(dim || QUESTIONS[currentIndex].d, val);
            // 启用下一题按钮
            $('#nextBtn').disabled = false;
            // 自动前进（延迟 600ms）
            if (autoAdvanceTimer) clearTimeout(autoAdvanceTimer);
            autoAdvanceTimer = setTimeout(() => { next(); }, 600);
        }

        function showInsight(dim, v){
            const ins = $('#insight');
            if (!ins) return;
            const explain = INSIGHT[dim]?.[v] || '';
            // 当前维度实时对比
            const mapDim = { EI:['E','I'], SN:['S','N'], TF:['T','F'], JP:['J','P'] };
            const [a,b] = mapDim[dim] || [];
            let aCnt = 0, bCnt = 0, aTot=0;
            QUESTIONS.forEach((q, i) => {
                if (q.d !== dim) return;
                aTot++;
                const sel = selections[i];
                if (sel === a) aCnt++;
                else if (sel === b) bCnt++;
            });
            const aPct = aTot? Math.round(100*aCnt/aTot):0;
            const bPct = aTot? Math.round(100*bCnt/aTot):0;
            const label = {
                EI: ['Extraversion E','Introversion I'],
                SN: ['Sensing S','Intuition N'],
                TF: ['Thinking T','Feeling F'],
                JP: ['Judging J','Perceiving P']
            }[dim] || [a,b];

            ins.innerHTML = `${explain}<br><span class="muted">Current tendency: ${label[0]} ${aPct}% · ${label[1]} ${bPct}%</span>`;
            ins.classList.remove('hidden','fade');
            // 渐隐效果（不阻碍前进）
            setTimeout(()=> ins.classList.add('fade'), 1200);
            setTimeout(()=> { ins.classList.add('hidden'); ins.classList.remove('fade'); }, 1700);
        }

        function next(){
            if (selections[currentIndex] == null) return;
            if (currentIndex === QUESTIONS.length - 1) { submit(); return; }
            if (autoAdvanceTimer) { clearTimeout(autoAdvanceTimer); autoAdvanceTimer = null; }
            currentIndex += 1;
            renderQuestion();
        }

        function prev(){
            if (currentIndex === 0) return;
            if (autoAdvanceTimer) { clearTimeout(autoAdvanceTimer); autoAdvanceTimer = null; }
            currentIndex -= 1;
            renderQuestion();
        }

        function submit(){
            console.log('Submit MBTI test results');
            
            // 累计分数
            Object.keys(scores).forEach(k => scores[k] = 0);
            selections.forEach((val, i) => { if (val) scores[val] += 1; });
            const getPair = (a,b) => scores[a] >= scores[b] ? a : b;
            const type = [ getPair('E','I'), getPair('S','N'), getPair('T','F'), getPair('J','P') ].join('');

            // 百分比（相对于该维度题目数量）
            const countByDim = { EI:0, SN:0, TF:0, JP:0 };
            QUESTIONS.forEach(q => countByDim[q.d] += 1);
            const pct = {
                E: Math.round(100 * scores.E / countByDim.EI),
                I: Math.round(100 * scores.I / countByDim.EI),
                S: Math.round(100 * scores.S / countByDim.SN),
                N: Math.round(100 * scores.N / countByDim.SN),
                T: Math.round(100 * scores.T / countByDim.TF),
                F: Math.round(100 * scores.F / countByDim.TF),
                J: Math.round(100 * scores.J / countByDim.JP),
                P: Math.round(100 * scores.P / countByDim.JP)
            };

            // 渲染结果
            $('#type').textContent = type;
            $('#ztype').textContent = type; // 使用相同的类型，因为这是纯MBTI测试
            $('#zsummary').innerHTML = 'Professional MBTI Analysis';
            
            $('#breakdown').innerHTML = `
                <div class="grid">
                    <div class="card"><div class="pill">Extraversion E / Introversion I</div><p class="muted">E ${pct.E}% · I ${pct.I}%</p></div>
                    <div class="card"><div class="pill">Sensing S / Intuition N</div><p class="muted">S ${pct.S}% · N ${pct.N}%</p></div>
                    <div class="card"><div class="pill">Thinking T / Feeling F</div><p class="muted">T ${pct.T}% · F ${pct.F}%</p></div>
                    <div class="card"><div class="pill">Judging J / Perceiving P</div><p class="muted">J ${pct.J}% · P ${pct.P}%</p></div>
                </div>
            `;
            
            // MBTI类型详解
            const detail = document.getElementById('typeDetail');
            if (detail) detail.innerHTML = `<div class="card"><div class="pill">Type Insights</div><p class="muted">Detailed type insights are coming soon.</p></div>`;

            show('#result');
        }

        function restart(){
            currentIndex = -1;
            selections.fill(null);
            Object.keys(scores).forEach(k => scores[k] = 0);
            show('#welcome');
        }
    </script>
    <link rel="icon" href="data:,">
    <meta name="color-scheme" content="light dark">
</head>
<body>
            <div class="header">
            <div class="container">
                <h1>🧠 Professional MBTI Test</h1>
                <p>Jungian-based 16-type professional test, fast and accurate · ~3–5 minutes · 12 questions · local computation</p>
            </div>
        </div>

    <div class="container">
        <!-- Welcome -->
        <div id="welcome" class="card">
            <h2 class="center" style="margin-top:0">Before you start</h2>
            <p class="muted">
                Choose one of two options based on your preference. Answer by first instinct—there are no right or wrong options.
            </p>
            
            <div class="card" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 1px solid #f59e0b; margin: 16px 0;">
                <h3 style="margin: 0 0 8px; color: #92400e;">🌟 Test Highlights</h3>
                <p style="margin: 0; color: #92400e; font-size: 14px;">
                    This test is based on Jungian theory. With 12 carefully designed questions, it quickly and accurately estimates your MBTI type. You will get:
                </p>
                <ul style="margin: 8px 0 0 18px; color: #92400e; font-size: 14px;">
                    <li>Standard MBTI four-dimension breakdown</li>
                    <li>Professional type interpretation</li>
                    <li>Personalized development suggestions</li>
                    <li>Career fit analysis</li>
                </ul>
                <div style="margin-top: 12px;">
                    <p style="color: #92400e; font-size: 14px; margin: 0;">
                        💡 Psychology-informed; uses simple heuristics to analyze your tendencies
                    </p>
                </div>
            </div>
            
            <div class="center" style="margin-top:16px">
                <button class="btn" type="button" onclick="startTest()">Start Test</button>
                <a class="link" href="index.html" style="margin-left:12px">Back to Home</a>
            </div>
        </div>

        <!-- Testing -->
        <div id="testing" class="card hidden">
            <div class="progress"><div id="pbar" class="progress-bar"></div></div>
            <div class="muted" id="ptext">0/12</div>
            <div id="qText" class="q-text">Question</div>
            <div id="insight" class="insight hidden"></div>
            <div id="opts"></div>
            <div class="nav">
                <button id="prevBtn" class="btn btn-secondary" type="button" onclick="prev()">Previous</button>
                <button id="nextBtn" class="btn" type="button" onclick="next()">Next</button>
            </div>
        </div>

        <!-- Result -->
        <div id="result" class="card hidden">
            <div class="center">
                <div class="pill">Your MBTI Type</div>
                <div id="type" class="result-type">XXXX</div>
                <p class="muted">Distribution across four dimensions:</p>
                <div style="margin-top:8px"></div>
                <div class="pill">Professional Analysis</div>
                <div id="ztype" class="result-type" style="font-size:28px; color:#10b981">XXXX</div>
                <div id="zsummary" class="muted" style="margin-top:6px"></div>
            </div>
            <div id="breakdown" style="margin-top:12px"></div>
            <div id="typeDetail" style="margin-top:12px"></div>
            <div class="center" style="margin-top:16px">
                <button class="btn" type="button" onclick="restart()">Restart</button>
                <a class="link" href="index.html" style="margin-left:12px">Back to Home</a>
            </div>
        </div>
    </div>
</body>
</html>


