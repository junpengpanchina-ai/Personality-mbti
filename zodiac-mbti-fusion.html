<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fun Zodiac Test - Explore Your Zodiac Traits & Personality</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            color: #111827;
        }
        .container { max-width: 1000px; margin: 0 auto; padding: 24px; }
        .header { text-align: center; color: #fff; margin: 24px 0; }
        .header h1 { margin: 0 0 8px; font-size: 30px; }
        .card { background: rgba(255,255,255,0.98); border-radius: 16px; padding: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.15); margin-bottom: 16px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap: 16px; }
        .btn { display:inline-block; background: linear-gradient(135deg, #8b5cf6, #ec4899); color:#fff; border:none; padding:10px 18px; border-radius:999px; cursor:pointer; font-weight:600; }
        .btn:hover { transform: translateY(-1px); }
        .btn-secondary { background: linear-gradient(135deg, #94a3b8, #64748b); color:#fff; }
        .muted { color:#6b7280; font-size:14px; }
        .hidden { display: none; }
        .zodiac-card {
            background: linear-gradient(135deg, #f3e8ff, #e9d5ff);
            border: 2px solid #8b5cf6;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .zodiac-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(139, 92, 246, 0.3);
        }
        .zodiac-card.selected {
            background: linear-gradient(135deg, #8b5cf6, #ec4899);
            color: white;
        }
        .zodiac-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        .zodiac-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .zodiac-dates {
            font-size: 14px;
            color: #7c3aed;
            margin-bottom: 10px;
        }
        .zodiac-card.selected .zodiac-dates {
            color: rgba(255,255,255,0.8);
        }
        .result-section {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-left: 4px solid #16a34a;
        }
        .mbti-section {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-left: 4px solid #3b82f6;
        }
        .fusion-section {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid #f59e0b;
        }
        .question-card {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            background: #fff;
        }
        .option {
            display: block;
            margin-bottom: 10px;
            cursor: pointer;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            transition: all 0.2s;
        }
        .option:hover {
            border-color: #8b5cf6;
            background: #f3f4f6;
        }
        .option input[type="radio"] {
            margin-right: 8px;
        }
        .kpi {
            font-size: 32px;
            font-weight: 800;
            color: #8b5cf6;
            text-align: center;
            margin: 20px 0;
        }
        .back-btn {
            background: #6b7280;
            margin-left: 10px;
        }
        .progress-bar {
            height: 8px;
            background: #e5e7eb;
            border-radius: 999px;
            overflow: hidden;
            margin: 12px 0 20px;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #8b5cf6, #ec4899);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>‚ôà Fun Zodiac Test</h1>
            <p class="muted">Easy and fun zodiac personality test to explore your zodiac traits and personality characteristics</p>
            
            <div style="margin-top: 20px;">
                <button class="btn" onclick="startTest()">üß™ Start Zodiac Test</button>
                <button class="btn back-btn" onclick="location.href='index.html'">üè† Back to Home</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Zodiac Selection Area -->
        <div id="zodiac-selection" class="card">
            <h2 style="text-align: center; color: #7c3aed; margin-bottom: 20px;">Choose Your Zodiac Sign</h2>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <button class="btn" onclick="startMBTITest()" id="start-mbti-btn" disabled>üß† Start MBTI Test</button>
            </div>
            
            <div class="grid">
                <div class="zodiac-card" onclick="selectZodiac('aries', event)">
                    <div class="zodiac-icon">‚ôà</div>
                    <div class="zodiac-name">Aries</div>
                    <div class="zodiac-dates">Mar 21 - Apr 19</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('taurus', event)">
                    <div class="zodiac-icon">‚ôâ</div>
                    <div class="zodiac-name">Taurus</div>
                    <div class="zodiac-dates">Apr 20 - May 20</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('gemini', event)">
                    <div class="zodiac-icon">‚ôä</div>
                    <div class="zodiac-name">Gemini</div>
                    <div class="zodiac-dates">May 21 - Jun 21</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('cancer', event)">
                    <div class="zodiac-icon">‚ôã</div>
                    <div class="zodiac-name">Cancer</div>
                    <div class="zodiac-dates">Jun 22 - Jul 22</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('leo', event)">
                    <div class="zodiac-icon">‚ôå</div>
                    <div class="zodiac-name">Leo</div>
                    <div class="zodiac-dates">Jul 23 - Aug 22</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('virgo', event)">
                    <div class="zodiac-icon">‚ôç</div>
                    <div class="zodiac-name">Virgo</div>
                    <div class="zodiac-dates">Aug 23 - Sep 22</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('libra', event)">
                    <div class="zodiac-icon">‚ôé</div>
                    <div class="zodiac-name">Libra</div>
                    <div class="zodiac-dates">Sep 23 - Oct 23</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('scorpio', event)">
                    <div class="zodiac-icon">‚ôè</div>
                    <div class="zodiac-name">Scorpio</div>
                    <div class="zodiac-dates">Oct 24 - Nov 22</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('sagittarius', event)">
                    <div class="zodiac-icon">‚ôê</div>
                    <div class="zodiac-name">Sagittarius</div>
                    <div class="zodiac-dates">Nov 23 - Dec 21</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('capricorn', event)">
                    <div class="zodiac-icon">‚ôë</div>
                    <div class="zodiac-name">Capricorn</div>
                    <div class="zodiac-dates">Dec 22 - Jan 19</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('aquarius', event)">
                    <div class="zodiac-icon">‚ôí</div>
                    <div class="zodiac-name">Aquarius</div>
                    <div class="zodiac-dates">Jan 20 - Feb 18</div>
                </div>
                <div class="zodiac-card" onclick="selectZodiac('pisces', event)">
                    <div class="zodiac-icon">‚ôì</div>
                    <div class="zodiac-name">Pisces</div>
                    <div class="zodiac-dates">Feb 19 - Mar 20</div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="startMBTITest()" id="start-mbti-btn" disabled>üß† Start MBTI Test</button>
            </div>
        </div>

        <!-- MBTI Test Area -->
        <div id="mbti-test" class="card hidden">
            <h2 style="text-align: center; color: #3b82f6; margin-bottom: 20px;">MBTI Personality Test</h2>
            <p style="text-align: center; color: #6b7280; margin-bottom: 20px;">Please choose the option that best matches your true thoughts</p>
            
            <div class="progress-bar">
                <div class="progress-fill" id="mbtiProgress"></div>
            </div>
            
            <div id="mbti-questions"></div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="submitMBTI()" id="submit-mbti-btn" disabled>üìä Submit Test Results</button>
                <button class="btn btn-secondary" onclick="backToZodiac()" style="margin-left: 10px;">üîô Back to Zodiac Selection</button>
            </div>
        </div>

        <!-- Test Results Area -->
        <div id="test-result" class="card result-section hidden">
            <h2 style="text-align: center; color: #065f46; margin-bottom: 20px;">Your Zodiac Personality Analysis Results</h2>
            <div id="result-content"></div>
        </div>
    </div>

    <script>
        let selectedZodiac = null;
        let mbtiScores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
        
        // MBTI Test Questions
        const mbtiQuestions = [
            { question: "In social situations, you usually:", options: ["A. Actively talk to others and enjoy socializing", "B. Tend to observe quietly and socialize less actively"] },
            { question: "When you need to make decisions, you rely more on:", options: ["A. Logical analysis and objective facts", "B. Personal values and others' feelings"] },
            { question: "You prefer work environments that are:", options: ["A. Have clear plans and deadlines", "B. Flexible and can be adjusted anytime"] },
            { question: "When facing new information, you focus more on:", options: ["A. Specific details and practical applications", "B. Overall concepts and future possibilities"] },
            { question: "In a team, you usually:", options: ["A. Like discussions and brainstorming", "B. Need time to think before expressing"] },
            { question: "You tend to:", options: ["A. Execute according to established plans", "B. Adjust flexibly based on situations"] },
            { question: "You prefer learning through:", options: ["A. Practice and concrete examples", "B. Theory and abstract concepts"] },
            { question: "When making decisions, you value more:", options: ["A. Efficiency and results", "B. Harmony and interpersonal relationships"] },
            { question: "You prefer:", options: ["A. Clear rules and structure", "B. Freedom and flexibility"] },
            { question: "You are better at:", options: ["A. Handling concrete problems", "B. Thinking about abstract concepts"] },
            { question: "Under pressure, you tend to:", options: ["A. Seek support and advice from others", "B. Think and handle things alone"] },
            { question: "You prefer work that:", options: ["A. Has clear success criteria", "B. Has innovation and exploration space"] }
        ];
        
        // Zodiac Data
        const zodiacData = {
            aries: { name: 'Aries', icon: '‚ôà', element: 'Fire', traits: ['Brave', 'Passionate', 'Impulsive', 'Leadership'] },
            taurus: { name: 'Taurus', icon: '‚ôâ', element: 'Earth', traits: ['Steady', 'Practical', 'Stubborn', 'Patient'] },
            gemini: { name: 'Gemini', icon: '‚ôä', element: 'Air', traits: ['Flexible', 'Curious', 'Changeable', 'Communication'] },
            cancer: { name: 'Cancer', icon: '‚ôã', element: 'Water', traits: ['Sensitive', 'Protective', 'Emotional', 'Family-oriented'] },
            leo: { name: 'Leo', icon: '‚ôå', element: 'Fire', traits: ['Confident', 'Generous', 'Proud', 'Charismatic'] },
            virgo: { name: 'Virgo', icon: '‚ôç', element: 'Earth', traits: ['Perfect', 'Analytical', 'Modest', 'Service-oriented'] },
            libra: { name: 'Libra', icon: '‚ôé', element: 'Air', traits: ['Balanced', 'Just', 'Hesitant', 'Harmonious'] },
            scorpio: { name: 'Scorpio', icon: '‚ôè', element: 'Water', traits: ['Mysterious', 'Insightful', 'Persistent', 'Passionate'] },
            sagittarius: { name: 'Sagittarius', icon: '‚ôê', element: 'Fire', traits: ['Optimistic', 'Adventurous', 'Direct', 'Free-spirited'] },
            capricorn: { name: 'Capricorn', icon: '‚ôë', element: 'Earth', traits: ['Ambitious', 'Responsible', 'Cautious', 'Achievement-oriented'] },
            aquarius: { name: 'Aquarius', icon: '‚ôí', element: 'Air', traits: ['Innovative', 'Independent', 'Humanitarian', 'Rebellious'] },
            pisces: { name: 'Pisces', icon: '‚ôì', element: 'Water', traits: ['Intuitive', 'Compassionate', 'Artistic', 'Dreamy'] }
        };
        
        // Select Zodiac
        function selectZodiac(zodiac, event) {
            // Clear previous selection
            document.querySelectorAll('.zodiac-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Select current zodiac
            event.target.closest('.zodiac-card').classList.add('selected');
            selectedZodiac = zodiac;
            
            // Enable start MBTI test button
            document.getElementById('start-mbti-btn').disabled = false;
        }
        
        // Start MBTI Test
        function startMBTITest() {
            if (!selectedZodiac) {
                alert('Please select a zodiac sign first!');
                return;
            }
            
            // Hide zodiac selection, show MBTI test
            document.getElementById('zodiac-selection').classList.add('hidden');
            document.getElementById('mbti-test').classList.remove('hidden');
            
            // Display MBTI test questions
            displayMBTIQuestions();
        }
        
        // Display MBTI Test Questions
        function displayMBTIQuestions() {
            const questionsDiv = document.getElementById('mbti-questions');
            let questionsHTML = '';
            
            mbtiQuestions.forEach((q, index) => {
                questionsHTML += `
                    <div class="question-card">
                        <h4 style="margin-bottom: 15px; color: #374151;">Question ${index + 1}</h4>
                        <p style="margin-bottom: 15px; font-size: 16px;">${q.question}</p>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q${index}" value="${q.options[0].charAt(0)}" onchange="onOptionChange(this)" style="margin-right: 8px;">
                                ${q.options[0]}
                            </label>
                            <label class="option">
                                <input type="radio" name="q${index}" value="${q.options[1].charAt(0)}" onchange="onOptionChange(this)" style="margin-right: 8px;">
                                ${q.options[1]}
                            </label>
                        </div>
                    </div>
                `;
            });
            
            questionsDiv.innerHTML = questionsHTML;
        }
        
        function onOptionChange(input) {
            updateProgress();
            advanceToNext(input);
        }

        function advanceToNext(input) {
            try {
                const name = input && input.name;
                if (!name || !name.startsWith('q')) return;
                const currentIndex = parseInt(name.slice(1), 10);
                if (Number.isNaN(currentIndex)) return;
                const nextIndex = currentIndex + 1;
                const next = document.querySelector(`input[name="q${nextIndex}"]`);
                if (next) {
                    const card = next.closest('.question-card');
                    if (card && typeof card.scrollIntoView === 'function') {
                        card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                    next.focus();
                } else {
                    const submitBtn = document.getElementById('submit-mbti-btn');
                    if (submitBtn && typeof submitBtn.scrollIntoView === 'function') {
                        submitBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            } catch (e) {
                // no-op
            }
        }
        
        // Update Progress Bar
        function updateProgress() {
            const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
            const progress = (answeredQuestions / mbtiQuestions.length) * 100;
            document.getElementById('mbtiProgress').style.width = progress + '%';
            
            // Enable submit button
            const submitBtn = document.getElementById('submit-mbti-btn');
            submitBtn.disabled = answeredQuestions < mbtiQuestions.length;
        }
        
        // Submit MBTI Test
        async function submitMBTI() {
            // Calculate MBTI scores
            mbtiScores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            
            mbtiQuestions.forEach((q, index) => {
                const selected = document.querySelector(`input[name="q${index}"]:checked`);
                if (selected) {
                    const value = selected.value;
                    switch(index) {
                        case 0: case 4: case 10: // E vs I
                            if (value === 'A') mbtiScores.E++;
                            else mbtiScores.I++;
                            break;
                        case 1: case 7: // T vs F
                            if (value === 'A') mbtiScores.T++;
                            else mbtiScores.F++;
                            break;
                        case 2: case 5: case 8: case 11: // J vs P
                            if (value === 'A') mbtiScores.J++;
                            else mbtiScores.P++;
                            break;
                        case 3: case 6: case 9: // S vs N
                            if (value === 'A') mbtiScores.S++;
                            else mbtiScores.N++;
                            break;
                    }
                }
            });
            
            // Determine MBTI type
            const mbtiType = determineMBTIType(mbtiScores);
            
            // Analyze fusion results of zodiac and MBTI
            const result = getZodiacMBTIAnalysis(selectedZodiac, mbtiType, mbtiScores);
            try {
                if (window.adManager && window.AD_CONFIG?.googleAdsense?.enabled) {
                    await window.adManager.createVideoAd();
                }
            } catch (e) {
                // Ignore ad errors and continue
            }
            displayResult(result);
        }
        
        // Determine MBTI Type
        function determineMBTIType(scores) {
            const first = scores.E > scores.I ? 'E' : 'I';
            const second = scores.S > scores.N ? 'S' : 'N';
            const third = scores.T > scores.F ? 'T' : 'F';
            const fourth = scores.J > scores.P ? 'J' : 'P';
            return first + second + third + fourth;
        }
        
        // Get Zodiac and MBTI Fusion Analysis
        function getZodiacMBTIAnalysis(zodiac, mbtiType, mbtiScores) {
            const zodiacInfo = zodiacData[zodiac];
            
            // Analyze compatibility between MBTI and zodiac
            let matchAnalysis = '';
            let compatibility = '';
            
            // Match analysis based on zodiac element and MBTI type
            if (zodiacInfo.element === 'Fire' && (mbtiType.includes('E') || mbtiType.includes('P'))) {
                matchAnalysis = 'Your MBTI type highly matches Fire sign traits!';
                compatibility = 'Perfect Match';
            } else if (zodiacInfo.element === 'Earth' && (mbtiType.includes('S') || mbtiType.includes('J'))) {
                matchAnalysis = 'Your MBTI type highly matches Earth sign traits!';
                compatibility = 'Perfect Match';
            } else if (zodiacInfo.element === 'Air' && (mbtiType.includes('N') || mbtiType.includes('P'))) {
                matchAnalysis = 'Your MBTI type highly matches Air sign traits!';
                compatibility = 'Perfect Match';
            } else if (zodiacInfo.element === 'Water' && (mbtiType.includes('F') || mbtiType.includes('I'))) {
                matchAnalysis = 'Your MBTI type highly matches Water sign traits!';
                compatibility = 'Perfect Match';
            } else {
                matchAnalysis = 'Your MBTI type and zodiac traits form a unique combination, showing your personality diversity!';
                compatibility = 'Unique Combination';
            }
            
            return {
                zodiac: zodiacInfo,
                userMBTI: mbtiType,
                matchAnalysis: matchAnalysis,
                compatibility: compatibility,
                mbtiScores: mbtiScores
            };
        }
        
        // Display Analysis Results
        function displayResult(result) {
            const resultContent = document.getElementById('result-content');
            
            let resultHTML = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div class="kpi">${result.zodiac.icon} ${result.zodiac.name}</div>
                    <p class="muted">Zodiac Personality Traits Analysis</p>
                </div>
                
                <div class="grid">
                    <div class="card mbti-section">
                        <h4>üé≠ Your MBTI Type</h4>
                        <div style="text-align: center; margin: 20px 0;">
                            <div style="font-size: 24px; font-weight: 700; color: #3b82f6;">${result.userMBTI}</div>
                        </div>
                        <p>Based on actual MBTI test results</p>
                    </div>
                    
                    <div class="card fusion-section">
                        <h4>üåü Zodiac Traits</h4>
                        <p><strong>Element:</strong> ${result.zodiac.element}</p>
                        <p><strong>Core Traits:</strong> ${result.zodiac.traits.join(', ')}</p>
                    </div>
                </div>
                
                <div class="card" style="background: linear-gradient(135deg, #fef3c7, #fde68a); border-left: 4px solid #f59e0b;">
                    <h4>üéØ Fusion Compatibility</h4>
                    <div style="text-align: center; margin: 15px 0;">
                        <div style="font-size: 20px; font-weight: 700; color: #92400e;">${result.compatibility}</div>
                    </div>
                    <p style="text-align: center; color: #92400e;">${result.matchAnalysis}</p>
                </div>
                
                <div class="card">
                    <h4>üìä MBTI Dimension Scores</h4>
                    <p><strong>Extraversion (E):</strong> ${result.mbtiScores.E} | <strong>Introversion (I):</strong> ${result.mbtiScores.I}</p>
                    <p><strong>Sensing (S):</strong> ${result.mbtiScores.S} | <strong>Intuition (N):</strong> ${result.mbtiScores.N}</p>
                    <p><strong>Thinking (T):</strong> ${result.mbtiScores.T} | <strong>Feeling (F):</strong> ${result.mbtiScores.F}</p>
                    <p><strong>Judging (J):</strong> ${result.mbtiScores.J} | <strong>Perceiving (P):</strong> ${result.mbtiScores.P}</p>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h4>üí° Fusion Personality Summary</h4>
                    <p>Your personality is a unique combination of ${result.zodiac.name} traits and ${result.userMBTI} type, combining the mystical charm of zodiac with the scientific nature of MBTI.</p>
                    <p style="margin-top: 15px; color: #6b7280; font-size: 14px;">
                        This fusion analysis can more comprehensively showcase your personality characteristics, helping you better understand yourself and others.
                    </p>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="resetTest()">üîÑ Retake Test</button>
                    <button class="btn back-btn" onclick="location.href='index.html'">üè† Back to Home</button>
                </div>
            `;
            
            resultContent.innerHTML = resultHTML;
            document.getElementById('mbti-test').classList.add('hidden');
            document.getElementById('test-result').classList.remove('hidden');
        }
        
        // Back to Zodiac Selection
        function backToZodiac() {
            document.getElementById('mbti-test').classList.add('hidden');
            document.getElementById('zodiac-selection').classList.remove('hidden');
        }
        
        // Reset Test
        function resetTest() {
            selectedZodiac = null;
            mbtiScores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            
            // Reset zodiac selection
            document.querySelectorAll('.zodiac-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Reset MBTI test
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.checked = false;
            });
            
            // Reset progress bar
            document.getElementById('mbtiProgress').style.width = '0%';
            
            // Reset button states
            document.getElementById('start-mbti-btn').disabled = true;
            document.getElementById('submit-mbti-btn').disabled = true;
            
            // Show zodiac selection page
            document.getElementById('zodiac-selection').classList.remove('hidden');
            document.getElementById('mbti-test').classList.add('hidden');
            document.getElementById('test-result').classList.add('hidden');
        }
        
        // Start Test
        function startTest() {
            // Scroll to zodiac selection area
            document.getElementById('zodiac-selection').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Page Load Complete
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Fun Zodiac Test System loaded successfully!');
        });
    </script>
    <script src="ad-config.js"></script>
    <script src="ads-manager.js"></script>
    <script>
        window.resetAdConsent = function() {
            try {
                localStorage.removeItem('adsConsent');
                location.reload();
            } catch (e) {}
        };
    </script>
</body>
</html>
