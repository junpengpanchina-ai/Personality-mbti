<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† MBTI Four Dimensions Test - Tarot √ó MBTI</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e8e8e8;
            min-height: 100vh;
        }
        .container { max-width: 800px; margin: 0 auto; padding: 24px; }
        .header { text-align: center; color: #fff; margin: 24px 0; }
        .header h1 { margin: 0 0 8px; font-size: 32px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .header p { font-size: 16px; opacity: 0.9; }
        
        .card { 
            background: rgba(255,255,255,0.05); 
            border-radius: 20px; 
            padding: 24px; 
            box-shadow: 0 8px 32px rgba(0,0,0,0.3); 
            margin-bottom: 20px; 
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }
        
        .btn { 
            display:inline-block; 
            background: linear-gradient(135deg, #667eea, #764ba2); 
            color:#fff; 
            border:none; 
            padding:12px 24px; 
            border-radius:25px; 
            cursor:pointer; 
            font-weight:600; 
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
        .btn-secondary { background: linear-gradient(135deg, #4a5568, #2d3748); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        
        .muted { color:#a0aec0; font-size:14px; }
        .section-title { margin: 0 0 16px; color: #e2e8f0; font-size: 20px; }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .q { 
            border: 1px solid rgba(255,255,255,0.1); 
            border-radius:16px; 
            padding:20px; 
            margin-bottom:20px; 
            background: rgba(255,255,255,0.03);
        }
        .opt { margin:12px 0; }
        .opt input { width:auto; margin-right:12px; }
        .opt label { 
            display: flex; 
            align-items: center; 
            cursor: pointer; 
            padding: 12px; 
            border-radius: 12px; 
            transition: all 0.3s ease;
        }
        .opt label:hover { background: rgba(255,255,255,0.05); }
        .opt input:checked + span { color: #667eea; font-weight: 600; }
        
        .back-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #e2e8f0;
            margin-right: 12px;
        }
        .back-btn:hover { background: rgba(255,255,255,0.15); }
        
        .user-info {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-left: 4px solid #667eea;
            margin-bottom: 24px;
        }
        
        .pill { 
            display:inline-block; 
            padding:8px 16px; 
            border-radius:20px; 
            background:rgba(102, 126, 234, 0.2); 
            color:#a0aec0; 
            font-weight:600; 
            font-size:12px; 
            border: 1px solid rgba(102, 126, 234, 0.3);
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        @media (max-width: 768px) {
            .container { padding: 16px; }
            .header h1 { font-size: 24px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>üß† MBTI Four Dimensions Test</h1>
            <p class="muted">Complete the personality test to discover your MBTI type</p>
        </div>
    </div>

    <div class="container">
        <!-- User Information Display -->
        <div class="card user-info">
            <h3 class="section-title">üë§ Your Information</h3>
            <div id="userInfoDisplay">
                <!-- User info will be populated by JavaScript -->
            </div>
        </div>

        <!-- MBTI Test Section -->
        <div class="card">
            <h3 class="section-title">üß† MBTI Four Dimensions Test</h3>
            <p class="muted">Answer all 8 questions to discover your personality type. Each question helps determine one of the four MBTI dimensions.</p>
            
            <div class="progress-bar">
                <div class="progress-fill" id="mbtiProgress" style="width: 0%;"></div>
            </div>
            
            <div id="mbtiQuestions">
                <!-- Questions will be populated by JavaScript -->
            </div>
            
            <div style="margin-top:20px">
                <button class="btn back-btn" type="button" onclick="goBack()">‚Üê Back to Tarot Test</button>
                <button class="btn" type="button" onclick="proceedToTarot()" id="mbtiNextBtn" disabled="">Next: Tarot Card Selection ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        // MBTI test questions
        const MBTI_QUESTIONS = [
            { id: 1, dimension: 'EI', question: 'In social situations, you tend to:', 
              options: [
                  { text: 'Actively talk to others and meet new friends', score: { E: 1 } },
                  { text: 'Have quiet conversations with familiar people or observe alone', score: { I: 1 } }
              ] },
            { id: 2, dimension: 'EI', question: 'When you need to recharge, you:', 
              options: [
                  { text: 'Go out with friends for activities', score: { E: 1 } },
                  { text: 'Stay alone and enjoy solitude', score: { I: 1 } }
              ] },
            { id: 3, dimension: 'SN', question: 'You focus more on:', 
              options: [
                  { text: 'Concrete facts and details', score: { S: 1 } },
                  { text: 'Possibilities and future visions', score: { N: 1 } }
              ] },
            { id: 4, dimension: 'SN', question: 'When solving problems, you prefer:', 
              options: [
                  { text: 'Using existing methods and experience', score: { S: 1 } },
                  { text: 'Trying new innovative methods', score: { N: 1 } }
              ] },
            { id: 5, dimension: 'TF', question: 'When making decisions, you value more:', 
              options: [
                  { text: 'Logical analysis and objective facts', score: { T: 1 } },
                  { text: 'Personal values and others\' feelings', score: { F: 1 } }
              ] },
            { id: 6, dimension: 'TF', question: 'When handling conflicts, you:', 
              options: [
                  { text: 'Seek fair and reasonable solutions', score: { T: 1 } },
                  { text: 'Consider everyone\'s feelings and seek harmony', score: { F: 1 } }
              ] },
            { id: 7, dimension: 'JP', question: 'You prefer:', 
              options: [
                  { text: 'Making plans and following them', score: { J: 1 } },
                  { text: 'Maintaining flexibility and adapting to situations', score: { P: 1 } }
              ] },
            { id: 8, dimension: 'JP', question: 'Facing deadlines, you usually:', 
              options: [
                  { text: 'Complete early to avoid pressure', score: { J: 1 } },
                  { text: 'Complete efficiently at the last moment', score: { P: 1 } }
              ] }
        ];

        let mbtiScores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
        let mbtiType = '';

        // Get user info from URL parameters
        function getUserInfo() {
            const urlParams = new URLSearchParams(window.location.search);
            const birthDate = urlParams.get('birthDate') || 'Not specified';
            const birthTime = urlParams.get('birthTime') || 'Not specified';
            const name = urlParams.get('name') || 'Anonymous';
            
            return { birthDate, birthTime, name };
        }

        // Display user information
        function displayUserInfo() {
            const userInfo = getUserInfo();
            const display = document.getElementById('userInfoDisplay');
            
            display.innerHTML = `
                <div><span class="pill">Name:</span> ${userInfo.name}</div>
                <div><span class="pill">Birth Date:</span> ${userInfo.birthDate}</div>
                <div><span class="pill">Birth Time:</span> ${userInfo.birthTime}</div>
            `;
        }

        // Render MBTI questions
        function renderMBTIQuestions() {
            const container = document.getElementById('mbtiQuestions');
            container.innerHTML = '';
            
            MBTI_QUESTIONS.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'q';
                questionDiv.innerHTML = `
                    <div style="font-weight:700; margin-bottom:12px">${index + 1}. ${q.question}</div>
                    ${q.options.map((opt, optIndex) => `
                        <div class="opt">
                            <label>
                                <input type="radio" name="q${q.id}" value="${optIndex}" onchange="updateMBTIProgress()">
                                <span>${opt.text}</span>
                            </label>
                        </div>
                    `).join('')}
                `;
                container.appendChild(questionDiv);
            });
            
            updateMBTIProgress();
        }

        // Update progress bar
        function updateMBTIProgress() {
            const totalQuestions = MBTI_QUESTIONS.length;
            const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
            const progress = (answeredQuestions / totalQuestions) * 100;
            
            document.getElementById('mbtiProgress').style.width = progress + '%';
            
            // Check if can proceed to next step
            const nextBtn = document.getElementById('mbtiNextBtn');
            if (answeredQuestions === totalQuestions) {
                nextBtn.disabled = false;
                calculateMBTI();
            } else {
                nextBtn.disabled = true;
            }
        }

        // Calculate MBTI type
        function calculateMBTI() {
            // Reset scores
            mbtiScores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
            
            // Calculate scores
            MBTI_QUESTIONS.forEach(q => {
                const selected = document.querySelector(`input[name="q${q.id}"]:checked`);
                if (selected) {
                    const option = q.options[parseInt(selected.value)];
                    Object.entries(option.score).forEach(([dimension, score]) => {
                        mbtiScores[dimension] += score;
                    });
                }
            });
            
            // Determine type
            mbtiType = '';
            mbtiType += mbtiScores.E >= mbtiScores.I ? 'E' : 'I';
            mbtiType += mbtiScores.S >= mbtiScores.N ? 'S' : 'N';
            mbtiType += mbtiScores.T >= mbtiScores.F ? 'T' : 'F';
            mbtiType += mbtiScores.J >= mbtiScores.P ? 'J' : 'P';
            
            console.log('MBTI Type calculated:', mbtiType);
        }

        // Go back to tarot test page
        function goBack() {
            window.history.back();
        }

        // Proceed to tarot card selection
        function proceedToTarot() {
            const userInfo = getUserInfo();
            const url = `tarot-test.html?mbtiType=${mbtiType}&birthDate=${encodeURIComponent(userInfo.birthDate)}&birthTime=${encodeURIComponent(userInfo.birthTime)}&name=${encodeURIComponent(userInfo.name)}`;
            window.location.href = url;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('MBTI Test page loaded');
            displayUserInfo();
            renderMBTIQuestions();
        });
    </script>
</body>
</html>
